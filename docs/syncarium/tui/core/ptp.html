<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>syncarium.tui.core.ptp API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../core.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;syncarium.tui.core</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#ptppy">ptp.py</a></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#PTPManager">PTPManager</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#PTPManager.__init__">PTPManager</a>
                        </li>
                        <li>
                                <a class="variable" href="#PTPManager.vt">vt</a>
                        </li>
                        <li>
                                <a class="variable" href="#PTPManager.config_dir">config_dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#PTPManager.ptp4l_config_dir">ptp4l_config_dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#PTPManager.log_dir">log_dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#PTPManager.print_lock">print_lock</a>
                        </li>
                        <li>
                                <a class="variable" href="#PTPManager.loaded_clients">loaded_clients</a>
                        </li>
                        <li>
                                <a class="function" href="#PTPManager.main_menu">main_menu</a>
                        </li>
                        <li>
                                <a class="function" href="#PTPManager.load_clients">load_clients</a>
                        </li>
                        <li>
                                <a class="function" href="#PTPManager.start_ptp">start_ptp</a>
                        </li>
                        <li>
                                <a class="function" href="#PTPManager.stop_ptp">stop_ptp</a>
                        </li>
                        <li>
                                <a class="function" href="#PTPManager.print_ptp_log">print_ptp_log</a>
                        </li>
                        <li>
                                <a class="function" href="#PTPManager.ping_server">ping_server</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
syncarium<wbr>.<a href="./../../tui.html">tui</a><wbr>.<a href="./../core.html">core</a><wbr>.ptp    </h1>

                        <div class="docstring"><h1 id="ptppy">ptp.py</h1>

<p><strong>Project</strong>: Syncarium - Intelligent Timing Platform Toolkit<br />
<strong>Description</strong>: PTP configurations for TUI<br />
<strong>Author</strong>: PhD Student Alberto Ortega Ruiz, University of Granada<br />
<strong>Created</strong>: 2025-05-22<br />
<strong>Version</strong>: 1.0.0<br />
<strong>License</strong>: GPLv3</p>
</div>

                        <input id="mod-ptp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-ptp-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd"># ptp.py</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">**Project**: Syncarium - Intelligent Timing Platform Toolkit  </span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">**Description**: PTP configurations for TUI  </span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">**Author**: PhD Student Alberto Ortega Ruiz, University of Granada  </span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">**Created**: 2025-05-22  </span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">**Version**: 1.0.0  </span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">**License**: GPLv3</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="c1"># Standard Library Imports</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">subprocess</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">re</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">psutil</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">datetime</span><span class="w"> </span><span class="kn">import</span> <span class="n">datetime</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">threading</span><span class="w"> </span><span class="kn">import</span> <span class="n">Lock</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="c1"># Third-Party Imports</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.prompt</span><span class="w"> </span><span class="kn">import</span> <span class="n">Confirm</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="c1"># Local Application Imports</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">syncarium.tui.utils</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">utils</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="c1"># 🕒 PTP Manager Class</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PTPManager</span><span class="p">:</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">    Handles Precision Time Protocol (PTP) configuration and management tasks</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">    within the Syncarium environment.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">    ### Attributes:</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">    - **vt** (`utils.ViewTools`): Utility class for rendering formatted views in the console.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">    - **config_dir** (`Path`): Path to the directory containing general configuration files.</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">    - **ptp4l_config_dir** (`Path`): Path to the directory containing ptp4l-specific configuration files.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">    - **log_dir** (`Path`): Path to the directory where log files are stored.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">    - **print_lock** (`Lock`): Thread lock used to synchronize console output across threads.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    - **loaded_clients** (`Dict[str, Dict[str, str]]`): Dictionary containing loaded PTP client configurations.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a><span class="c1"># 🚧 Function: constructor</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">        Initializes the PTPManager instance with required configuration paths and utilities.</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">        ### Args:</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        - **vt** (`utils.ViewTools`): Instance of the view rendering utility used for console output.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>        <span class="c1"># Store view tools instance</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span> <span class="o">=</span> <span class="n">vt</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="c1"># Define configuration and logging directories</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;suite&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ptp4l_config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;suite&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span> <span class="o">/</span> <span class="s2">&quot;ptp4l_config&quot;</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">)</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>        <span class="c1"># Lock for thread-safe console output</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span> <span class="n">Lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>        <span class="c1"># Dictionary to store loaded PTP client configurations</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="c1"># 📋 Function: main_menu</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">main_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="sd">        Displays and manages the interactive terminal-based menu for PTP operations.</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="sd">        Continuously renders a menu using InquirerPy, allowing the user to perform various</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">        PTP-related actions such as starting/stopping services, viewing logs, pinging the server,</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a><span class="sd">        and refreshing the interface. The loop continues until the user selects **&quot;❌ Exit&quot;**</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        or interrupts the process using **Ctrl+C**.</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        ### Menu Options:</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        - ⏱️ Start PTP → `start_ptp`</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        - 🛑 Stop PTP → `stop_ptp`</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        - 📄 Show PTP Logs → `print_ptp_log`</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a><span class="sd">        - 📡 Ping PTP Server → `ping_server`</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        - 🔄 Refresh View → refreshes the interface without performing any action</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a><span class="sd">        - ❌ Exit → exits the menu loop</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        ### Notes:</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        - Graceful exit is supported via **Ctrl+C** interruption.</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>                <span class="c1"># Display the software title</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_software_title</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>                <span class="c1"># Show the main menu header</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;main_title&quot;</span><span class="p">,</span> <span class="s2">&quot;PTP Management Menu&quot;</span><span class="p">,</span> <span class="s2">&quot;⏱️&quot;</span><span class="p">)</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>                <span class="c1"># Render a table of active PTP processes</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_ptp_processes</span><span class="p">()</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>                <span class="c1"># Prompt user with interactive menu</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>                <span class="n">choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;⏱️ Start PTP&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;start_ptp&quot;</span><span class="p">},</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🛑 Stop PTP&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;stop_ptp&quot;</span><span class="p">},</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📄 Show PTP Logs&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;print_ptp_log&quot;</span><span class="p">},</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📡 Ping PTP Server&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;ping_server&quot;</span><span class="p">},</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🔄 Refresh view&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">},</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;❌ Exit&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;exit&quot;</span><span class="p">},</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>                    <span class="p">],</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>                <span class="p">)</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>                <span class="c1"># Map menu options to corresponding methods</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>                <span class="n">submenu</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>                    <span class="s2">&quot;start_ptp&quot;</span><span class="p">:</span>        <span class="bp">self</span><span class="o">.</span><span class="n">start_ptp</span><span class="p">,</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>                    <span class="s2">&quot;stop_ptp&quot;</span><span class="p">:</span>         <span class="bp">self</span><span class="o">.</span><span class="n">stop_ptp</span><span class="p">,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>                    <span class="s2">&quot;print_ptp_log&quot;</span><span class="p">:</span>    <span class="bp">self</span><span class="o">.</span><span class="n">print_ptp_log</span><span class="p">,</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>                    <span class="s2">&quot;ping_server&quot;</span><span class="p">:</span>      <span class="bp">self</span><span class="o">.</span><span class="n">ping_server</span><span class="p">,</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>                <span class="p">}</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>                <span class="c1"># Handle user selection</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>                <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;exit&quot;</span><span class="p">:</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>                    <span class="k">break</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>                <span class="k">elif</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">:</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>                    <span class="n">action</span> <span class="o">=</span> <span class="n">submenu</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>                    <span class="k">if</span> <span class="n">action</span><span class="p">:</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>                        <span class="n">action</span><span class="p">()</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>                        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🔙 Press ⏎ to return to the menu...&quot;</span><span class="p">)</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>            <span class="c1"># Gracefully handle Ctrl+C interruption</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;Exiting...&quot;</span><span class="p">)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a><span class="c1"># 📌 Function: load_clients</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_clients</span><span class="p">(</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>        <span class="n">file_cfg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>        <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a><span class="sd">        Loads and validates PTP client configurations from a YAML file.</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a><span class="sd">        If no file is specified, the user is prompted to select one interactively from the available</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a><span class="sd">        YAML files in the configuration directory. Each client&#39;s network namespace is validated</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a><span class="sd">        against the system. Clients with missing namespaces are skipped and reported.</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a><span class="sd">        The YAML file must contain a `ptp_clients` section with client definitions.</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a><span class="sd">        ### Args:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a><span class="sd">        - **file_cfg** (`Optional[str]`): Name of the YAML configuration file to load. If `None`, prompts the user interactively.</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a><span class="sd">        - **logger** (`Optional[Any]`): Logger instance used for logging messages. Defaults to `None`.</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages. Defaults to `0`.</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="sd">        - **quiet** (`bool`): If `True`, suppresses console output. Defaults to `True`.</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a><span class="sd">        ### Returns:</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="sd">        - `bool`: `True` if clients were successfully loaded and validated; `False` otherwise.</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>        <span class="c1"># Show section title</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Loading PTP Clients&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>        <span class="c1"># If no file is provided, prompt user to select one</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>        <span class="k">if</span> <span class="n">file_cfg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>            
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>            <span class="n">files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">))</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*.yaml&quot;</span><span class="p">)</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>            <span class="p">]</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>            
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>                    <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>                    <span class="sa">f</span><span class="s2">&quot;No YAML configuration files found in &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>                <span class="p">)</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>                <span class="n">choices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>                    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. 📄 </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>                <span class="p">]</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>                <span class="n">selected</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>                    <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Available Configuration Files:&quot;</span><span class="p">,</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>                <span class="p">)</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>                <span class="n">filepath_cfg</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">selected</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation cancelled by user.&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>            <span class="n">filepath_cfg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">file_cfg</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>            <span class="c1"># Load YAML data</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath_cfg</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>                <span class="n">yaml_data</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">yaml_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ptp_clients&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>            <span class="c1"># Get currently existing namespaces</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>            <span class="n">ns_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;netns&quot;</span><span class="p">,</span> <span class="s2">&quot;list&quot;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>            <span class="n">existing_namespaces</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>                <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ns_result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>            <span class="p">}</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>            <span class="n">skipped</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>            <span class="c1"># Validate each client namespace</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>            <span class="k">for</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">client_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>                <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">client_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;namespace&quot;</span><span class="p">)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>                <span class="k">if</span> <span class="n">ns</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_namespaces</span><span class="p">:</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>                    <span class="n">skipped</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">client_name</span><span class="p">,</span> <span class="n">ns</span><span class="p">))</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">[</span><span class="n">client_name</span><span class="p">]</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="c1"># Report missing namespaces</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>            <span class="k">if</span> <span class="n">skipped</span><span class="p">:</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>                <span class="n">missing</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⛔ </span><span class="si">{</span><span class="n">iface</span><span class="si">}</span><span class="s2"> → Namespace &#39;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span> <span class="k">for</span> <span class="n">iface</span><span class="p">,</span> <span class="n">ns</span> <span class="ow">in</span> <span class="n">skipped</span><span class="p">)</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ One or more namespaces are missing:</span><span class="se">\n</span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>            <span class="c1"># Confirm successful loading</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>                <span class="s2">&quot;success&quot;</span><span class="p">,</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>                <span class="sa">f</span><span class="s2">&quot;Clients successfully loaded from </span><span class="si">{</span><span class="n">filepath_cfg</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>            <span class="p">)</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>            <span class="c1"># Display loaded clients</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded PTP Clients:&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>                <span class="k">for</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>                        <span class="s2">&quot;info&quot;</span><span class="p">,</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2"> → Namespace: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;namespace&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> / Interface: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;interface&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> / Config: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>                        <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>                        <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>                    <span class="p">)</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>            <span class="c1"># Handle YAML or validation errors</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>                <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>                <span class="sa">f</span><span class="s2">&quot;Error loading YAML file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>            <span class="p">)</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a><span class="c1"># 📌 Function: start_ptp</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">start_ptp</span><span class="p">(</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>        <span class="n">stop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a><span class="sd">        Launches `ptp4l` processes for all configured clients.</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a><span class="sd">        If enabled, checks for existing `ptp4l` processes and prompts the user to stop them before starting new ones.</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a><span class="sd">        If no clients are currently loaded, attempts to load them from configuration files.</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a><span class="sd">        For each valid client, starts a `ptp4l` process within its corresponding network namespace using `sudo`,</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a><span class="sd">        with output redirected to a dedicated log file. Displays process information including PID, log path, and command.</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="sd">        ### Args</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="sd">        - **logger** (`Optional[Any]`): Logger instance for logging messages. Defaults to `None`.</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="sd">        - **extra_indent** (`int`): Indentation level for console messages. Defaults to `0`.</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a><span class="sd">        - **stop** (`bool`): Whether to stop existing `ptp4l` processes before launching new ones. Defaults to `True`.</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="c1"># Stop and clean actual clients if enabled</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="k">if</span> <span class="n">stop</span><span class="p">:</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>            <span class="c1"># Check for existing ptp4l processes</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>            <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>            <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;There are PTP clients already running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">)</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>                <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Confirm</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⚠️ Are you sure you want to stop the actual PTP processes?&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>                <span class="k">if</span> <span class="n">confirm</span><span class="p">:</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stop_ptp</span><span class="p">(</span><span class="n">preconfirmation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">extra_indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Not starting new PTP processes.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>                    <span class="k">return</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>        <span class="c1"># Load client configurations if not already loaded</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_clients</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">extra_indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">):</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;Aborting operation due to failed client loading.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a>                <span class="k">return</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Starting PTP processes&quot;</span><span class="p">,</span> <span class="n">title_emoji</span><span class="o">=</span><span class="s2">&quot;⏱️&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a>        <span class="k">for</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a>            <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptp4l_config_dir</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>            <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>            <span class="n">log_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;ptp-</span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2">.log&quot;</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>            <span class="c1"># Validate config file existence</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Configuration file not found: </span><span class="si">{</span><span class="n">config_path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>                <span class="k">continue</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>            <span class="c1"># Ensure log directory exists and reset log file</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s2">] Log reset for </span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>            <span class="c1"># Build ptp4l command</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="n">command</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>                <span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;netns&quot;</span><span class="p">,</span> <span class="s2">&quot;exec&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>                <span class="s2">&quot;ptp4l&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_path</span><span class="p">),</span> <span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>            <span class="p">]</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>                <span class="c1"># Launch ptp4l process with sudo and redirect output to log</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">log_file</span><span class="p">:</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                    <span class="n">ptp_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>                        <span class="p">[</span><span class="s2">&quot;sudo&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">command</span><span class="p">,</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>                        <span class="n">stdout</span><span class="o">=</span><span class="n">log_file</span><span class="p">,</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>                        <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>                        <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>                        <span class="n">close_fds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>                        <span class="n">preexec_fn</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">setpgrp</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>                    <span class="p">)</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>                <span class="c1"># Locate the actual ptp4l child process</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>                <span class="n">ptp4l_proc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>                    <span class="n">parent</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">ptp_process</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>                    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>                        <span class="k">if</span> <span class="s2">&quot;ptp4l&quot;</span> <span class="ow">in</span> <span class="n">child</span><span class="o">.</span><span class="n">name</span><span class="p">():</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>                            <span class="n">ptp4l_proc</span> <span class="o">=</span> <span class="n">child</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>                            <span class="k">break</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>                <span class="k">except</span> <span class="n">psutil</span><span class="o">.</span><span class="n">NoSuchProcess</span><span class="p">:</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>                    <span class="k">pass</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>                <span class="k">if</span> <span class="n">ptp4l_proc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;PTP4L process not found in </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>                    <span class="k">continue</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>                <span class="c1"># Format and display process information</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>                <span class="n">start_time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%D-%H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>                <span class="n">cmd_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">command</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;PTP launched successfully.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Client: </span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2"> | PID: </span><span class="si">{</span><span class="n">ptp4l_proc</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2"> | Started at: </span><span class="si">{</span><span class="n">start_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Log: </span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Command: </span><span class="si">{</span><span class="n">cmd_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error launching PTP on </span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a><span class="c1"># 📌 Function: stop_ptp</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_ptp</span><span class="p">(</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>        <span class="n">preconfirmation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>        <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a><span class="sd">        Terminates all active `ptp4l` processes and removes associated log files.</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a><span class="sd">        Detects running `ptp4l` processes and optionally prompts the user for confirmation before terminating them.</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a><span class="sd">        After stopping the processes, it deletes all related log files and clears the loaded client configurations.</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a><span class="sd">        ### Args</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a><span class="sd">        - **preconfirmation** (`Optional[bool]`): If `True`, skips the confirmation prompt. Defaults to `False`.</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a><span class="sd">        - **logger** (`Optional[Any]`): Logger instance for logging messages. Defaults to `None`.</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a><span class="sd">        - **extra_indent** (`int`): Indentation level for console messages. Defaults to `0`.</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a><span class="sd">        - **quiet** (`bool`): If `True`, suppresses non-critical console output. Defaults to `True`.</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="c1"># Show section title</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Stopping ptp processes&quot;</span><span class="p">,</span> <span class="s2">&quot;🛑&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>        <span class="c1"># Check for running ptp4l processes</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a>        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;No active ptp4l processes found.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>            <span class="k">return</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>        <span class="c1"># Ask for confirmation unless preconfirmed</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">preconfirmation</span><span class="p">:</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>            <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Confirm</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⚠️ Are you sure you want to stop the PTP processes?&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Stop operation cancelled.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>                <span class="k">return</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>            <span class="c1"># Kill each ptp4l process</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Killing all ptp4l processes:&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a>                <span class="n">pid</span><span class="p">,</span> <span class="o">*</span><span class="n">cmd</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Killing PTP4l process with PID </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> → </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a>                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="s2">&quot;kill&quot;</span><span class="p">,</span> <span class="s2">&quot;-9&quot;</span><span class="p">,</span> <span class="n">pid</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;All ptp4l processes have been terminated.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a>        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error stopping ptp4l processes: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a>            <span class="c1"># Check and clean log directory</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Log directory does not exist: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a>                <span class="k">return</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a>            <span class="n">logfiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()]</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">logfiles</span><span class="p">:</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No log files found in: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>                <span class="k">return</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Removing all ptp4l log files:&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>            <span class="c1"># Delete each log file</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>            <span class="k">for</span> <span class="n">archivo</span> <span class="ow">in</span> <span class="n">logfiles</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>                <span class="n">logpath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">/</span> <span class="n">archivo</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>                <span class="k">if</span> <span class="n">logpath</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>                        <span class="n">logpath</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Deleted log file: </span><span class="si">{</span><span class="n">logpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Failed to delete log file </span><span class="si">{</span><span class="n">logpath</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;All log files have been processed.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unexpected error while deleting log files: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>        <span class="c1"># Clear loaded client configurations</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a><span class="c1"># 📌 Function: print_ptp_log</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">print_ptp_log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a><span class="sd">        Displays and follows the real-time log of a selected PTP client.</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a><span class="sd">        Lists all available PTP log files corresponding to the namespaces defined in the `ptp_clients` dictionary.</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a><span class="sd">        Prompts the user to select one and uses `tail -F` to stream the log output in real time.</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>        <span class="c1"># Show section title</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Printing ptp logs&quot;</span><span class="p">,</span> <span class="s2">&quot;📄&quot;</span><span class="p">)</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>        <span class="c1"># Check if ptp4l is running</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No PTP processes have been started or are currently running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>            <span class="k">return</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>        <span class="c1"># Search for log files matching the pattern ptp-&lt;name&gt;.log</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^ptp-(.+)\.log$&quot;</span><span class="p">)</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>        <span class="n">available_logs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>                <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>                <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>                    <span class="n">available_logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">available_logs</span><span class="p">:</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No log files found for the defined namespaces.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>            <span class="k">return</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>            <span class="c1"># Build menu choices from log file names</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a>            <span class="n">choices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a>                <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. 📄 </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">available_logs</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>            <span class="p">]</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>            <span class="c1"># Prompt user to select a log</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>            <span class="n">selected</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>                <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Available PTP Logs:&quot;</span><span class="p">,</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a>            <span class="p">)</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a>            <span class="c1"># Build full path to the selected log file</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a>            <span class="n">log_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;ptp-</span><span class="si">{</span><span class="n">selected</span><span class="si">}</span><span class="s2">.log&quot;</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a>        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a>            <span class="c1"># Handle cancellation</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation cancelled by user.&quot;</span><span class="p">)</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a>            <span class="k">return</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>        <span class="c1"># Display the log in real time</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">real_time_log</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a><span class="c1"># 📌 Function: ping_server</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ping_server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a><span class="sd">        Performs a ping test to the PTP server from each configured namespace.</span>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a><span class="sd">        For each client, extracts the server&#39;s IP address from its `.config` file by locating the line containing `&#39;UDPv4&#39;`.</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a><span class="sd">        Then, executes a ping command from the corresponding network namespace to verify connectivity.</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a><span class="sd">        Displays the result of each ping attempt in the console.</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>        <span class="c1"># Check if ptp4l is currently running</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>        <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;PTP processes have been started or are currently running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>            <span class="k">return</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>        <span class="c1"># Load client configurations</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_clients</span><span class="p">():</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Aborting ping test due to failed client loading.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>            <span class="k">return</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Pinging PTP Server from each Namespace&quot;</span><span class="p">,</span> <span class="s2">&quot;📡&quot;</span><span class="p">)</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>        <span class="c1"># Iterate over each client to perform ping</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>        <span class="k">for</span> <span class="n">iface</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a>            <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a>            <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptp4l_config_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>            <span class="c1"># Extract server IP from config file</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>                    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a>                <span class="n">server_ip</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a>                    <span class="k">if</span> <span class="s2">&quot;UDPv4&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a>                        <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>                            <span class="n">server_ip</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>                            <span class="k">break</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">server_ip</span><span class="p">:</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No &#39;UDPv4&#39; entry found in config for </span><span class="si">{</span><span class="n">iface</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>                    <span class="k">continue</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error reading config file for </span><span class="si">{</span><span class="n">iface</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>                <span class="k">continue</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>            <span class="c1"># Notify user and execute ping</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Pinging from </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">server_ip</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a>                <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>                    <span class="p">[</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;netns&quot;</span><span class="p">,</span> <span class="s2">&quot;exec&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="s2">&quot;ping&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="n">server_ip</span><span class="p">],</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a>                    <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a>            <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Ping failed from </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>            <span class="c1"># Brief pause before next ping</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span></pre></div>


            </section>
                <section id="PTPManager">
                            <input id="PTPManager-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">PTPManager</span>:

                <label class="view-source-button" for="PTPManager-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PTPManager"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PTPManager-41"><a href="#PTPManager-41"><span class="linenos"> 41</span></a><span class="k">class</span><span class="w"> </span><span class="nc">PTPManager</span><span class="p">:</span>
</span><span id="PTPManager-42"><a href="#PTPManager-42"><span class="linenos"> 42</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager-43"><a href="#PTPManager-43"><span class="linenos"> 43</span></a><span class="sd">    Handles Precision Time Protocol (PTP) configuration and management tasks</span>
</span><span id="PTPManager-44"><a href="#PTPManager-44"><span class="linenos"> 44</span></a><span class="sd">    within the Syncarium environment.</span>
</span><span id="PTPManager-45"><a href="#PTPManager-45"><span class="linenos"> 45</span></a>
</span><span id="PTPManager-46"><a href="#PTPManager-46"><span class="linenos"> 46</span></a><span class="sd">    ### Attributes:</span>
</span><span id="PTPManager-47"><a href="#PTPManager-47"><span class="linenos"> 47</span></a><span class="sd">    - **vt** (`utils.ViewTools`): Utility class for rendering formatted views in the console.</span>
</span><span id="PTPManager-48"><a href="#PTPManager-48"><span class="linenos"> 48</span></a><span class="sd">    - **config_dir** (`Path`): Path to the directory containing general configuration files.</span>
</span><span id="PTPManager-49"><a href="#PTPManager-49"><span class="linenos"> 49</span></a><span class="sd">    - **ptp4l_config_dir** (`Path`): Path to the directory containing ptp4l-specific configuration files.</span>
</span><span id="PTPManager-50"><a href="#PTPManager-50"><span class="linenos"> 50</span></a><span class="sd">    - **log_dir** (`Path`): Path to the directory where log files are stored.</span>
</span><span id="PTPManager-51"><a href="#PTPManager-51"><span class="linenos"> 51</span></a><span class="sd">    - **print_lock** (`Lock`): Thread lock used to synchronize console output across threads.</span>
</span><span id="PTPManager-52"><a href="#PTPManager-52"><span class="linenos"> 52</span></a><span class="sd">    - **loaded_clients** (`Dict[str, Dict[str, str]]`): Dictionary containing loaded PTP client configurations.</span>
</span><span id="PTPManager-53"><a href="#PTPManager-53"><span class="linenos"> 53</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="PTPManager-54"><a href="#PTPManager-54"><span class="linenos"> 54</span></a>
</span><span id="PTPManager-55"><a href="#PTPManager-55"><span class="linenos"> 55</span></a>
</span><span id="PTPManager-56"><a href="#PTPManager-56"><span class="linenos"> 56</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-57"><a href="#PTPManager-57"><span class="linenos"> 57</span></a><span class="c1"># 🚧 Function: constructor</span>
</span><span id="PTPManager-58"><a href="#PTPManager-58"><span class="linenos"> 58</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-59"><a href="#PTPManager-59"><span class="linenos"> 59</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager-60"><a href="#PTPManager-60"><span class="linenos"> 60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager-61"><a href="#PTPManager-61"><span class="linenos"> 61</span></a><span class="sd">        Initializes the PTPManager instance with required configuration paths and utilities.</span>
</span><span id="PTPManager-62"><a href="#PTPManager-62"><span class="linenos"> 62</span></a>
</span><span id="PTPManager-63"><a href="#PTPManager-63"><span class="linenos"> 63</span></a><span class="sd">        ### Args:</span>
</span><span id="PTPManager-64"><a href="#PTPManager-64"><span class="linenos"> 64</span></a><span class="sd">        - **vt** (`utils.ViewTools`): Instance of the view rendering utility used for console output.</span>
</span><span id="PTPManager-65"><a href="#PTPManager-65"><span class="linenos"> 65</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager-66"><a href="#PTPManager-66"><span class="linenos"> 66</span></a>
</span><span id="PTPManager-67"><a href="#PTPManager-67"><span class="linenos"> 67</span></a>        <span class="c1"># Store view tools instance</span>
</span><span id="PTPManager-68"><a href="#PTPManager-68"><span class="linenos"> 68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span> <span class="o">=</span> <span class="n">vt</span>
</span><span id="PTPManager-69"><a href="#PTPManager-69"><span class="linenos"> 69</span></a>
</span><span id="PTPManager-70"><a href="#PTPManager-70"><span class="linenos"> 70</span></a>        <span class="c1"># Define configuration and logging directories</span>
</span><span id="PTPManager-71"><a href="#PTPManager-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;suite&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span>
</span><span id="PTPManager-72"><a href="#PTPManager-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ptp4l_config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;suite&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span> <span class="o">/</span> <span class="s2">&quot;ptp4l_config&quot;</span>
</span><span id="PTPManager-73"><a href="#PTPManager-73"><span class="linenos"> 73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">)</span>
</span><span id="PTPManager-74"><a href="#PTPManager-74"><span class="linenos"> 74</span></a>
</span><span id="PTPManager-75"><a href="#PTPManager-75"><span class="linenos"> 75</span></a>
</span><span id="PTPManager-76"><a href="#PTPManager-76"><span class="linenos"> 76</span></a>        <span class="c1"># Lock for thread-safe console output</span>
</span><span id="PTPManager-77"><a href="#PTPManager-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span> <span class="n">Lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>
</span><span id="PTPManager-78"><a href="#PTPManager-78"><span class="linenos"> 78</span></a>
</span><span id="PTPManager-79"><a href="#PTPManager-79"><span class="linenos"> 79</span></a>        <span class="c1"># Dictionary to store loaded PTP client configurations</span>
</span><span id="PTPManager-80"><a href="#PTPManager-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="PTPManager-81"><a href="#PTPManager-81"><span class="linenos"> 81</span></a>
</span><span id="PTPManager-82"><a href="#PTPManager-82"><span class="linenos"> 82</span></a>
</span><span id="PTPManager-83"><a href="#PTPManager-83"><span class="linenos"> 83</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-84"><a href="#PTPManager-84"><span class="linenos"> 84</span></a><span class="c1"># 📋 Function: main_menu</span>
</span><span id="PTPManager-85"><a href="#PTPManager-85"><span class="linenos"> 85</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-86"><a href="#PTPManager-86"><span class="linenos"> 86</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">main_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager-87"><a href="#PTPManager-87"><span class="linenos"> 87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager-88"><a href="#PTPManager-88"><span class="linenos"> 88</span></a><span class="sd">        Displays and manages the interactive terminal-based menu for PTP operations.</span>
</span><span id="PTPManager-89"><a href="#PTPManager-89"><span class="linenos"> 89</span></a>
</span><span id="PTPManager-90"><a href="#PTPManager-90"><span class="linenos"> 90</span></a><span class="sd">        Continuously renders a menu using InquirerPy, allowing the user to perform various</span>
</span><span id="PTPManager-91"><a href="#PTPManager-91"><span class="linenos"> 91</span></a><span class="sd">        PTP-related actions such as starting/stopping services, viewing logs, pinging the server,</span>
</span><span id="PTPManager-92"><a href="#PTPManager-92"><span class="linenos"> 92</span></a><span class="sd">        and refreshing the interface. The loop continues until the user selects **&quot;❌ Exit&quot;**</span>
</span><span id="PTPManager-93"><a href="#PTPManager-93"><span class="linenos"> 93</span></a><span class="sd">        or interrupts the process using **Ctrl+C**.</span>
</span><span id="PTPManager-94"><a href="#PTPManager-94"><span class="linenos"> 94</span></a>
</span><span id="PTPManager-95"><a href="#PTPManager-95"><span class="linenos"> 95</span></a><span class="sd">        ### Menu Options:</span>
</span><span id="PTPManager-96"><a href="#PTPManager-96"><span class="linenos"> 96</span></a><span class="sd">        - ⏱️ Start PTP → `start_ptp`</span>
</span><span id="PTPManager-97"><a href="#PTPManager-97"><span class="linenos"> 97</span></a><span class="sd">        - 🛑 Stop PTP → `stop_ptp`</span>
</span><span id="PTPManager-98"><a href="#PTPManager-98"><span class="linenos"> 98</span></a><span class="sd">        - 📄 Show PTP Logs → `print_ptp_log`</span>
</span><span id="PTPManager-99"><a href="#PTPManager-99"><span class="linenos"> 99</span></a><span class="sd">        - 📡 Ping PTP Server → `ping_server`</span>
</span><span id="PTPManager-100"><a href="#PTPManager-100"><span class="linenos">100</span></a><span class="sd">        - 🔄 Refresh View → refreshes the interface without performing any action</span>
</span><span id="PTPManager-101"><a href="#PTPManager-101"><span class="linenos">101</span></a><span class="sd">        - ❌ Exit → exits the menu loop</span>
</span><span id="PTPManager-102"><a href="#PTPManager-102"><span class="linenos">102</span></a>
</span><span id="PTPManager-103"><a href="#PTPManager-103"><span class="linenos">103</span></a><span class="sd">        ### Notes:</span>
</span><span id="PTPManager-104"><a href="#PTPManager-104"><span class="linenos">104</span></a><span class="sd">        - Graceful exit is supported via **Ctrl+C** interruption.</span>
</span><span id="PTPManager-105"><a href="#PTPManager-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager-106"><a href="#PTPManager-106"><span class="linenos">106</span></a>
</span><span id="PTPManager-107"><a href="#PTPManager-107"><span class="linenos">107</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-108"><a href="#PTPManager-108"><span class="linenos">108</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="PTPManager-109"><a href="#PTPManager-109"><span class="linenos">109</span></a>                <span class="c1"># Display the software title</span>
</span><span id="PTPManager-110"><a href="#PTPManager-110"><span class="linenos">110</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_software_title</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="PTPManager-111"><a href="#PTPManager-111"><span class="linenos">111</span></a>
</span><span id="PTPManager-112"><a href="#PTPManager-112"><span class="linenos">112</span></a>                <span class="c1"># Show the main menu header</span>
</span><span id="PTPManager-113"><a href="#PTPManager-113"><span class="linenos">113</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;main_title&quot;</span><span class="p">,</span> <span class="s2">&quot;PTP Management Menu&quot;</span><span class="p">,</span> <span class="s2">&quot;⏱️&quot;</span><span class="p">)</span>
</span><span id="PTPManager-114"><a href="#PTPManager-114"><span class="linenos">114</span></a>
</span><span id="PTPManager-115"><a href="#PTPManager-115"><span class="linenos">115</span></a>                <span class="c1"># Render a table of active PTP processes</span>
</span><span id="PTPManager-116"><a href="#PTPManager-116"><span class="linenos">116</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_ptp_processes</span><span class="p">()</span>
</span><span id="PTPManager-117"><a href="#PTPManager-117"><span class="linenos">117</span></a>
</span><span id="PTPManager-118"><a href="#PTPManager-118"><span class="linenos">118</span></a>                <span class="c1"># Prompt user with interactive menu</span>
</span><span id="PTPManager-119"><a href="#PTPManager-119"><span class="linenos">119</span></a>                <span class="n">choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="PTPManager-120"><a href="#PTPManager-120"><span class="linenos">120</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="p">[</span>
</span><span id="PTPManager-121"><a href="#PTPManager-121"><span class="linenos">121</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;⏱️ Start PTP&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;start_ptp&quot;</span><span class="p">},</span>
</span><span id="PTPManager-122"><a href="#PTPManager-122"><span class="linenos">122</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🛑 Stop PTP&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;stop_ptp&quot;</span><span class="p">},</span>
</span><span id="PTPManager-123"><a href="#PTPManager-123"><span class="linenos">123</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📄 Show PTP Logs&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;print_ptp_log&quot;</span><span class="p">},</span>
</span><span id="PTPManager-124"><a href="#PTPManager-124"><span class="linenos">124</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📡 Ping PTP Server&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;ping_server&quot;</span><span class="p">},</span>
</span><span id="PTPManager-125"><a href="#PTPManager-125"><span class="linenos">125</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🔄 Refresh view&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">},</span>
</span><span id="PTPManager-126"><a href="#PTPManager-126"><span class="linenos">126</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;❌ Exit&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;exit&quot;</span><span class="p">},</span>
</span><span id="PTPManager-127"><a href="#PTPManager-127"><span class="linenos">127</span></a>                    <span class="p">],</span>
</span><span id="PTPManager-128"><a href="#PTPManager-128"><span class="linenos">128</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PTPManager-129"><a href="#PTPManager-129"><span class="linenos">129</span></a>                <span class="p">)</span>
</span><span id="PTPManager-130"><a href="#PTPManager-130"><span class="linenos">130</span></a>
</span><span id="PTPManager-131"><a href="#PTPManager-131"><span class="linenos">131</span></a>                <span class="c1"># Map menu options to corresponding methods</span>
</span><span id="PTPManager-132"><a href="#PTPManager-132"><span class="linenos">132</span></a>                <span class="n">submenu</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PTPManager-133"><a href="#PTPManager-133"><span class="linenos">133</span></a>                    <span class="s2">&quot;start_ptp&quot;</span><span class="p">:</span>        <span class="bp">self</span><span class="o">.</span><span class="n">start_ptp</span><span class="p">,</span>
</span><span id="PTPManager-134"><a href="#PTPManager-134"><span class="linenos">134</span></a>                    <span class="s2">&quot;stop_ptp&quot;</span><span class="p">:</span>         <span class="bp">self</span><span class="o">.</span><span class="n">stop_ptp</span><span class="p">,</span>
</span><span id="PTPManager-135"><a href="#PTPManager-135"><span class="linenos">135</span></a>                    <span class="s2">&quot;print_ptp_log&quot;</span><span class="p">:</span>    <span class="bp">self</span><span class="o">.</span><span class="n">print_ptp_log</span><span class="p">,</span>
</span><span id="PTPManager-136"><a href="#PTPManager-136"><span class="linenos">136</span></a>                    <span class="s2">&quot;ping_server&quot;</span><span class="p">:</span>      <span class="bp">self</span><span class="o">.</span><span class="n">ping_server</span><span class="p">,</span>
</span><span id="PTPManager-137"><a href="#PTPManager-137"><span class="linenos">137</span></a>                <span class="p">}</span>
</span><span id="PTPManager-138"><a href="#PTPManager-138"><span class="linenos">138</span></a>
</span><span id="PTPManager-139"><a href="#PTPManager-139"><span class="linenos">139</span></a>                <span class="c1"># Handle user selection</span>
</span><span id="PTPManager-140"><a href="#PTPManager-140"><span class="linenos">140</span></a>                <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;exit&quot;</span><span class="p">:</span>
</span><span id="PTPManager-141"><a href="#PTPManager-141"><span class="linenos">141</span></a>                    <span class="k">break</span>
</span><span id="PTPManager-142"><a href="#PTPManager-142"><span class="linenos">142</span></a>                <span class="k">elif</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">:</span>
</span><span id="PTPManager-143"><a href="#PTPManager-143"><span class="linenos">143</span></a>                    <span class="n">action</span> <span class="o">=</span> <span class="n">submenu</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
</span><span id="PTPManager-144"><a href="#PTPManager-144"><span class="linenos">144</span></a>                    <span class="k">if</span> <span class="n">action</span><span class="p">:</span>
</span><span id="PTPManager-145"><a href="#PTPManager-145"><span class="linenos">145</span></a>                        <span class="n">action</span><span class="p">()</span>
</span><span id="PTPManager-146"><a href="#PTPManager-146"><span class="linenos">146</span></a>                        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🔙 Press ⏎ to return to the menu...&quot;</span><span class="p">)</span>
</span><span id="PTPManager-147"><a href="#PTPManager-147"><span class="linenos">147</span></a>
</span><span id="PTPManager-148"><a href="#PTPManager-148"><span class="linenos">148</span></a>        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="PTPManager-149"><a href="#PTPManager-149"><span class="linenos">149</span></a>            <span class="c1"># Gracefully handle Ctrl+C interruption</span>
</span><span id="PTPManager-150"><a href="#PTPManager-150"><span class="linenos">150</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;Exiting...&quot;</span><span class="p">)</span>
</span><span id="PTPManager-151"><a href="#PTPManager-151"><span class="linenos">151</span></a>
</span><span id="PTPManager-152"><a href="#PTPManager-152"><span class="linenos">152</span></a>
</span><span id="PTPManager-153"><a href="#PTPManager-153"><span class="linenos">153</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-154"><a href="#PTPManager-154"><span class="linenos">154</span></a><span class="c1"># 📌 Function: load_clients</span>
</span><span id="PTPManager-155"><a href="#PTPManager-155"><span class="linenos">155</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-156"><a href="#PTPManager-156"><span class="linenos">156</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_clients</span><span class="p">(</span>
</span><span id="PTPManager-157"><a href="#PTPManager-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PTPManager-158"><a href="#PTPManager-158"><span class="linenos">158</span></a>        <span class="n">file_cfg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PTPManager-159"><a href="#PTPManager-159"><span class="linenos">159</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PTPManager-160"><a href="#PTPManager-160"><span class="linenos">160</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="PTPManager-161"><a href="#PTPManager-161"><span class="linenos">161</span></a>        <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PTPManager-162"><a href="#PTPManager-162"><span class="linenos">162</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PTPManager-163"><a href="#PTPManager-163"><span class="linenos">163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager-164"><a href="#PTPManager-164"><span class="linenos">164</span></a><span class="sd">        Loads and validates PTP client configurations from a YAML file.</span>
</span><span id="PTPManager-165"><a href="#PTPManager-165"><span class="linenos">165</span></a>
</span><span id="PTPManager-166"><a href="#PTPManager-166"><span class="linenos">166</span></a><span class="sd">        If no file is specified, the user is prompted to select one interactively from the available</span>
</span><span id="PTPManager-167"><a href="#PTPManager-167"><span class="linenos">167</span></a><span class="sd">        YAML files in the configuration directory. Each client&#39;s network namespace is validated</span>
</span><span id="PTPManager-168"><a href="#PTPManager-168"><span class="linenos">168</span></a><span class="sd">        against the system. Clients with missing namespaces are skipped and reported.</span>
</span><span id="PTPManager-169"><a href="#PTPManager-169"><span class="linenos">169</span></a>
</span><span id="PTPManager-170"><a href="#PTPManager-170"><span class="linenos">170</span></a><span class="sd">        The YAML file must contain a `ptp_clients` section with client definitions.</span>
</span><span id="PTPManager-171"><a href="#PTPManager-171"><span class="linenos">171</span></a>
</span><span id="PTPManager-172"><a href="#PTPManager-172"><span class="linenos">172</span></a><span class="sd">        ### Args:</span>
</span><span id="PTPManager-173"><a href="#PTPManager-173"><span class="linenos">173</span></a><span class="sd">        - **file_cfg** (`Optional[str]`): Name of the YAML configuration file to load. If `None`, prompts the user interactively.</span>
</span><span id="PTPManager-174"><a href="#PTPManager-174"><span class="linenos">174</span></a><span class="sd">        - **logger** (`Optional[Any]`): Logger instance used for logging messages. Defaults to `None`.</span>
</span><span id="PTPManager-175"><a href="#PTPManager-175"><span class="linenos">175</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages. Defaults to `0`.</span>
</span><span id="PTPManager-176"><a href="#PTPManager-176"><span class="linenos">176</span></a><span class="sd">        - **quiet** (`bool`): If `True`, suppresses console output. Defaults to `True`.</span>
</span><span id="PTPManager-177"><a href="#PTPManager-177"><span class="linenos">177</span></a>
</span><span id="PTPManager-178"><a href="#PTPManager-178"><span class="linenos">178</span></a><span class="sd">        ### Returns:</span>
</span><span id="PTPManager-179"><a href="#PTPManager-179"><span class="linenos">179</span></a><span class="sd">        - `bool`: `True` if clients were successfully loaded and validated; `False` otherwise.</span>
</span><span id="PTPManager-180"><a href="#PTPManager-180"><span class="linenos">180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager-181"><a href="#PTPManager-181"><span class="linenos">181</span></a>
</span><span id="PTPManager-182"><a href="#PTPManager-182"><span class="linenos">182</span></a>        <span class="c1"># Show section title</span>
</span><span id="PTPManager-183"><a href="#PTPManager-183"><span class="linenos">183</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Loading PTP Clients&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager-184"><a href="#PTPManager-184"><span class="linenos">184</span></a>
</span><span id="PTPManager-185"><a href="#PTPManager-185"><span class="linenos">185</span></a>        <span class="c1"># If no file is provided, prompt user to select one</span>
</span><span id="PTPManager-186"><a href="#PTPManager-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="n">file_cfg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>            
</span><span id="PTPManager-187"><a href="#PTPManager-187"><span class="linenos">187</span></a>            <span class="n">files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PTPManager-188"><a href="#PTPManager-188"><span class="linenos">188</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">))</span>
</span><span id="PTPManager-189"><a href="#PTPManager-189"><span class="linenos">189</span></a>                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*.yaml&quot;</span><span class="p">)</span>
</span><span id="PTPManager-190"><a href="#PTPManager-190"><span class="linenos">190</span></a>                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
</span><span id="PTPManager-191"><a href="#PTPManager-191"><span class="linenos">191</span></a>            <span class="p">]</span>
</span><span id="PTPManager-192"><a href="#PTPManager-192"><span class="linenos">192</span></a>            
</span><span id="PTPManager-193"><a href="#PTPManager-193"><span class="linenos">193</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>
</span><span id="PTPManager-194"><a href="#PTPManager-194"><span class="linenos">194</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="PTPManager-195"><a href="#PTPManager-195"><span class="linenos">195</span></a>                    <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="PTPManager-196"><a href="#PTPManager-196"><span class="linenos">196</span></a>                    <span class="sa">f</span><span class="s2">&quot;No YAML configuration files found in &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span>
</span><span id="PTPManager-197"><a href="#PTPManager-197"><span class="linenos">197</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="PTPManager-198"><a href="#PTPManager-198"><span class="linenos">198</span></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="PTPManager-199"><a href="#PTPManager-199"><span class="linenos">199</span></a>                <span class="p">)</span>
</span><span id="PTPManager-200"><a href="#PTPManager-200"><span class="linenos">200</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="PTPManager-201"><a href="#PTPManager-201"><span class="linenos">201</span></a>
</span><span id="PTPManager-202"><a href="#PTPManager-202"><span class="linenos">202</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-203"><a href="#PTPManager-203"><span class="linenos">203</span></a>                <span class="n">choices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PTPManager-204"><a href="#PTPManager-204"><span class="linenos">204</span></a>                    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. 📄 </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span><span id="PTPManager-205"><a href="#PTPManager-205"><span class="linenos">205</span></a>                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager-206"><a href="#PTPManager-206"><span class="linenos">206</span></a>                <span class="p">]</span>
</span><span id="PTPManager-207"><a href="#PTPManager-207"><span class="linenos">207</span></a>                <span class="n">selected</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="PTPManager-208"><a href="#PTPManager-208"><span class="linenos">208</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
</span><span id="PTPManager-209"><a href="#PTPManager-209"><span class="linenos">209</span></a>                    <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Available Configuration Files:&quot;</span><span class="p">,</span>
</span><span id="PTPManager-210"><a href="#PTPManager-210"><span class="linenos">210</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span>
</span><span id="PTPManager-211"><a href="#PTPManager-211"><span class="linenos">211</span></a>                <span class="p">)</span>
</span><span id="PTPManager-212"><a href="#PTPManager-212"><span class="linenos">212</span></a>                <span class="n">filepath_cfg</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">selected</span>
</span><span id="PTPManager-213"><a href="#PTPManager-213"><span class="linenos">213</span></a>
</span><span id="PTPManager-214"><a href="#PTPManager-214"><span class="linenos">214</span></a>            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="PTPManager-215"><a href="#PTPManager-215"><span class="linenos">215</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation cancelled by user.&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-216"><a href="#PTPManager-216"><span class="linenos">216</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="PTPManager-217"><a href="#PTPManager-217"><span class="linenos">217</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PTPManager-218"><a href="#PTPManager-218"><span class="linenos">218</span></a>            <span class="n">filepath_cfg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">file_cfg</span>
</span><span id="PTPManager-219"><a href="#PTPManager-219"><span class="linenos">219</span></a>
</span><span id="PTPManager-220"><a href="#PTPManager-220"><span class="linenos">220</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-221"><a href="#PTPManager-221"><span class="linenos">221</span></a>            <span class="c1"># Load YAML data</span>
</span><span id="PTPManager-222"><a href="#PTPManager-222"><span class="linenos">222</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath_cfg</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="PTPManager-223"><a href="#PTPManager-223"><span class="linenos">223</span></a>                <span class="n">yaml_data</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="PTPManager-224"><a href="#PTPManager-224"><span class="linenos">224</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">yaml_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ptp_clients&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="PTPManager-225"><a href="#PTPManager-225"><span class="linenos">225</span></a>
</span><span id="PTPManager-226"><a href="#PTPManager-226"><span class="linenos">226</span></a>            <span class="c1"># Get currently existing namespaces</span>
</span><span id="PTPManager-227"><a href="#PTPManager-227"><span class="linenos">227</span></a>            <span class="n">ns_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;netns&quot;</span><span class="p">,</span> <span class="s2">&quot;list&quot;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager-228"><a href="#PTPManager-228"><span class="linenos">228</span></a>            <span class="n">existing_namespaces</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PTPManager-229"><a href="#PTPManager-229"><span class="linenos">229</span></a>                <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ns_result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="PTPManager-230"><a href="#PTPManager-230"><span class="linenos">230</span></a>            <span class="p">}</span>
</span><span id="PTPManager-231"><a href="#PTPManager-231"><span class="linenos">231</span></a>
</span><span id="PTPManager-232"><a href="#PTPManager-232"><span class="linenos">232</span></a>            <span class="n">skipped</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PTPManager-233"><a href="#PTPManager-233"><span class="linenos">233</span></a>
</span><span id="PTPManager-234"><a href="#PTPManager-234"><span class="linenos">234</span></a>            <span class="c1"># Validate each client namespace</span>
</span><span id="PTPManager-235"><a href="#PTPManager-235"><span class="linenos">235</span></a>            <span class="k">for</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">client_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="PTPManager-236"><a href="#PTPManager-236"><span class="linenos">236</span></a>                <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">client_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;namespace&quot;</span><span class="p">)</span>
</span><span id="PTPManager-237"><a href="#PTPManager-237"><span class="linenos">237</span></a>                <span class="k">if</span> <span class="n">ns</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_namespaces</span><span class="p">:</span>
</span><span id="PTPManager-238"><a href="#PTPManager-238"><span class="linenos">238</span></a>                    <span class="n">skipped</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">client_name</span><span class="p">,</span> <span class="n">ns</span><span class="p">))</span>
</span><span id="PTPManager-239"><a href="#PTPManager-239"><span class="linenos">239</span></a>                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">[</span><span class="n">client_name</span><span class="p">]</span>
</span><span id="PTPManager-240"><a href="#PTPManager-240"><span class="linenos">240</span></a>
</span><span id="PTPManager-241"><a href="#PTPManager-241"><span class="linenos">241</span></a>            <span class="c1"># Report missing namespaces</span>
</span><span id="PTPManager-242"><a href="#PTPManager-242"><span class="linenos">242</span></a>            <span class="k">if</span> <span class="n">skipped</span><span class="p">:</span>
</span><span id="PTPManager-243"><a href="#PTPManager-243"><span class="linenos">243</span></a>                <span class="n">missing</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⛔ </span><span class="si">{</span><span class="n">iface</span><span class="si">}</span><span class="s2"> → Namespace &#39;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span> <span class="k">for</span> <span class="n">iface</span><span class="p">,</span> <span class="n">ns</span> <span class="ow">in</span> <span class="n">skipped</span><span class="p">)</span>
</span><span id="PTPManager-244"><a href="#PTPManager-244"><span class="linenos">244</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ One or more namespaces are missing:</span><span class="se">\n</span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PTPManager-245"><a href="#PTPManager-245"><span class="linenos">245</span></a>
</span><span id="PTPManager-246"><a href="#PTPManager-246"><span class="linenos">246</span></a>            <span class="c1"># Confirm successful loading</span>
</span><span id="PTPManager-247"><a href="#PTPManager-247"><span class="linenos">247</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="PTPManager-248"><a href="#PTPManager-248"><span class="linenos">248</span></a>                <span class="s2">&quot;success&quot;</span><span class="p">,</span>
</span><span id="PTPManager-249"><a href="#PTPManager-249"><span class="linenos">249</span></a>                <span class="sa">f</span><span class="s2">&quot;Clients successfully loaded from </span><span class="si">{</span><span class="n">filepath_cfg</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
</span><span id="PTPManager-250"><a href="#PTPManager-250"><span class="linenos">250</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="PTPManager-251"><a href="#PTPManager-251"><span class="linenos">251</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="PTPManager-252"><a href="#PTPManager-252"><span class="linenos">252</span></a>            <span class="p">)</span>
</span><span id="PTPManager-253"><a href="#PTPManager-253"><span class="linenos">253</span></a>
</span><span id="PTPManager-254"><a href="#PTPManager-254"><span class="linenos">254</span></a>            <span class="c1"># Display loaded clients</span>
</span><span id="PTPManager-255"><a href="#PTPManager-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span>
</span><span id="PTPManager-256"><a href="#PTPManager-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded PTP Clients:&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-257"><a href="#PTPManager-257"><span class="linenos">257</span></a>                <span class="k">for</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="PTPManager-258"><a href="#PTPManager-258"><span class="linenos">258</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="PTPManager-259"><a href="#PTPManager-259"><span class="linenos">259</span></a>                        <span class="s2">&quot;info&quot;</span><span class="p">,</span>
</span><span id="PTPManager-260"><a href="#PTPManager-260"><span class="linenos">260</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2"> → Namespace: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;namespace&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> / Interface: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;interface&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> / Config: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PTPManager-261"><a href="#PTPManager-261"><span class="linenos">261</span></a>                        <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="PTPManager-262"><a href="#PTPManager-262"><span class="linenos">262</span></a>                        <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="PTPManager-263"><a href="#PTPManager-263"><span class="linenos">263</span></a>                    <span class="p">)</span>
</span><span id="PTPManager-264"><a href="#PTPManager-264"><span class="linenos">264</span></a>
</span><span id="PTPManager-265"><a href="#PTPManager-265"><span class="linenos">265</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="PTPManager-266"><a href="#PTPManager-266"><span class="linenos">266</span></a>
</span><span id="PTPManager-267"><a href="#PTPManager-267"><span class="linenos">267</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager-268"><a href="#PTPManager-268"><span class="linenos">268</span></a>            <span class="c1"># Handle YAML or validation errors</span>
</span><span id="PTPManager-269"><a href="#PTPManager-269"><span class="linenos">269</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="PTPManager-270"><a href="#PTPManager-270"><span class="linenos">270</span></a>                <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="PTPManager-271"><a href="#PTPManager-271"><span class="linenos">271</span></a>                <span class="sa">f</span><span class="s2">&quot;Error loading YAML file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PTPManager-272"><a href="#PTPManager-272"><span class="linenos">272</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="PTPManager-273"><a href="#PTPManager-273"><span class="linenos">273</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="PTPManager-274"><a href="#PTPManager-274"><span class="linenos">274</span></a>            <span class="p">)</span>
</span><span id="PTPManager-275"><a href="#PTPManager-275"><span class="linenos">275</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span><span id="PTPManager-276"><a href="#PTPManager-276"><span class="linenos">276</span></a>
</span><span id="PTPManager-277"><a href="#PTPManager-277"><span class="linenos">277</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-278"><a href="#PTPManager-278"><span class="linenos">278</span></a><span class="c1"># 📌 Function: start_ptp</span>
</span><span id="PTPManager-279"><a href="#PTPManager-279"><span class="linenos">279</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-280"><a href="#PTPManager-280"><span class="linenos">280</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">start_ptp</span><span class="p">(</span>
</span><span id="PTPManager-281"><a href="#PTPManager-281"><span class="linenos">281</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PTPManager-282"><a href="#PTPManager-282"><span class="linenos">282</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PTPManager-283"><a href="#PTPManager-283"><span class="linenos">283</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="PTPManager-284"><a href="#PTPManager-284"><span class="linenos">284</span></a>        <span class="n">stop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PTPManager-285"><a href="#PTPManager-285"><span class="linenos">285</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager-286"><a href="#PTPManager-286"><span class="linenos">286</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager-287"><a href="#PTPManager-287"><span class="linenos">287</span></a><span class="sd">        Launches `ptp4l` processes for all configured clients.</span>
</span><span id="PTPManager-288"><a href="#PTPManager-288"><span class="linenos">288</span></a>
</span><span id="PTPManager-289"><a href="#PTPManager-289"><span class="linenos">289</span></a><span class="sd">        If enabled, checks for existing `ptp4l` processes and prompts the user to stop them before starting new ones.</span>
</span><span id="PTPManager-290"><a href="#PTPManager-290"><span class="linenos">290</span></a><span class="sd">        If no clients are currently loaded, attempts to load them from configuration files.</span>
</span><span id="PTPManager-291"><a href="#PTPManager-291"><span class="linenos">291</span></a>
</span><span id="PTPManager-292"><a href="#PTPManager-292"><span class="linenos">292</span></a><span class="sd">        For each valid client, starts a `ptp4l` process within its corresponding network namespace using `sudo`,</span>
</span><span id="PTPManager-293"><a href="#PTPManager-293"><span class="linenos">293</span></a><span class="sd">        with output redirected to a dedicated log file. Displays process information including PID, log path, and command.</span>
</span><span id="PTPManager-294"><a href="#PTPManager-294"><span class="linenos">294</span></a>
</span><span id="PTPManager-295"><a href="#PTPManager-295"><span class="linenos">295</span></a><span class="sd">        ### Args</span>
</span><span id="PTPManager-296"><a href="#PTPManager-296"><span class="linenos">296</span></a><span class="sd">        - **logger** (`Optional[Any]`): Logger instance for logging messages. Defaults to `None`.</span>
</span><span id="PTPManager-297"><a href="#PTPManager-297"><span class="linenos">297</span></a><span class="sd">        - **extra_indent** (`int`): Indentation level for console messages. Defaults to `0`.</span>
</span><span id="PTPManager-298"><a href="#PTPManager-298"><span class="linenos">298</span></a><span class="sd">        - **stop** (`bool`): Whether to stop existing `ptp4l` processes before launching new ones. Defaults to `True`.</span>
</span><span id="PTPManager-299"><a href="#PTPManager-299"><span class="linenos">299</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager-300"><a href="#PTPManager-300"><span class="linenos">300</span></a>
</span><span id="PTPManager-301"><a href="#PTPManager-301"><span class="linenos">301</span></a>        <span class="c1"># Stop and clean actual clients if enabled</span>
</span><span id="PTPManager-302"><a href="#PTPManager-302"><span class="linenos">302</span></a>        <span class="k">if</span> <span class="n">stop</span><span class="p">:</span>
</span><span id="PTPManager-303"><a href="#PTPManager-303"><span class="linenos">303</span></a>
</span><span id="PTPManager-304"><a href="#PTPManager-304"><span class="linenos">304</span></a>            <span class="c1"># Check for existing ptp4l processes</span>
</span><span id="PTPManager-305"><a href="#PTPManager-305"><span class="linenos">305</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager-306"><a href="#PTPManager-306"><span class="linenos">306</span></a>            <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="PTPManager-307"><a href="#PTPManager-307"><span class="linenos">307</span></a>
</span><span id="PTPManager-308"><a href="#PTPManager-308"><span class="linenos">308</span></a>            <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager-309"><a href="#PTPManager-309"><span class="linenos">309</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;There are PTP clients already running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager-310"><a href="#PTPManager-310"><span class="linenos">310</span></a>                <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Confirm</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⚠️ Are you sure you want to stop the actual PTP processes?&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager-311"><a href="#PTPManager-311"><span class="linenos">311</span></a>                <span class="k">if</span> <span class="n">confirm</span><span class="p">:</span>
</span><span id="PTPManager-312"><a href="#PTPManager-312"><span class="linenos">312</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stop_ptp</span><span class="p">(</span><span class="n">preconfirmation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">extra_indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager-313"><a href="#PTPManager-313"><span class="linenos">313</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PTPManager-314"><a href="#PTPManager-314"><span class="linenos">314</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Not starting new PTP processes.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager-315"><a href="#PTPManager-315"><span class="linenos">315</span></a>                    <span class="k">return</span>
</span><span id="PTPManager-316"><a href="#PTPManager-316"><span class="linenos">316</span></a>
</span><span id="PTPManager-317"><a href="#PTPManager-317"><span class="linenos">317</span></a>        <span class="c1"># Load client configurations if not already loaded</span>
</span><span id="PTPManager-318"><a href="#PTPManager-318"><span class="linenos">318</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span>
</span><span id="PTPManager-319"><a href="#PTPManager-319"><span class="linenos">319</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_clients</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">extra_indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">):</span>
</span><span id="PTPManager-320"><a href="#PTPManager-320"><span class="linenos">320</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;Aborting operation due to failed client loading.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-321"><a href="#PTPManager-321"><span class="linenos">321</span></a>                <span class="k">return</span>
</span><span id="PTPManager-322"><a href="#PTPManager-322"><span class="linenos">322</span></a>
</span><span id="PTPManager-323"><a href="#PTPManager-323"><span class="linenos">323</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Starting PTP processes&quot;</span><span class="p">,</span> <span class="n">title_emoji</span><span class="o">=</span><span class="s2">&quot;⏱️&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager-324"><a href="#PTPManager-324"><span class="linenos">324</span></a>
</span><span id="PTPManager-325"><a href="#PTPManager-325"><span class="linenos">325</span></a>        <span class="k">for</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="PTPManager-326"><a href="#PTPManager-326"><span class="linenos">326</span></a>            <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptp4l_config_dir</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span>
</span><span id="PTPManager-327"><a href="#PTPManager-327"><span class="linenos">327</span></a>            <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
</span><span id="PTPManager-328"><a href="#PTPManager-328"><span class="linenos">328</span></a>            <span class="n">log_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;ptp-</span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2">.log&quot;</span>
</span><span id="PTPManager-329"><a href="#PTPManager-329"><span class="linenos">329</span></a>
</span><span id="PTPManager-330"><a href="#PTPManager-330"><span class="linenos">330</span></a>            <span class="c1"># Validate config file existence</span>
</span><span id="PTPManager-331"><a href="#PTPManager-331"><span class="linenos">331</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="PTPManager-332"><a href="#PTPManager-332"><span class="linenos">332</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="PTPManager-333"><a href="#PTPManager-333"><span class="linenos">333</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Configuration file not found: </span><span class="si">{</span><span class="n">config_path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-334"><a href="#PTPManager-334"><span class="linenos">334</span></a>                <span class="k">continue</span>
</span><span id="PTPManager-335"><a href="#PTPManager-335"><span class="linenos">335</span></a>
</span><span id="PTPManager-336"><a href="#PTPManager-336"><span class="linenos">336</span></a>            <span class="c1"># Ensure log directory exists and reset log file</span>
</span><span id="PTPManager-337"><a href="#PTPManager-337"><span class="linenos">337</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager-338"><a href="#PTPManager-338"><span class="linenos">338</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="PTPManager-339"><a href="#PTPManager-339"><span class="linenos">339</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s2">] Log reset for </span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PTPManager-340"><a href="#PTPManager-340"><span class="linenos">340</span></a>
</span><span id="PTPManager-341"><a href="#PTPManager-341"><span class="linenos">341</span></a>            <span class="c1"># Build ptp4l command</span>
</span><span id="PTPManager-342"><a href="#PTPManager-342"><span class="linenos">342</span></a>            <span class="n">command</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PTPManager-343"><a href="#PTPManager-343"><span class="linenos">343</span></a>                <span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;netns&quot;</span><span class="p">,</span> <span class="s2">&quot;exec&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span>
</span><span id="PTPManager-344"><a href="#PTPManager-344"><span class="linenos">344</span></a>                <span class="s2">&quot;ptp4l&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_path</span><span class="p">),</span> <span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span>
</span><span id="PTPManager-345"><a href="#PTPManager-345"><span class="linenos">345</span></a>            <span class="p">]</span>
</span><span id="PTPManager-346"><a href="#PTPManager-346"><span class="linenos">346</span></a>
</span><span id="PTPManager-347"><a href="#PTPManager-347"><span class="linenos">347</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-348"><a href="#PTPManager-348"><span class="linenos">348</span></a>                <span class="c1"># Launch ptp4l process with sudo and redirect output to log</span>
</span><span id="PTPManager-349"><a href="#PTPManager-349"><span class="linenos">349</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">log_file</span><span class="p">:</span>
</span><span id="PTPManager-350"><a href="#PTPManager-350"><span class="linenos">350</span></a>                    <span class="n">ptp_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span id="PTPManager-351"><a href="#PTPManager-351"><span class="linenos">351</span></a>                        <span class="p">[</span><span class="s2">&quot;sudo&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">command</span><span class="p">,</span>
</span><span id="PTPManager-352"><a href="#PTPManager-352"><span class="linenos">352</span></a>                        <span class="n">stdout</span><span class="o">=</span><span class="n">log_file</span><span class="p">,</span>
</span><span id="PTPManager-353"><a href="#PTPManager-353"><span class="linenos">353</span></a>                        <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span>
</span><span id="PTPManager-354"><a href="#PTPManager-354"><span class="linenos">354</span></a>                        <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span>
</span><span id="PTPManager-355"><a href="#PTPManager-355"><span class="linenos">355</span></a>                        <span class="n">close_fds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PTPManager-356"><a href="#PTPManager-356"><span class="linenos">356</span></a>                        <span class="n">preexec_fn</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">setpgrp</span>
</span><span id="PTPManager-357"><a href="#PTPManager-357"><span class="linenos">357</span></a>                    <span class="p">)</span>
</span><span id="PTPManager-358"><a href="#PTPManager-358"><span class="linenos">358</span></a>
</span><span id="PTPManager-359"><a href="#PTPManager-359"><span class="linenos">359</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="PTPManager-360"><a href="#PTPManager-360"><span class="linenos">360</span></a>
</span><span id="PTPManager-361"><a href="#PTPManager-361"><span class="linenos">361</span></a>                <span class="c1"># Locate the actual ptp4l child process</span>
</span><span id="PTPManager-362"><a href="#PTPManager-362"><span class="linenos">362</span></a>                <span class="n">ptp4l_proc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PTPManager-363"><a href="#PTPManager-363"><span class="linenos">363</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-364"><a href="#PTPManager-364"><span class="linenos">364</span></a>                    <span class="n">parent</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">ptp_process</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
</span><span id="PTPManager-365"><a href="#PTPManager-365"><span class="linenos">365</span></a>                    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="PTPManager-366"><a href="#PTPManager-366"><span class="linenos">366</span></a>                        <span class="k">if</span> <span class="s2">&quot;ptp4l&quot;</span> <span class="ow">in</span> <span class="n">child</span><span class="o">.</span><span class="n">name</span><span class="p">():</span>
</span><span id="PTPManager-367"><a href="#PTPManager-367"><span class="linenos">367</span></a>                            <span class="n">ptp4l_proc</span> <span class="o">=</span> <span class="n">child</span>
</span><span id="PTPManager-368"><a href="#PTPManager-368"><span class="linenos">368</span></a>                            <span class="k">break</span>
</span><span id="PTPManager-369"><a href="#PTPManager-369"><span class="linenos">369</span></a>                <span class="k">except</span> <span class="n">psutil</span><span class="o">.</span><span class="n">NoSuchProcess</span><span class="p">:</span>
</span><span id="PTPManager-370"><a href="#PTPManager-370"><span class="linenos">370</span></a>                    <span class="k">pass</span>
</span><span id="PTPManager-371"><a href="#PTPManager-371"><span class="linenos">371</span></a>
</span><span id="PTPManager-372"><a href="#PTPManager-372"><span class="linenos">372</span></a>                <span class="k">if</span> <span class="n">ptp4l_proc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager-373"><a href="#PTPManager-373"><span class="linenos">373</span></a>                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="PTPManager-374"><a href="#PTPManager-374"><span class="linenos">374</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;PTP4L process not found in </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-375"><a href="#PTPManager-375"><span class="linenos">375</span></a>                    <span class="k">continue</span>
</span><span id="PTPManager-376"><a href="#PTPManager-376"><span class="linenos">376</span></a>
</span><span id="PTPManager-377"><a href="#PTPManager-377"><span class="linenos">377</span></a>                <span class="c1"># Format and display process information</span>
</span><span id="PTPManager-378"><a href="#PTPManager-378"><span class="linenos">378</span></a>                <span class="n">start_time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%D-%H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="PTPManager-379"><a href="#PTPManager-379"><span class="linenos">379</span></a>                <span class="n">cmd_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">command</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
</span><span id="PTPManager-380"><a href="#PTPManager-380"><span class="linenos">380</span></a>
</span><span id="PTPManager-381"><a href="#PTPManager-381"><span class="linenos">381</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="PTPManager-382"><a href="#PTPManager-382"><span class="linenos">382</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;PTP launched successfully.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-383"><a href="#PTPManager-383"><span class="linenos">383</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Client: </span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2"> | PID: </span><span class="si">{</span><span class="n">ptp4l_proc</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2"> | Started at: </span><span class="si">{</span><span class="n">start_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-384"><a href="#PTPManager-384"><span class="linenos">384</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Log: </span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-385"><a href="#PTPManager-385"><span class="linenos">385</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Command: </span><span class="si">{</span><span class="n">cmd_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-386"><a href="#PTPManager-386"><span class="linenos">386</span></a>
</span><span id="PTPManager-387"><a href="#PTPManager-387"><span class="linenos">387</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager-388"><a href="#PTPManager-388"><span class="linenos">388</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="PTPManager-389"><a href="#PTPManager-389"><span class="linenos">389</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error launching PTP on </span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-390"><a href="#PTPManager-390"><span class="linenos">390</span></a>
</span><span id="PTPManager-391"><a href="#PTPManager-391"><span class="linenos">391</span></a>
</span><span id="PTPManager-392"><a href="#PTPManager-392"><span class="linenos">392</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-393"><a href="#PTPManager-393"><span class="linenos">393</span></a><span class="c1"># 📌 Function: stop_ptp</span>
</span><span id="PTPManager-394"><a href="#PTPManager-394"><span class="linenos">394</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-395"><a href="#PTPManager-395"><span class="linenos">395</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_ptp</span><span class="p">(</span>
</span><span id="PTPManager-396"><a href="#PTPManager-396"><span class="linenos">396</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PTPManager-397"><a href="#PTPManager-397"><span class="linenos">397</span></a>        <span class="n">preconfirmation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PTPManager-398"><a href="#PTPManager-398"><span class="linenos">398</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PTPManager-399"><a href="#PTPManager-399"><span class="linenos">399</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="PTPManager-400"><a href="#PTPManager-400"><span class="linenos">400</span></a>        <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PTPManager-401"><a href="#PTPManager-401"><span class="linenos">401</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager-402"><a href="#PTPManager-402"><span class="linenos">402</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager-403"><a href="#PTPManager-403"><span class="linenos">403</span></a><span class="sd">        Terminates all active `ptp4l` processes and removes associated log files.</span>
</span><span id="PTPManager-404"><a href="#PTPManager-404"><span class="linenos">404</span></a>
</span><span id="PTPManager-405"><a href="#PTPManager-405"><span class="linenos">405</span></a><span class="sd">        Detects running `ptp4l` processes and optionally prompts the user for confirmation before terminating them.</span>
</span><span id="PTPManager-406"><a href="#PTPManager-406"><span class="linenos">406</span></a><span class="sd">        After stopping the processes, it deletes all related log files and clears the loaded client configurations.</span>
</span><span id="PTPManager-407"><a href="#PTPManager-407"><span class="linenos">407</span></a>
</span><span id="PTPManager-408"><a href="#PTPManager-408"><span class="linenos">408</span></a><span class="sd">        ### Args</span>
</span><span id="PTPManager-409"><a href="#PTPManager-409"><span class="linenos">409</span></a><span class="sd">        - **preconfirmation** (`Optional[bool]`): If `True`, skips the confirmation prompt. Defaults to `False`.</span>
</span><span id="PTPManager-410"><a href="#PTPManager-410"><span class="linenos">410</span></a><span class="sd">        - **logger** (`Optional[Any]`): Logger instance for logging messages. Defaults to `None`.</span>
</span><span id="PTPManager-411"><a href="#PTPManager-411"><span class="linenos">411</span></a><span class="sd">        - **extra_indent** (`int`): Indentation level for console messages. Defaults to `0`.</span>
</span><span id="PTPManager-412"><a href="#PTPManager-412"><span class="linenos">412</span></a><span class="sd">        - **quiet** (`bool`): If `True`, suppresses non-critical console output. Defaults to `True`.</span>
</span><span id="PTPManager-413"><a href="#PTPManager-413"><span class="linenos">413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager-414"><a href="#PTPManager-414"><span class="linenos">414</span></a>
</span><span id="PTPManager-415"><a href="#PTPManager-415"><span class="linenos">415</span></a>        <span class="c1"># Show section title</span>
</span><span id="PTPManager-416"><a href="#PTPManager-416"><span class="linenos">416</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Stopping ptp processes&quot;</span><span class="p">,</span> <span class="s2">&quot;🛑&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager-417"><a href="#PTPManager-417"><span class="linenos">417</span></a>
</span><span id="PTPManager-418"><a href="#PTPManager-418"><span class="linenos">418</span></a>        <span class="c1"># Check for running ptp4l processes</span>
</span><span id="PTPManager-419"><a href="#PTPManager-419"><span class="linenos">419</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager-420"><a href="#PTPManager-420"><span class="linenos">420</span></a>        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="PTPManager-421"><a href="#PTPManager-421"><span class="linenos">421</span></a>
</span><span id="PTPManager-422"><a href="#PTPManager-422"><span class="linenos">422</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager-423"><a href="#PTPManager-423"><span class="linenos">423</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;No active ptp4l processes found.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-424"><a href="#PTPManager-424"><span class="linenos">424</span></a>            <span class="k">return</span>
</span><span id="PTPManager-425"><a href="#PTPManager-425"><span class="linenos">425</span></a>
</span><span id="PTPManager-426"><a href="#PTPManager-426"><span class="linenos">426</span></a>        <span class="c1"># Ask for confirmation unless preconfirmed</span>
</span><span id="PTPManager-427"><a href="#PTPManager-427"><span class="linenos">427</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">preconfirmation</span><span class="p">:</span>
</span><span id="PTPManager-428"><a href="#PTPManager-428"><span class="linenos">428</span></a>            <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Confirm</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⚠️ Are you sure you want to stop the PTP processes?&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager-429"><a href="#PTPManager-429"><span class="linenos">429</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span>
</span><span id="PTPManager-430"><a href="#PTPManager-430"><span class="linenos">430</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Stop operation cancelled.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-431"><a href="#PTPManager-431"><span class="linenos">431</span></a>                <span class="k">return</span>
</span><span id="PTPManager-432"><a href="#PTPManager-432"><span class="linenos">432</span></a>
</span><span id="PTPManager-433"><a href="#PTPManager-433"><span class="linenos">433</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-434"><a href="#PTPManager-434"><span class="linenos">434</span></a>            <span class="c1"># Kill each ptp4l process</span>
</span><span id="PTPManager-435"><a href="#PTPManager-435"><span class="linenos">435</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Killing all ptp4l processes:&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-436"><a href="#PTPManager-436"><span class="linenos">436</span></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager-437"><a href="#PTPManager-437"><span class="linenos">437</span></a>                <span class="n">pid</span><span class="p">,</span> <span class="o">*</span><span class="n">cmd</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="PTPManager-438"><a href="#PTPManager-438"><span class="linenos">438</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Killing PTP4l process with PID </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> → </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-439"><a href="#PTPManager-439"><span class="linenos">439</span></a>                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="s2">&quot;kill&quot;</span><span class="p">,</span> <span class="s2">&quot;-9&quot;</span><span class="p">,</span> <span class="n">pid</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager-440"><a href="#PTPManager-440"><span class="linenos">440</span></a>
</span><span id="PTPManager-441"><a href="#PTPManager-441"><span class="linenos">441</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;All ptp4l processes have been terminated.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-442"><a href="#PTPManager-442"><span class="linenos">442</span></a>
</span><span id="PTPManager-443"><a href="#PTPManager-443"><span class="linenos">443</span></a>        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager-444"><a href="#PTPManager-444"><span class="linenos">444</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error stopping ptp4l processes: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-445"><a href="#PTPManager-445"><span class="linenos">445</span></a>
</span><span id="PTPManager-446"><a href="#PTPManager-446"><span class="linenos">446</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-447"><a href="#PTPManager-447"><span class="linenos">447</span></a>            <span class="c1"># Check and clean log directory</span>
</span><span id="PTPManager-448"><a href="#PTPManager-448"><span class="linenos">448</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="PTPManager-449"><a href="#PTPManager-449"><span class="linenos">449</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Log directory does not exist: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-450"><a href="#PTPManager-450"><span class="linenos">450</span></a>                <span class="k">return</span>
</span><span id="PTPManager-451"><a href="#PTPManager-451"><span class="linenos">451</span></a>
</span><span id="PTPManager-452"><a href="#PTPManager-452"><span class="linenos">452</span></a>            <span class="n">logfiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()]</span>
</span><span id="PTPManager-453"><a href="#PTPManager-453"><span class="linenos">453</span></a>
</span><span id="PTPManager-454"><a href="#PTPManager-454"><span class="linenos">454</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">logfiles</span><span class="p">:</span>
</span><span id="PTPManager-455"><a href="#PTPManager-455"><span class="linenos">455</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No log files found in: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-456"><a href="#PTPManager-456"><span class="linenos">456</span></a>                <span class="k">return</span>
</span><span id="PTPManager-457"><a href="#PTPManager-457"><span class="linenos">457</span></a>
</span><span id="PTPManager-458"><a href="#PTPManager-458"><span class="linenos">458</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Removing all ptp4l log files:&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-459"><a href="#PTPManager-459"><span class="linenos">459</span></a>
</span><span id="PTPManager-460"><a href="#PTPManager-460"><span class="linenos">460</span></a>            <span class="c1"># Delete each log file</span>
</span><span id="PTPManager-461"><a href="#PTPManager-461"><span class="linenos">461</span></a>            <span class="k">for</span> <span class="n">archivo</span> <span class="ow">in</span> <span class="n">logfiles</span><span class="p">:</span>
</span><span id="PTPManager-462"><a href="#PTPManager-462"><span class="linenos">462</span></a>                <span class="n">logpath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">/</span> <span class="n">archivo</span>
</span><span id="PTPManager-463"><a href="#PTPManager-463"><span class="linenos">463</span></a>                <span class="k">if</span> <span class="n">logpath</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="PTPManager-464"><a href="#PTPManager-464"><span class="linenos">464</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-465"><a href="#PTPManager-465"><span class="linenos">465</span></a>                        <span class="n">logpath</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</span><span id="PTPManager-466"><a href="#PTPManager-466"><span class="linenos">466</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Deleted log file: </span><span class="si">{</span><span class="n">logpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-467"><a href="#PTPManager-467"><span class="linenos">467</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager-468"><a href="#PTPManager-468"><span class="linenos">468</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Failed to delete log file </span><span class="si">{</span><span class="n">logpath</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-469"><a href="#PTPManager-469"><span class="linenos">469</span></a>
</span><span id="PTPManager-470"><a href="#PTPManager-470"><span class="linenos">470</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;All log files have been processed.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-471"><a href="#PTPManager-471"><span class="linenos">471</span></a>
</span><span id="PTPManager-472"><a href="#PTPManager-472"><span class="linenos">472</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager-473"><a href="#PTPManager-473"><span class="linenos">473</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unexpected error while deleting log files: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager-474"><a href="#PTPManager-474"><span class="linenos">474</span></a>
</span><span id="PTPManager-475"><a href="#PTPManager-475"><span class="linenos">475</span></a>        <span class="c1"># Clear loaded client configurations</span>
</span><span id="PTPManager-476"><a href="#PTPManager-476"><span class="linenos">476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span> <span class="o">=</span> <span class="p">{}</span>
</span><span id="PTPManager-477"><a href="#PTPManager-477"><span class="linenos">477</span></a>
</span><span id="PTPManager-478"><a href="#PTPManager-478"><span class="linenos">478</span></a>
</span><span id="PTPManager-479"><a href="#PTPManager-479"><span class="linenos">479</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-480"><a href="#PTPManager-480"><span class="linenos">480</span></a><span class="c1"># 📌 Function: print_ptp_log</span>
</span><span id="PTPManager-481"><a href="#PTPManager-481"><span class="linenos">481</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-482"><a href="#PTPManager-482"><span class="linenos">482</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">print_ptp_log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager-483"><a href="#PTPManager-483"><span class="linenos">483</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager-484"><a href="#PTPManager-484"><span class="linenos">484</span></a><span class="sd">        Displays and follows the real-time log of a selected PTP client.</span>
</span><span id="PTPManager-485"><a href="#PTPManager-485"><span class="linenos">485</span></a>
</span><span id="PTPManager-486"><a href="#PTPManager-486"><span class="linenos">486</span></a><span class="sd">        Lists all available PTP log files corresponding to the namespaces defined in the `ptp_clients` dictionary.</span>
</span><span id="PTPManager-487"><a href="#PTPManager-487"><span class="linenos">487</span></a><span class="sd">        Prompts the user to select one and uses `tail -F` to stream the log output in real time.</span>
</span><span id="PTPManager-488"><a href="#PTPManager-488"><span class="linenos">488</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager-489"><a href="#PTPManager-489"><span class="linenos">489</span></a>
</span><span id="PTPManager-490"><a href="#PTPManager-490"><span class="linenos">490</span></a>        <span class="c1"># Show section title</span>
</span><span id="PTPManager-491"><a href="#PTPManager-491"><span class="linenos">491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Printing ptp logs&quot;</span><span class="p">,</span> <span class="s2">&quot;📄&quot;</span><span class="p">)</span>
</span><span id="PTPManager-492"><a href="#PTPManager-492"><span class="linenos">492</span></a>
</span><span id="PTPManager-493"><a href="#PTPManager-493"><span class="linenos">493</span></a>        <span class="c1"># Check if ptp4l is running</span>
</span><span id="PTPManager-494"><a href="#PTPManager-494"><span class="linenos">494</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager-495"><a href="#PTPManager-495"><span class="linenos">495</span></a>        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="PTPManager-496"><a href="#PTPManager-496"><span class="linenos">496</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager-497"><a href="#PTPManager-497"><span class="linenos">497</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No PTP processes have been started or are currently running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager-498"><a href="#PTPManager-498"><span class="linenos">498</span></a>            <span class="k">return</span>
</span><span id="PTPManager-499"><a href="#PTPManager-499"><span class="linenos">499</span></a>
</span><span id="PTPManager-500"><a href="#PTPManager-500"><span class="linenos">500</span></a>        <span class="c1"># Search for log files matching the pattern ptp-&lt;name&gt;.log</span>
</span><span id="PTPManager-501"><a href="#PTPManager-501"><span class="linenos">501</span></a>        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^ptp-(.+)\.log$&quot;</span><span class="p">)</span>
</span><span id="PTPManager-502"><a href="#PTPManager-502"><span class="linenos">502</span></a>        <span class="n">available_logs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PTPManager-503"><a href="#PTPManager-503"><span class="linenos">503</span></a>
</span><span id="PTPManager-504"><a href="#PTPManager-504"><span class="linenos">504</span></a>        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
</span><span id="PTPManager-505"><a href="#PTPManager-505"><span class="linenos">505</span></a>            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="PTPManager-506"><a href="#PTPManager-506"><span class="linenos">506</span></a>                <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="PTPManager-507"><a href="#PTPManager-507"><span class="linenos">507</span></a>                <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
</span><span id="PTPManager-508"><a href="#PTPManager-508"><span class="linenos">508</span></a>                    <span class="n">available_logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span><span id="PTPManager-509"><a href="#PTPManager-509"><span class="linenos">509</span></a>
</span><span id="PTPManager-510"><a href="#PTPManager-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">available_logs</span><span class="p">:</span>
</span><span id="PTPManager-511"><a href="#PTPManager-511"><span class="linenos">511</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No log files found for the defined namespaces.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager-512"><a href="#PTPManager-512"><span class="linenos">512</span></a>            <span class="k">return</span>
</span><span id="PTPManager-513"><a href="#PTPManager-513"><span class="linenos">513</span></a>
</span><span id="PTPManager-514"><a href="#PTPManager-514"><span class="linenos">514</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-515"><a href="#PTPManager-515"><span class="linenos">515</span></a>            <span class="c1"># Build menu choices from log file names</span>
</span><span id="PTPManager-516"><a href="#PTPManager-516"><span class="linenos">516</span></a>            <span class="n">choices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PTPManager-517"><a href="#PTPManager-517"><span class="linenos">517</span></a>                <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. 📄 </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span><span id="PTPManager-518"><a href="#PTPManager-518"><span class="linenos">518</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">available_logs</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager-519"><a href="#PTPManager-519"><span class="linenos">519</span></a>            <span class="p">]</span>
</span><span id="PTPManager-520"><a href="#PTPManager-520"><span class="linenos">520</span></a>
</span><span id="PTPManager-521"><a href="#PTPManager-521"><span class="linenos">521</span></a>            <span class="c1"># Prompt user to select a log</span>
</span><span id="PTPManager-522"><a href="#PTPManager-522"><span class="linenos">522</span></a>            <span class="n">selected</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="PTPManager-523"><a href="#PTPManager-523"><span class="linenos">523</span></a>                <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
</span><span id="PTPManager-524"><a href="#PTPManager-524"><span class="linenos">524</span></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Available PTP Logs:&quot;</span><span class="p">,</span>
</span><span id="PTPManager-525"><a href="#PTPManager-525"><span class="linenos">525</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PTPManager-526"><a href="#PTPManager-526"><span class="linenos">526</span></a>            <span class="p">)</span>
</span><span id="PTPManager-527"><a href="#PTPManager-527"><span class="linenos">527</span></a>
</span><span id="PTPManager-528"><a href="#PTPManager-528"><span class="linenos">528</span></a>            <span class="c1"># Build full path to the selected log file</span>
</span><span id="PTPManager-529"><a href="#PTPManager-529"><span class="linenos">529</span></a>            <span class="n">log_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;ptp-</span><span class="si">{</span><span class="n">selected</span><span class="si">}</span><span class="s2">.log&quot;</span>
</span><span id="PTPManager-530"><a href="#PTPManager-530"><span class="linenos">530</span></a>
</span><span id="PTPManager-531"><a href="#PTPManager-531"><span class="linenos">531</span></a>        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="PTPManager-532"><a href="#PTPManager-532"><span class="linenos">532</span></a>            <span class="c1"># Handle cancellation</span>
</span><span id="PTPManager-533"><a href="#PTPManager-533"><span class="linenos">533</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation cancelled by user.&quot;</span><span class="p">)</span>
</span><span id="PTPManager-534"><a href="#PTPManager-534"><span class="linenos">534</span></a>            <span class="k">return</span>
</span><span id="PTPManager-535"><a href="#PTPManager-535"><span class="linenos">535</span></a>
</span><span id="PTPManager-536"><a href="#PTPManager-536"><span class="linenos">536</span></a>        <span class="c1"># Display the log in real time</span>
</span><span id="PTPManager-537"><a href="#PTPManager-537"><span class="linenos">537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">real_time_log</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>
</span><span id="PTPManager-538"><a href="#PTPManager-538"><span class="linenos">538</span></a>
</span><span id="PTPManager-539"><a href="#PTPManager-539"><span class="linenos">539</span></a>
</span><span id="PTPManager-540"><a href="#PTPManager-540"><span class="linenos">540</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-541"><a href="#PTPManager-541"><span class="linenos">541</span></a><span class="c1"># 📌 Function: ping_server</span>
</span><span id="PTPManager-542"><a href="#PTPManager-542"><span class="linenos">542</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="PTPManager-543"><a href="#PTPManager-543"><span class="linenos">543</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ping_server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager-544"><a href="#PTPManager-544"><span class="linenos">544</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager-545"><a href="#PTPManager-545"><span class="linenos">545</span></a><span class="sd">        Performs a ping test to the PTP server from each configured namespace.</span>
</span><span id="PTPManager-546"><a href="#PTPManager-546"><span class="linenos">546</span></a>
</span><span id="PTPManager-547"><a href="#PTPManager-547"><span class="linenos">547</span></a><span class="sd">        For each client, extracts the server&#39;s IP address from its `.config` file by locating the line containing `&#39;UDPv4&#39;`.</span>
</span><span id="PTPManager-548"><a href="#PTPManager-548"><span class="linenos">548</span></a><span class="sd">        Then, executes a ping command from the corresponding network namespace to verify connectivity.</span>
</span><span id="PTPManager-549"><a href="#PTPManager-549"><span class="linenos">549</span></a><span class="sd">        Displays the result of each ping attempt in the console.</span>
</span><span id="PTPManager-550"><a href="#PTPManager-550"><span class="linenos">550</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager-551"><a href="#PTPManager-551"><span class="linenos">551</span></a>
</span><span id="PTPManager-552"><a href="#PTPManager-552"><span class="linenos">552</span></a>        <span class="c1"># Check if ptp4l is currently running</span>
</span><span id="PTPManager-553"><a href="#PTPManager-553"><span class="linenos">553</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager-554"><a href="#PTPManager-554"><span class="linenos">554</span></a>        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="PTPManager-555"><a href="#PTPManager-555"><span class="linenos">555</span></a>        <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager-556"><a href="#PTPManager-556"><span class="linenos">556</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;PTP processes have been started or are currently running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager-557"><a href="#PTPManager-557"><span class="linenos">557</span></a>            <span class="k">return</span>
</span><span id="PTPManager-558"><a href="#PTPManager-558"><span class="linenos">558</span></a>
</span><span id="PTPManager-559"><a href="#PTPManager-559"><span class="linenos">559</span></a>        <span class="c1"># Load client configurations</span>
</span><span id="PTPManager-560"><a href="#PTPManager-560"><span class="linenos">560</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_clients</span><span class="p">():</span>
</span><span id="PTPManager-561"><a href="#PTPManager-561"><span class="linenos">561</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Aborting ping test due to failed client loading.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager-562"><a href="#PTPManager-562"><span class="linenos">562</span></a>            <span class="k">return</span>
</span><span id="PTPManager-563"><a href="#PTPManager-563"><span class="linenos">563</span></a>
</span><span id="PTPManager-564"><a href="#PTPManager-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Pinging PTP Server from each Namespace&quot;</span><span class="p">,</span> <span class="s2">&quot;📡&quot;</span><span class="p">)</span>
</span><span id="PTPManager-565"><a href="#PTPManager-565"><span class="linenos">565</span></a>
</span><span id="PTPManager-566"><a href="#PTPManager-566"><span class="linenos">566</span></a>        <span class="c1"># Iterate over each client to perform ping</span>
</span><span id="PTPManager-567"><a href="#PTPManager-567"><span class="linenos">567</span></a>        <span class="k">for</span> <span class="n">iface</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="PTPManager-568"><a href="#PTPManager-568"><span class="linenos">568</span></a>            <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
</span><span id="PTPManager-569"><a href="#PTPManager-569"><span class="linenos">569</span></a>            <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptp4l_config_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span>
</span><span id="PTPManager-570"><a href="#PTPManager-570"><span class="linenos">570</span></a>
</span><span id="PTPManager-571"><a href="#PTPManager-571"><span class="linenos">571</span></a>            <span class="c1"># Extract server IP from config file</span>
</span><span id="PTPManager-572"><a href="#PTPManager-572"><span class="linenos">572</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-573"><a href="#PTPManager-573"><span class="linenos">573</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="PTPManager-574"><a href="#PTPManager-574"><span class="linenos">574</span></a>                    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="PTPManager-575"><a href="#PTPManager-575"><span class="linenos">575</span></a>
</span><span id="PTPManager-576"><a href="#PTPManager-576"><span class="linenos">576</span></a>                <span class="n">server_ip</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PTPManager-577"><a href="#PTPManager-577"><span class="linenos">577</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager-578"><a href="#PTPManager-578"><span class="linenos">578</span></a>                    <span class="k">if</span> <span class="s2">&quot;UDPv4&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="PTPManager-579"><a href="#PTPManager-579"><span class="linenos">579</span></a>                        <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="PTPManager-580"><a href="#PTPManager-580"><span class="linenos">580</span></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="PTPManager-581"><a href="#PTPManager-581"><span class="linenos">581</span></a>                            <span class="n">server_ip</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="PTPManager-582"><a href="#PTPManager-582"><span class="linenos">582</span></a>                            <span class="k">break</span>
</span><span id="PTPManager-583"><a href="#PTPManager-583"><span class="linenos">583</span></a>
</span><span id="PTPManager-584"><a href="#PTPManager-584"><span class="linenos">584</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">server_ip</span><span class="p">:</span>
</span><span id="PTPManager-585"><a href="#PTPManager-585"><span class="linenos">585</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No &#39;UDPv4&#39; entry found in config for </span><span class="si">{</span><span class="n">iface</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager-586"><a href="#PTPManager-586"><span class="linenos">586</span></a>                    <span class="k">continue</span>
</span><span id="PTPManager-587"><a href="#PTPManager-587"><span class="linenos">587</span></a>
</span><span id="PTPManager-588"><a href="#PTPManager-588"><span class="linenos">588</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager-589"><a href="#PTPManager-589"><span class="linenos">589</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error reading config file for </span><span class="si">{</span><span class="n">iface</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager-590"><a href="#PTPManager-590"><span class="linenos">590</span></a>                <span class="k">continue</span>
</span><span id="PTPManager-591"><a href="#PTPManager-591"><span class="linenos">591</span></a>
</span><span id="PTPManager-592"><a href="#PTPManager-592"><span class="linenos">592</span></a>            <span class="c1"># Notify user and execute ping</span>
</span><span id="PTPManager-593"><a href="#PTPManager-593"><span class="linenos">593</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Pinging from </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">server_ip</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager-594"><a href="#PTPManager-594"><span class="linenos">594</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager-595"><a href="#PTPManager-595"><span class="linenos">595</span></a>                <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span>
</span><span id="PTPManager-596"><a href="#PTPManager-596"><span class="linenos">596</span></a>                    <span class="p">[</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;netns&quot;</span><span class="p">,</span> <span class="s2">&quot;exec&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="s2">&quot;ping&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="n">server_ip</span><span class="p">],</span>
</span><span id="PTPManager-597"><a href="#PTPManager-597"><span class="linenos">597</span></a>                    <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span>
</span><span id="PTPManager-598"><a href="#PTPManager-598"><span class="linenos">598</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="PTPManager-599"><a href="#PTPManager-599"><span class="linenos">599</span></a>
</span><span id="PTPManager-600"><a href="#PTPManager-600"><span class="linenos">600</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="PTPManager-601"><a href="#PTPManager-601"><span class="linenos">601</span></a>
</span><span id="PTPManager-602"><a href="#PTPManager-602"><span class="linenos">602</span></a>            <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager-603"><a href="#PTPManager-603"><span class="linenos">603</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Ping failed from </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="PTPManager-604"><a href="#PTPManager-604"><span class="linenos">604</span></a>
</span><span id="PTPManager-605"><a href="#PTPManager-605"><span class="linenos">605</span></a>            <span class="c1"># Brief pause before next ping</span>
</span><span id="PTPManager-606"><a href="#PTPManager-606"><span class="linenos">606</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Handles Precision Time Protocol (PTP) configuration and management tasks
within the Syncarium environment.</p>

<h3 id="attributes">Attributes:</h3>

<ul>
<li><strong>vt</strong> (<code>utils.ViewTools</code>): Utility class for rendering formatted views in the console.</li>
<li><strong>config_dir</strong> (<code>Path</code>): Path to the directory containing general configuration files.</li>
<li><strong>ptp4l_config_dir</strong> (<code>Path</code>): Path to the directory containing ptp4l-specific configuration files.</li>
<li><strong>log_dir</strong> (<code>Path</code>): Path to the directory where log files are stored.</li>
<li><strong>print_lock</strong> (<code>Lock</code>): Thread lock used to synchronize console output across threads.</li>
<li><strong>loaded_clients</strong> (<code>Dict[str, Dict[str, str]]</code>): Dictionary containing loaded PTP client configurations.</li>
</ul>
</div>


                            <div id="PTPManager.__init__" class="classattr">
                                        <input id="PTPManager.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">PTPManager</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vt</span><span class="p">:</span> <span class="n"><a href="../utils/viewtools.html#ViewTools">syncarium.tui.utils.viewtools.ViewTools</a></span></span>)</span>

                <label class="view-source-button" for="PTPManager.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PTPManager.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PTPManager.__init__-59"><a href="#PTPManager.__init__-59"><span class="linenos">59</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager.__init__-60"><a href="#PTPManager.__init__-60"><span class="linenos">60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager.__init__-61"><a href="#PTPManager.__init__-61"><span class="linenos">61</span></a><span class="sd">        Initializes the PTPManager instance with required configuration paths and utilities.</span>
</span><span id="PTPManager.__init__-62"><a href="#PTPManager.__init__-62"><span class="linenos">62</span></a>
</span><span id="PTPManager.__init__-63"><a href="#PTPManager.__init__-63"><span class="linenos">63</span></a><span class="sd">        ### Args:</span>
</span><span id="PTPManager.__init__-64"><a href="#PTPManager.__init__-64"><span class="linenos">64</span></a><span class="sd">        - **vt** (`utils.ViewTools`): Instance of the view rendering utility used for console output.</span>
</span><span id="PTPManager.__init__-65"><a href="#PTPManager.__init__-65"><span class="linenos">65</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager.__init__-66"><a href="#PTPManager.__init__-66"><span class="linenos">66</span></a>
</span><span id="PTPManager.__init__-67"><a href="#PTPManager.__init__-67"><span class="linenos">67</span></a>        <span class="c1"># Store view tools instance</span>
</span><span id="PTPManager.__init__-68"><a href="#PTPManager.__init__-68"><span class="linenos">68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span> <span class="o">=</span> <span class="n">vt</span>
</span><span id="PTPManager.__init__-69"><a href="#PTPManager.__init__-69"><span class="linenos">69</span></a>
</span><span id="PTPManager.__init__-70"><a href="#PTPManager.__init__-70"><span class="linenos">70</span></a>        <span class="c1"># Define configuration and logging directories</span>
</span><span id="PTPManager.__init__-71"><a href="#PTPManager.__init__-71"><span class="linenos">71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;suite&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span>
</span><span id="PTPManager.__init__-72"><a href="#PTPManager.__init__-72"><span class="linenos">72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">ptp4l_config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;suite&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span> <span class="o">/</span> <span class="s2">&quot;ptp4l_config&quot;</span>
</span><span id="PTPManager.__init__-73"><a href="#PTPManager.__init__-73"><span class="linenos">73</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;logs&quot;</span><span class="p">)</span>
</span><span id="PTPManager.__init__-74"><a href="#PTPManager.__init__-74"><span class="linenos">74</span></a>
</span><span id="PTPManager.__init__-75"><a href="#PTPManager.__init__-75"><span class="linenos">75</span></a>
</span><span id="PTPManager.__init__-76"><a href="#PTPManager.__init__-76"><span class="linenos">76</span></a>        <span class="c1"># Lock for thread-safe console output</span>
</span><span id="PTPManager.__init__-77"><a href="#PTPManager.__init__-77"><span class="linenos">77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span> <span class="n">Lock</span> <span class="o">=</span> <span class="n">Lock</span><span class="p">()</span>
</span><span id="PTPManager.__init__-78"><a href="#PTPManager.__init__-78"><span class="linenos">78</span></a>
</span><span id="PTPManager.__init__-79"><a href="#PTPManager.__init__-79"><span class="linenos">79</span></a>        <span class="c1"># Dictionary to store loaded PTP client configurations</span>
</span><span id="PTPManager.__init__-80"><a href="#PTPManager.__init__-80"><span class="linenos">80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
</span></pre></div>


            <div class="docstring"><p>Initializes the PTPManager instance with required configuration paths and utilities.</p>

<h3 id="args">Args:</h3>

<ul>
<li><strong>vt</strong> (<code>utils.ViewTools</code>): Instance of the view rendering utility used for console output.</li>
</ul>
</div>


                            </div>
                            <div id="PTPManager.vt" class="classattr">
                                <div class="attr variable">
            <span class="name">vt</span><span class="annotation">: <a href="../utils/viewtools.html#ViewTools">syncarium.tui.utils.viewtools.ViewTools</a></span>

        
    </div>
    <a class="headerlink" href="#PTPManager.vt"></a>
    
    

                            </div>
                            <div id="PTPManager.config_dir" class="classattr">
                                <div class="attr variable">
            <span class="name">config_dir</span><span class="annotation">: pathlib.Path</span>

        
    </div>
    <a class="headerlink" href="#PTPManager.config_dir"></a>
    
    

                            </div>
                            <div id="PTPManager.ptp4l_config_dir" class="classattr">
                                <div class="attr variable">
            <span class="name">ptp4l_config_dir</span><span class="annotation">: pathlib.Path</span>

        
    </div>
    <a class="headerlink" href="#PTPManager.ptp4l_config_dir"></a>
    
    

                            </div>
                            <div id="PTPManager.log_dir" class="classattr">
                                <div class="attr variable">
            <span class="name">log_dir</span><span class="annotation">: pathlib.Path</span>

        
    </div>
    <a class="headerlink" href="#PTPManager.log_dir"></a>
    
    

                            </div>
                            <div id="PTPManager.print_lock" class="classattr">
                                <div class="attr variable">
            <span class="name">print_lock</span><span class="annotation">: &lt;built-in function allocate_lock&gt;</span>

        
    </div>
    <a class="headerlink" href="#PTPManager.print_lock"></a>
    
    

                            </div>
                            <div id="PTPManager.loaded_clients" class="classattr">
                                <div class="attr variable">
            <span class="name">loaded_clients</span><span class="annotation">: Dict[str, Dict[str, str]]</span>

        
    </div>
    <a class="headerlink" href="#PTPManager.loaded_clients"></a>
    
    

                            </div>
                            <div id="PTPManager.main_menu" class="classattr">
                                        <input id="PTPManager.main_menu-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">main_menu</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PTPManager.main_menu-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PTPManager.main_menu"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PTPManager.main_menu-86"><a href="#PTPManager.main_menu-86"><span class="linenos"> 86</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">main_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager.main_menu-87"><a href="#PTPManager.main_menu-87"><span class="linenos"> 87</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager.main_menu-88"><a href="#PTPManager.main_menu-88"><span class="linenos"> 88</span></a><span class="sd">        Displays and manages the interactive terminal-based menu for PTP operations.</span>
</span><span id="PTPManager.main_menu-89"><a href="#PTPManager.main_menu-89"><span class="linenos"> 89</span></a>
</span><span id="PTPManager.main_menu-90"><a href="#PTPManager.main_menu-90"><span class="linenos"> 90</span></a><span class="sd">        Continuously renders a menu using InquirerPy, allowing the user to perform various</span>
</span><span id="PTPManager.main_menu-91"><a href="#PTPManager.main_menu-91"><span class="linenos"> 91</span></a><span class="sd">        PTP-related actions such as starting/stopping services, viewing logs, pinging the server,</span>
</span><span id="PTPManager.main_menu-92"><a href="#PTPManager.main_menu-92"><span class="linenos"> 92</span></a><span class="sd">        and refreshing the interface. The loop continues until the user selects **&quot;❌ Exit&quot;**</span>
</span><span id="PTPManager.main_menu-93"><a href="#PTPManager.main_menu-93"><span class="linenos"> 93</span></a><span class="sd">        or interrupts the process using **Ctrl+C**.</span>
</span><span id="PTPManager.main_menu-94"><a href="#PTPManager.main_menu-94"><span class="linenos"> 94</span></a>
</span><span id="PTPManager.main_menu-95"><a href="#PTPManager.main_menu-95"><span class="linenos"> 95</span></a><span class="sd">        ### Menu Options:</span>
</span><span id="PTPManager.main_menu-96"><a href="#PTPManager.main_menu-96"><span class="linenos"> 96</span></a><span class="sd">        - ⏱️ Start PTP → `start_ptp`</span>
</span><span id="PTPManager.main_menu-97"><a href="#PTPManager.main_menu-97"><span class="linenos"> 97</span></a><span class="sd">        - 🛑 Stop PTP → `stop_ptp`</span>
</span><span id="PTPManager.main_menu-98"><a href="#PTPManager.main_menu-98"><span class="linenos"> 98</span></a><span class="sd">        - 📄 Show PTP Logs → `print_ptp_log`</span>
</span><span id="PTPManager.main_menu-99"><a href="#PTPManager.main_menu-99"><span class="linenos"> 99</span></a><span class="sd">        - 📡 Ping PTP Server → `ping_server`</span>
</span><span id="PTPManager.main_menu-100"><a href="#PTPManager.main_menu-100"><span class="linenos">100</span></a><span class="sd">        - 🔄 Refresh View → refreshes the interface without performing any action</span>
</span><span id="PTPManager.main_menu-101"><a href="#PTPManager.main_menu-101"><span class="linenos">101</span></a><span class="sd">        - ❌ Exit → exits the menu loop</span>
</span><span id="PTPManager.main_menu-102"><a href="#PTPManager.main_menu-102"><span class="linenos">102</span></a>
</span><span id="PTPManager.main_menu-103"><a href="#PTPManager.main_menu-103"><span class="linenos">103</span></a><span class="sd">        ### Notes:</span>
</span><span id="PTPManager.main_menu-104"><a href="#PTPManager.main_menu-104"><span class="linenos">104</span></a><span class="sd">        - Graceful exit is supported via **Ctrl+C** interruption.</span>
</span><span id="PTPManager.main_menu-105"><a href="#PTPManager.main_menu-105"><span class="linenos">105</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager.main_menu-106"><a href="#PTPManager.main_menu-106"><span class="linenos">106</span></a>
</span><span id="PTPManager.main_menu-107"><a href="#PTPManager.main_menu-107"><span class="linenos">107</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.main_menu-108"><a href="#PTPManager.main_menu-108"><span class="linenos">108</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="PTPManager.main_menu-109"><a href="#PTPManager.main_menu-109"><span class="linenos">109</span></a>                <span class="c1"># Display the software title</span>
</span><span id="PTPManager.main_menu-110"><a href="#PTPManager.main_menu-110"><span class="linenos">110</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_software_title</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="PTPManager.main_menu-111"><a href="#PTPManager.main_menu-111"><span class="linenos">111</span></a>
</span><span id="PTPManager.main_menu-112"><a href="#PTPManager.main_menu-112"><span class="linenos">112</span></a>                <span class="c1"># Show the main menu header</span>
</span><span id="PTPManager.main_menu-113"><a href="#PTPManager.main_menu-113"><span class="linenos">113</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;main_title&quot;</span><span class="p">,</span> <span class="s2">&quot;PTP Management Menu&quot;</span><span class="p">,</span> <span class="s2">&quot;⏱️&quot;</span><span class="p">)</span>
</span><span id="PTPManager.main_menu-114"><a href="#PTPManager.main_menu-114"><span class="linenos">114</span></a>
</span><span id="PTPManager.main_menu-115"><a href="#PTPManager.main_menu-115"><span class="linenos">115</span></a>                <span class="c1"># Render a table of active PTP processes</span>
</span><span id="PTPManager.main_menu-116"><a href="#PTPManager.main_menu-116"><span class="linenos">116</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_ptp_processes</span><span class="p">()</span>
</span><span id="PTPManager.main_menu-117"><a href="#PTPManager.main_menu-117"><span class="linenos">117</span></a>
</span><span id="PTPManager.main_menu-118"><a href="#PTPManager.main_menu-118"><span class="linenos">118</span></a>                <span class="c1"># Prompt user with interactive menu</span>
</span><span id="PTPManager.main_menu-119"><a href="#PTPManager.main_menu-119"><span class="linenos">119</span></a>                <span class="n">choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="PTPManager.main_menu-120"><a href="#PTPManager.main_menu-120"><span class="linenos">120</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="p">[</span>
</span><span id="PTPManager.main_menu-121"><a href="#PTPManager.main_menu-121"><span class="linenos">121</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;⏱️ Start PTP&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;start_ptp&quot;</span><span class="p">},</span>
</span><span id="PTPManager.main_menu-122"><a href="#PTPManager.main_menu-122"><span class="linenos">122</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🛑 Stop PTP&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;stop_ptp&quot;</span><span class="p">},</span>
</span><span id="PTPManager.main_menu-123"><a href="#PTPManager.main_menu-123"><span class="linenos">123</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📄 Show PTP Logs&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;print_ptp_log&quot;</span><span class="p">},</span>
</span><span id="PTPManager.main_menu-124"><a href="#PTPManager.main_menu-124"><span class="linenos">124</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📡 Ping PTP Server&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;ping_server&quot;</span><span class="p">},</span>
</span><span id="PTPManager.main_menu-125"><a href="#PTPManager.main_menu-125"><span class="linenos">125</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🔄 Refresh view&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">},</span>
</span><span id="PTPManager.main_menu-126"><a href="#PTPManager.main_menu-126"><span class="linenos">126</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;❌ Exit&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;exit&quot;</span><span class="p">},</span>
</span><span id="PTPManager.main_menu-127"><a href="#PTPManager.main_menu-127"><span class="linenos">127</span></a>                    <span class="p">],</span>
</span><span id="PTPManager.main_menu-128"><a href="#PTPManager.main_menu-128"><span class="linenos">128</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PTPManager.main_menu-129"><a href="#PTPManager.main_menu-129"><span class="linenos">129</span></a>                <span class="p">)</span>
</span><span id="PTPManager.main_menu-130"><a href="#PTPManager.main_menu-130"><span class="linenos">130</span></a>
</span><span id="PTPManager.main_menu-131"><a href="#PTPManager.main_menu-131"><span class="linenos">131</span></a>                <span class="c1"># Map menu options to corresponding methods</span>
</span><span id="PTPManager.main_menu-132"><a href="#PTPManager.main_menu-132"><span class="linenos">132</span></a>                <span class="n">submenu</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PTPManager.main_menu-133"><a href="#PTPManager.main_menu-133"><span class="linenos">133</span></a>                    <span class="s2">&quot;start_ptp&quot;</span><span class="p">:</span>        <span class="bp">self</span><span class="o">.</span><span class="n">start_ptp</span><span class="p">,</span>
</span><span id="PTPManager.main_menu-134"><a href="#PTPManager.main_menu-134"><span class="linenos">134</span></a>                    <span class="s2">&quot;stop_ptp&quot;</span><span class="p">:</span>         <span class="bp">self</span><span class="o">.</span><span class="n">stop_ptp</span><span class="p">,</span>
</span><span id="PTPManager.main_menu-135"><a href="#PTPManager.main_menu-135"><span class="linenos">135</span></a>                    <span class="s2">&quot;print_ptp_log&quot;</span><span class="p">:</span>    <span class="bp">self</span><span class="o">.</span><span class="n">print_ptp_log</span><span class="p">,</span>
</span><span id="PTPManager.main_menu-136"><a href="#PTPManager.main_menu-136"><span class="linenos">136</span></a>                    <span class="s2">&quot;ping_server&quot;</span><span class="p">:</span>      <span class="bp">self</span><span class="o">.</span><span class="n">ping_server</span><span class="p">,</span>
</span><span id="PTPManager.main_menu-137"><a href="#PTPManager.main_menu-137"><span class="linenos">137</span></a>                <span class="p">}</span>
</span><span id="PTPManager.main_menu-138"><a href="#PTPManager.main_menu-138"><span class="linenos">138</span></a>
</span><span id="PTPManager.main_menu-139"><a href="#PTPManager.main_menu-139"><span class="linenos">139</span></a>                <span class="c1"># Handle user selection</span>
</span><span id="PTPManager.main_menu-140"><a href="#PTPManager.main_menu-140"><span class="linenos">140</span></a>                <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;exit&quot;</span><span class="p">:</span>
</span><span id="PTPManager.main_menu-141"><a href="#PTPManager.main_menu-141"><span class="linenos">141</span></a>                    <span class="k">break</span>
</span><span id="PTPManager.main_menu-142"><a href="#PTPManager.main_menu-142"><span class="linenos">142</span></a>                <span class="k">elif</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">:</span>
</span><span id="PTPManager.main_menu-143"><a href="#PTPManager.main_menu-143"><span class="linenos">143</span></a>                    <span class="n">action</span> <span class="o">=</span> <span class="n">submenu</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
</span><span id="PTPManager.main_menu-144"><a href="#PTPManager.main_menu-144"><span class="linenos">144</span></a>                    <span class="k">if</span> <span class="n">action</span><span class="p">:</span>
</span><span id="PTPManager.main_menu-145"><a href="#PTPManager.main_menu-145"><span class="linenos">145</span></a>                        <span class="n">action</span><span class="p">()</span>
</span><span id="PTPManager.main_menu-146"><a href="#PTPManager.main_menu-146"><span class="linenos">146</span></a>                        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🔙 Press ⏎ to return to the menu...&quot;</span><span class="p">)</span>
</span><span id="PTPManager.main_menu-147"><a href="#PTPManager.main_menu-147"><span class="linenos">147</span></a>
</span><span id="PTPManager.main_menu-148"><a href="#PTPManager.main_menu-148"><span class="linenos">148</span></a>        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="PTPManager.main_menu-149"><a href="#PTPManager.main_menu-149"><span class="linenos">149</span></a>            <span class="c1"># Gracefully handle Ctrl+C interruption</span>
</span><span id="PTPManager.main_menu-150"><a href="#PTPManager.main_menu-150"><span class="linenos">150</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;Exiting...&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Displays and manages the interactive terminal-based menu for PTP operations.</p>

<p>Continuously renders a menu using InquirerPy, allowing the user to perform various
PTP-related actions such as starting/stopping services, viewing logs, pinging the server,
and refreshing the interface. The loop continues until the user selects <strong>"❌ Exit"</strong>
or interrupts the process using <strong>Ctrl+C</strong>.</p>

<h3 id="menu-options">Menu Options:</h3>

<ul>
<li>⏱️ Start PTP → <code><a href="#PTPManager.start_ptp">start_ptp</a></code></li>
<li>🛑 Stop PTP → <code><a href="#PTPManager.stop_ptp">stop_ptp</a></code></li>
<li>📄 Show PTP Logs → <code><a href="#PTPManager.print_ptp_log">print_ptp_log</a></code></li>
<li>📡 Ping PTP Server → <code><a href="#PTPManager.ping_server">ping_server</a></code></li>
<li>🔄 Refresh View → refreshes the interface without performing any action</li>
<li>❌ Exit → exits the menu loop</li>
</ul>

<h3 id="notes">Notes:</h3>

<ul>
<li>Graceful exit is supported via <strong>Ctrl+C</strong> interruption.</li>
</ul>
</div>


                            </div>
                            <div id="PTPManager.load_clients" class="classattr">
                                        <input id="PTPManager.load_clients-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_clients</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">file_cfg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="PTPManager.load_clients-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PTPManager.load_clients"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PTPManager.load_clients-156"><a href="#PTPManager.load_clients-156"><span class="linenos">156</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_clients</span><span class="p">(</span>
</span><span id="PTPManager.load_clients-157"><a href="#PTPManager.load_clients-157"><span class="linenos">157</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-158"><a href="#PTPManager.load_clients-158"><span class="linenos">158</span></a>        <span class="n">file_cfg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-159"><a href="#PTPManager.load_clients-159"><span class="linenos">159</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-160"><a href="#PTPManager.load_clients-160"><span class="linenos">160</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-161"><a href="#PTPManager.load_clients-161"><span class="linenos">161</span></a>        <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PTPManager.load_clients-162"><a href="#PTPManager.load_clients-162"><span class="linenos">162</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-163"><a href="#PTPManager.load_clients-163"><span class="linenos">163</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager.load_clients-164"><a href="#PTPManager.load_clients-164"><span class="linenos">164</span></a><span class="sd">        Loads and validates PTP client configurations from a YAML file.</span>
</span><span id="PTPManager.load_clients-165"><a href="#PTPManager.load_clients-165"><span class="linenos">165</span></a>
</span><span id="PTPManager.load_clients-166"><a href="#PTPManager.load_clients-166"><span class="linenos">166</span></a><span class="sd">        If no file is specified, the user is prompted to select one interactively from the available</span>
</span><span id="PTPManager.load_clients-167"><a href="#PTPManager.load_clients-167"><span class="linenos">167</span></a><span class="sd">        YAML files in the configuration directory. Each client&#39;s network namespace is validated</span>
</span><span id="PTPManager.load_clients-168"><a href="#PTPManager.load_clients-168"><span class="linenos">168</span></a><span class="sd">        against the system. Clients with missing namespaces are skipped and reported.</span>
</span><span id="PTPManager.load_clients-169"><a href="#PTPManager.load_clients-169"><span class="linenos">169</span></a>
</span><span id="PTPManager.load_clients-170"><a href="#PTPManager.load_clients-170"><span class="linenos">170</span></a><span class="sd">        The YAML file must contain a `ptp_clients` section with client definitions.</span>
</span><span id="PTPManager.load_clients-171"><a href="#PTPManager.load_clients-171"><span class="linenos">171</span></a>
</span><span id="PTPManager.load_clients-172"><a href="#PTPManager.load_clients-172"><span class="linenos">172</span></a><span class="sd">        ### Args:</span>
</span><span id="PTPManager.load_clients-173"><a href="#PTPManager.load_clients-173"><span class="linenos">173</span></a><span class="sd">        - **file_cfg** (`Optional[str]`): Name of the YAML configuration file to load. If `None`, prompts the user interactively.</span>
</span><span id="PTPManager.load_clients-174"><a href="#PTPManager.load_clients-174"><span class="linenos">174</span></a><span class="sd">        - **logger** (`Optional[Any]`): Logger instance used for logging messages. Defaults to `None`.</span>
</span><span id="PTPManager.load_clients-175"><a href="#PTPManager.load_clients-175"><span class="linenos">175</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages. Defaults to `0`.</span>
</span><span id="PTPManager.load_clients-176"><a href="#PTPManager.load_clients-176"><span class="linenos">176</span></a><span class="sd">        - **quiet** (`bool`): If `True`, suppresses console output. Defaults to `True`.</span>
</span><span id="PTPManager.load_clients-177"><a href="#PTPManager.load_clients-177"><span class="linenos">177</span></a>
</span><span id="PTPManager.load_clients-178"><a href="#PTPManager.load_clients-178"><span class="linenos">178</span></a><span class="sd">        ### Returns:</span>
</span><span id="PTPManager.load_clients-179"><a href="#PTPManager.load_clients-179"><span class="linenos">179</span></a><span class="sd">        - `bool`: `True` if clients were successfully loaded and validated; `False` otherwise.</span>
</span><span id="PTPManager.load_clients-180"><a href="#PTPManager.load_clients-180"><span class="linenos">180</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager.load_clients-181"><a href="#PTPManager.load_clients-181"><span class="linenos">181</span></a>
</span><span id="PTPManager.load_clients-182"><a href="#PTPManager.load_clients-182"><span class="linenos">182</span></a>        <span class="c1"># Show section title</span>
</span><span id="PTPManager.load_clients-183"><a href="#PTPManager.load_clients-183"><span class="linenos">183</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Loading PTP Clients&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager.load_clients-184"><a href="#PTPManager.load_clients-184"><span class="linenos">184</span></a>
</span><span id="PTPManager.load_clients-185"><a href="#PTPManager.load_clients-185"><span class="linenos">185</span></a>        <span class="c1"># If no file is provided, prompt user to select one</span>
</span><span id="PTPManager.load_clients-186"><a href="#PTPManager.load_clients-186"><span class="linenos">186</span></a>        <span class="k">if</span> <span class="n">file_cfg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>            
</span><span id="PTPManager.load_clients-187"><a href="#PTPManager.load_clients-187"><span class="linenos">187</span></a>            <span class="n">files</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PTPManager.load_clients-188"><a href="#PTPManager.load_clients-188"><span class="linenos">188</span></a>                <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">relative_to</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">))</span>
</span><span id="PTPManager.load_clients-189"><a href="#PTPManager.load_clients-189"><span class="linenos">189</span></a>                <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="o">.</span><span class="n">rglob</span><span class="p">(</span><span class="s2">&quot;*.yaml&quot;</span><span class="p">)</span>
</span><span id="PTPManager.load_clients-190"><a href="#PTPManager.load_clients-190"><span class="linenos">190</span></a>                <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()</span>
</span><span id="PTPManager.load_clients-191"><a href="#PTPManager.load_clients-191"><span class="linenos">191</span></a>            <span class="p">]</span>
</span><span id="PTPManager.load_clients-192"><a href="#PTPManager.load_clients-192"><span class="linenos">192</span></a>            
</span><span id="PTPManager.load_clients-193"><a href="#PTPManager.load_clients-193"><span class="linenos">193</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">files</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-194"><a href="#PTPManager.load_clients-194"><span class="linenos">194</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="PTPManager.load_clients-195"><a href="#PTPManager.load_clients-195"><span class="linenos">195</span></a>                    <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-196"><a href="#PTPManager.load_clients-196"><span class="linenos">196</span></a>                    <span class="sa">f</span><span class="s2">&quot;No YAML configuration files found in &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-197"><a href="#PTPManager.load_clients-197"><span class="linenos">197</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-198"><a href="#PTPManager.load_clients-198"><span class="linenos">198</span></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="PTPManager.load_clients-199"><a href="#PTPManager.load_clients-199"><span class="linenos">199</span></a>                <span class="p">)</span>
</span><span id="PTPManager.load_clients-200"><a href="#PTPManager.load_clients-200"><span class="linenos">200</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="PTPManager.load_clients-201"><a href="#PTPManager.load_clients-201"><span class="linenos">201</span></a>
</span><span id="PTPManager.load_clients-202"><a href="#PTPManager.load_clients-202"><span class="linenos">202</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-203"><a href="#PTPManager.load_clients-203"><span class="linenos">203</span></a>                <span class="n">choices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PTPManager.load_clients-204"><a href="#PTPManager.load_clients-204"><span class="linenos">204</span></a>                    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. 📄 </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span><span id="PTPManager.load_clients-205"><a href="#PTPManager.load_clients-205"><span class="linenos">205</span></a>                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">files</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager.load_clients-206"><a href="#PTPManager.load_clients-206"><span class="linenos">206</span></a>                <span class="p">]</span>
</span><span id="PTPManager.load_clients-207"><a href="#PTPManager.load_clients-207"><span class="linenos">207</span></a>                <span class="n">selected</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="PTPManager.load_clients-208"><a href="#PTPManager.load_clients-208"><span class="linenos">208</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-209"><a href="#PTPManager.load_clients-209"><span class="linenos">209</span></a>                    <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Available Configuration Files:&quot;</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-210"><a href="#PTPManager.load_clients-210"><span class="linenos">210</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span>
</span><span id="PTPManager.load_clients-211"><a href="#PTPManager.load_clients-211"><span class="linenos">211</span></a>                <span class="p">)</span>
</span><span id="PTPManager.load_clients-212"><a href="#PTPManager.load_clients-212"><span class="linenos">212</span></a>                <span class="n">filepath_cfg</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span> <span class="o">/</span> <span class="n">selected</span>
</span><span id="PTPManager.load_clients-213"><a href="#PTPManager.load_clients-213"><span class="linenos">213</span></a>
</span><span id="PTPManager.load_clients-214"><a href="#PTPManager.load_clients-214"><span class="linenos">214</span></a>            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-215"><a href="#PTPManager.load_clients-215"><span class="linenos">215</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation cancelled by user.&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.load_clients-216"><a href="#PTPManager.load_clients-216"><span class="linenos">216</span></a>                <span class="k">return</span> <span class="kc">False</span>
</span><span id="PTPManager.load_clients-217"><a href="#PTPManager.load_clients-217"><span class="linenos">217</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-218"><a href="#PTPManager.load_clients-218"><span class="linenos">218</span></a>            <span class="n">filepath_cfg</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">file_cfg</span>
</span><span id="PTPManager.load_clients-219"><a href="#PTPManager.load_clients-219"><span class="linenos">219</span></a>
</span><span id="PTPManager.load_clients-220"><a href="#PTPManager.load_clients-220"><span class="linenos">220</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-221"><a href="#PTPManager.load_clients-221"><span class="linenos">221</span></a>            <span class="c1"># Load YAML data</span>
</span><span id="PTPManager.load_clients-222"><a href="#PTPManager.load_clients-222"><span class="linenos">222</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath_cfg</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-223"><a href="#PTPManager.load_clients-223"><span class="linenos">223</span></a>                <span class="n">yaml_data</span><span class="p">:</span> <span class="n">Dict</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</span><span id="PTPManager.load_clients-224"><a href="#PTPManager.load_clients-224"><span class="linenos">224</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="n">yaml_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;ptp_clients&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="PTPManager.load_clients-225"><a href="#PTPManager.load_clients-225"><span class="linenos">225</span></a>
</span><span id="PTPManager.load_clients-226"><a href="#PTPManager.load_clients-226"><span class="linenos">226</span></a>            <span class="c1"># Get currently existing namespaces</span>
</span><span id="PTPManager.load_clients-227"><a href="#PTPManager.load_clients-227"><span class="linenos">227</span></a>            <span class="n">ns_result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;netns&quot;</span><span class="p">,</span> <span class="s2">&quot;list&quot;</span><span class="p">],</span> <span class="n">stdout</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">PIPE</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager.load_clients-228"><a href="#PTPManager.load_clients-228"><span class="linenos">228</span></a>            <span class="n">existing_namespaces</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="PTPManager.load_clients-229"><a href="#PTPManager.load_clients-229"><span class="linenos">229</span></a>                <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">ns_result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="PTPManager.load_clients-230"><a href="#PTPManager.load_clients-230"><span class="linenos">230</span></a>            <span class="p">}</span>
</span><span id="PTPManager.load_clients-231"><a href="#PTPManager.load_clients-231"><span class="linenos">231</span></a>
</span><span id="PTPManager.load_clients-232"><a href="#PTPManager.load_clients-232"><span class="linenos">232</span></a>            <span class="n">skipped</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PTPManager.load_clients-233"><a href="#PTPManager.load_clients-233"><span class="linenos">233</span></a>
</span><span id="PTPManager.load_clients-234"><a href="#PTPManager.load_clients-234"><span class="linenos">234</span></a>            <span class="c1"># Validate each client namespace</span>
</span><span id="PTPManager.load_clients-235"><a href="#PTPManager.load_clients-235"><span class="linenos">235</span></a>            <span class="k">for</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">client_data</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
</span><span id="PTPManager.load_clients-236"><a href="#PTPManager.load_clients-236"><span class="linenos">236</span></a>                <span class="n">ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">client_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;namespace&quot;</span><span class="p">)</span>
</span><span id="PTPManager.load_clients-237"><a href="#PTPManager.load_clients-237"><span class="linenos">237</span></a>                <span class="k">if</span> <span class="n">ns</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">existing_namespaces</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-238"><a href="#PTPManager.load_clients-238"><span class="linenos">238</span></a>                    <span class="n">skipped</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">client_name</span><span class="p">,</span> <span class="n">ns</span><span class="p">))</span>
</span><span id="PTPManager.load_clients-239"><a href="#PTPManager.load_clients-239"><span class="linenos">239</span></a>                    <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">[</span><span class="n">client_name</span><span class="p">]</span>
</span><span id="PTPManager.load_clients-240"><a href="#PTPManager.load_clients-240"><span class="linenos">240</span></a>
</span><span id="PTPManager.load_clients-241"><a href="#PTPManager.load_clients-241"><span class="linenos">241</span></a>            <span class="c1"># Report missing namespaces</span>
</span><span id="PTPManager.load_clients-242"><a href="#PTPManager.load_clients-242"><span class="linenos">242</span></a>            <span class="k">if</span> <span class="n">skipped</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-243"><a href="#PTPManager.load_clients-243"><span class="linenos">243</span></a>                <span class="n">missing</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;⛔ </span><span class="si">{</span><span class="n">iface</span><span class="si">}</span><span class="s2"> → Namespace &#39;</span><span class="si">{</span><span class="n">ns</span><span class="si">}</span><span class="s2">&#39; not found&quot;</span> <span class="k">for</span> <span class="n">iface</span><span class="p">,</span> <span class="n">ns</span> <span class="ow">in</span> <span class="n">skipped</span><span class="p">)</span>
</span><span id="PTPManager.load_clients-244"><a href="#PTPManager.load_clients-244"><span class="linenos">244</span></a>                <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;❌ One or more namespaces are missing:</span><span class="se">\n</span><span class="si">{</span><span class="n">missing</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PTPManager.load_clients-245"><a href="#PTPManager.load_clients-245"><span class="linenos">245</span></a>
</span><span id="PTPManager.load_clients-246"><a href="#PTPManager.load_clients-246"><span class="linenos">246</span></a>            <span class="c1"># Confirm successful loading</span>
</span><span id="PTPManager.load_clients-247"><a href="#PTPManager.load_clients-247"><span class="linenos">247</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="PTPManager.load_clients-248"><a href="#PTPManager.load_clients-248"><span class="linenos">248</span></a>                <span class="s2">&quot;success&quot;</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-249"><a href="#PTPManager.load_clients-249"><span class="linenos">249</span></a>                <span class="sa">f</span><span class="s2">&quot;Clients successfully loaded from </span><span class="si">{</span><span class="n">filepath_cfg</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-250"><a href="#PTPManager.load_clients-250"><span class="linenos">250</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-251"><a href="#PTPManager.load_clients-251"><span class="linenos">251</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="PTPManager.load_clients-252"><a href="#PTPManager.load_clients-252"><span class="linenos">252</span></a>            <span class="p">)</span>
</span><span id="PTPManager.load_clients-253"><a href="#PTPManager.load_clients-253"><span class="linenos">253</span></a>
</span><span id="PTPManager.load_clients-254"><a href="#PTPManager.load_clients-254"><span class="linenos">254</span></a>            <span class="c1"># Display loaded clients</span>
</span><span id="PTPManager.load_clients-255"><a href="#PTPManager.load_clients-255"><span class="linenos">255</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-256"><a href="#PTPManager.load_clients-256"><span class="linenos">256</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Loaded PTP Clients:&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.load_clients-257"><a href="#PTPManager.load_clients-257"><span class="linenos">257</span></a>                <span class="k">for</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="PTPManager.load_clients-258"><a href="#PTPManager.load_clients-258"><span class="linenos">258</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="PTPManager.load_clients-259"><a href="#PTPManager.load_clients-259"><span class="linenos">259</span></a>                        <span class="s2">&quot;info&quot;</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-260"><a href="#PTPManager.load_clients-260"><span class="linenos">260</span></a>                        <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2"> → Namespace: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;namespace&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> / Interface: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;interface&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> / Config: </span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;config&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-261"><a href="#PTPManager.load_clients-261"><span class="linenos">261</span></a>                        <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-262"><a href="#PTPManager.load_clients-262"><span class="linenos">262</span></a>                        <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="PTPManager.load_clients-263"><a href="#PTPManager.load_clients-263"><span class="linenos">263</span></a>                    <span class="p">)</span>
</span><span id="PTPManager.load_clients-264"><a href="#PTPManager.load_clients-264"><span class="linenos">264</span></a>
</span><span id="PTPManager.load_clients-265"><a href="#PTPManager.load_clients-265"><span class="linenos">265</span></a>            <span class="k">return</span> <span class="kc">True</span>
</span><span id="PTPManager.load_clients-266"><a href="#PTPManager.load_clients-266"><span class="linenos">266</span></a>
</span><span id="PTPManager.load_clients-267"><a href="#PTPManager.load_clients-267"><span class="linenos">267</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager.load_clients-268"><a href="#PTPManager.load_clients-268"><span class="linenos">268</span></a>            <span class="c1"># Handle YAML or validation errors</span>
</span><span id="PTPManager.load_clients-269"><a href="#PTPManager.load_clients-269"><span class="linenos">269</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="PTPManager.load_clients-270"><a href="#PTPManager.load_clients-270"><span class="linenos">270</span></a>                <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-271"><a href="#PTPManager.load_clients-271"><span class="linenos">271</span></a>                <span class="sa">f</span><span class="s2">&quot;Error loading YAML file: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-272"><a href="#PTPManager.load_clients-272"><span class="linenos">272</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="PTPManager.load_clients-273"><a href="#PTPManager.load_clients-273"><span class="linenos">273</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="PTPManager.load_clients-274"><a href="#PTPManager.load_clients-274"><span class="linenos">274</span></a>            <span class="p">)</span>
</span><span id="PTPManager.load_clients-275"><a href="#PTPManager.load_clients-275"><span class="linenos">275</span></a>            <span class="k">return</span> <span class="kc">False</span>
</span></pre></div>


            <div class="docstring"><p>Loads and validates PTP client configurations from a YAML file.</p>

<p>If no file is specified, the user is prompted to select one interactively from the available
YAML files in the configuration directory. Each client's network namespace is validated
against the system. Clients with missing namespaces are skipped and reported.</p>

<p>The YAML file must contain a <code>ptp_clients</code> section with client definitions.</p>

<h3 id="args">Args:</h3>

<ul>
<li><strong>file_cfg</strong> (<code>Optional[str]</code>): Name of the YAML configuration file to load. If <code>None</code>, prompts the user interactively.</li>
<li><strong>logger</strong> (<code>Optional[Any]</code>): Logger instance used for logging messages. Defaults to <code>None</code>.</li>
<li><strong>extra_indent</strong> (<code>int</code>): Additional indentation level for console messages. Defaults to <code>0</code>.</li>
<li><strong>quiet</strong> (<code>bool</code>): If <code>True</code>, suppresses console output. Defaults to <code>True</code>.</li>
</ul>

<h3 id="returns">Returns:</h3>

<ul>
<li><code>bool</code>: <code>True</code> if clients were successfully loaded and validated; <code>False</code> otherwise.</li>
</ul>
</div>


                            </div>
                            <div id="PTPManager.start_ptp" class="classattr">
                                        <input id="PTPManager.start_ptp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">start_ptp</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">stop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PTPManager.start_ptp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PTPManager.start_ptp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PTPManager.start_ptp-280"><a href="#PTPManager.start_ptp-280"><span class="linenos">280</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">start_ptp</span><span class="p">(</span>
</span><span id="PTPManager.start_ptp-281"><a href="#PTPManager.start_ptp-281"><span class="linenos">281</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PTPManager.start_ptp-282"><a href="#PTPManager.start_ptp-282"><span class="linenos">282</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PTPManager.start_ptp-283"><a href="#PTPManager.start_ptp-283"><span class="linenos">283</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="PTPManager.start_ptp-284"><a href="#PTPManager.start_ptp-284"><span class="linenos">284</span></a>        <span class="n">stop</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PTPManager.start_ptp-285"><a href="#PTPManager.start_ptp-285"><span class="linenos">285</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-286"><a href="#PTPManager.start_ptp-286"><span class="linenos">286</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager.start_ptp-287"><a href="#PTPManager.start_ptp-287"><span class="linenos">287</span></a><span class="sd">        Launches `ptp4l` processes for all configured clients.</span>
</span><span id="PTPManager.start_ptp-288"><a href="#PTPManager.start_ptp-288"><span class="linenos">288</span></a>
</span><span id="PTPManager.start_ptp-289"><a href="#PTPManager.start_ptp-289"><span class="linenos">289</span></a><span class="sd">        If enabled, checks for existing `ptp4l` processes and prompts the user to stop them before starting new ones.</span>
</span><span id="PTPManager.start_ptp-290"><a href="#PTPManager.start_ptp-290"><span class="linenos">290</span></a><span class="sd">        If no clients are currently loaded, attempts to load them from configuration files.</span>
</span><span id="PTPManager.start_ptp-291"><a href="#PTPManager.start_ptp-291"><span class="linenos">291</span></a>
</span><span id="PTPManager.start_ptp-292"><a href="#PTPManager.start_ptp-292"><span class="linenos">292</span></a><span class="sd">        For each valid client, starts a `ptp4l` process within its corresponding network namespace using `sudo`,</span>
</span><span id="PTPManager.start_ptp-293"><a href="#PTPManager.start_ptp-293"><span class="linenos">293</span></a><span class="sd">        with output redirected to a dedicated log file. Displays process information including PID, log path, and command.</span>
</span><span id="PTPManager.start_ptp-294"><a href="#PTPManager.start_ptp-294"><span class="linenos">294</span></a>
</span><span id="PTPManager.start_ptp-295"><a href="#PTPManager.start_ptp-295"><span class="linenos">295</span></a><span class="sd">        ### Args</span>
</span><span id="PTPManager.start_ptp-296"><a href="#PTPManager.start_ptp-296"><span class="linenos">296</span></a><span class="sd">        - **logger** (`Optional[Any]`): Logger instance for logging messages. Defaults to `None`.</span>
</span><span id="PTPManager.start_ptp-297"><a href="#PTPManager.start_ptp-297"><span class="linenos">297</span></a><span class="sd">        - **extra_indent** (`int`): Indentation level for console messages. Defaults to `0`.</span>
</span><span id="PTPManager.start_ptp-298"><a href="#PTPManager.start_ptp-298"><span class="linenos">298</span></a><span class="sd">        - **stop** (`bool`): Whether to stop existing `ptp4l` processes before launching new ones. Defaults to `True`.</span>
</span><span id="PTPManager.start_ptp-299"><a href="#PTPManager.start_ptp-299"><span class="linenos">299</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager.start_ptp-300"><a href="#PTPManager.start_ptp-300"><span class="linenos">300</span></a>
</span><span id="PTPManager.start_ptp-301"><a href="#PTPManager.start_ptp-301"><span class="linenos">301</span></a>        <span class="c1"># Stop and clean actual clients if enabled</span>
</span><span id="PTPManager.start_ptp-302"><a href="#PTPManager.start_ptp-302"><span class="linenos">302</span></a>        <span class="k">if</span> <span class="n">stop</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-303"><a href="#PTPManager.start_ptp-303"><span class="linenos">303</span></a>
</span><span id="PTPManager.start_ptp-304"><a href="#PTPManager.start_ptp-304"><span class="linenos">304</span></a>            <span class="c1"># Check for existing ptp4l processes</span>
</span><span id="PTPManager.start_ptp-305"><a href="#PTPManager.start_ptp-305"><span class="linenos">305</span></a>            <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-306"><a href="#PTPManager.start_ptp-306"><span class="linenos">306</span></a>            <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="PTPManager.start_ptp-307"><a href="#PTPManager.start_ptp-307"><span class="linenos">307</span></a>
</span><span id="PTPManager.start_ptp-308"><a href="#PTPManager.start_ptp-308"><span class="linenos">308</span></a>            <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-309"><a href="#PTPManager.start_ptp-309"><span class="linenos">309</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;There are PTP clients already running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-310"><a href="#PTPManager.start_ptp-310"><span class="linenos">310</span></a>                <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Confirm</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⚠️ Are you sure you want to stop the actual PTP processes?&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-311"><a href="#PTPManager.start_ptp-311"><span class="linenos">311</span></a>                <span class="k">if</span> <span class="n">confirm</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-312"><a href="#PTPManager.start_ptp-312"><span class="linenos">312</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">stop_ptp</span><span class="p">(</span><span class="n">preconfirmation</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">extra_indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-313"><a href="#PTPManager.start_ptp-313"><span class="linenos">313</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-314"><a href="#PTPManager.start_ptp-314"><span class="linenos">314</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Not starting new PTP processes.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-315"><a href="#PTPManager.start_ptp-315"><span class="linenos">315</span></a>                    <span class="k">return</span>
</span><span id="PTPManager.start_ptp-316"><a href="#PTPManager.start_ptp-316"><span class="linenos">316</span></a>
</span><span id="PTPManager.start_ptp-317"><a href="#PTPManager.start_ptp-317"><span class="linenos">317</span></a>        <span class="c1"># Load client configurations if not already loaded</span>
</span><span id="PTPManager.start_ptp-318"><a href="#PTPManager.start_ptp-318"><span class="linenos">318</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-319"><a href="#PTPManager.start_ptp-319"><span class="linenos">319</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_clients</span><span class="p">(</span><span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">extra_indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">):</span>
</span><span id="PTPManager.start_ptp-320"><a href="#PTPManager.start_ptp-320"><span class="linenos">320</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="s2">&quot;Aborting operation due to failed client loading.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-321"><a href="#PTPManager.start_ptp-321"><span class="linenos">321</span></a>                <span class="k">return</span>
</span><span id="PTPManager.start_ptp-322"><a href="#PTPManager.start_ptp-322"><span class="linenos">322</span></a>
</span><span id="PTPManager.start_ptp-323"><a href="#PTPManager.start_ptp-323"><span class="linenos">323</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Starting PTP processes&quot;</span><span class="p">,</span> <span class="n">title_emoji</span><span class="o">=</span><span class="s2">&quot;⏱️&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-324"><a href="#PTPManager.start_ptp-324"><span class="linenos">324</span></a>
</span><span id="PTPManager.start_ptp-325"><a href="#PTPManager.start_ptp-325"><span class="linenos">325</span></a>        <span class="k">for</span> <span class="n">client_name</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="PTPManager.start_ptp-326"><a href="#PTPManager.start_ptp-326"><span class="linenos">326</span></a>            <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ptp4l_config_dir</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span>
</span><span id="PTPManager.start_ptp-327"><a href="#PTPManager.start_ptp-327"><span class="linenos">327</span></a>            <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
</span><span id="PTPManager.start_ptp-328"><a href="#PTPManager.start_ptp-328"><span class="linenos">328</span></a>            <span class="n">log_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;ptp-</span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2">.log&quot;</span>
</span><span id="PTPManager.start_ptp-329"><a href="#PTPManager.start_ptp-329"><span class="linenos">329</span></a>
</span><span id="PTPManager.start_ptp-330"><a href="#PTPManager.start_ptp-330"><span class="linenos">330</span></a>            <span class="c1"># Validate config file existence</span>
</span><span id="PTPManager.start_ptp-331"><a href="#PTPManager.start_ptp-331"><span class="linenos">331</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">config_path</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="PTPManager.start_ptp-332"><a href="#PTPManager.start_ptp-332"><span class="linenos">332</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-333"><a href="#PTPManager.start_ptp-333"><span class="linenos">333</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Configuration file not found: </span><span class="si">{</span><span class="n">config_path</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-334"><a href="#PTPManager.start_ptp-334"><span class="linenos">334</span></a>                <span class="k">continue</span>
</span><span id="PTPManager.start_ptp-335"><a href="#PTPManager.start_ptp-335"><span class="linenos">335</span></a>
</span><span id="PTPManager.start_ptp-336"><a href="#PTPManager.start_ptp-336"><span class="linenos">336</span></a>            <span class="c1"># Ensure log directory exists and reset log file</span>
</span><span id="PTPManager.start_ptp-337"><a href="#PTPManager.start_ptp-337"><span class="linenos">337</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-338"><a href="#PTPManager.start_ptp-338"><span class="linenos">338</span></a>            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-339"><a href="#PTPManager.start_ptp-339"><span class="linenos">339</span></a>                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="si">}</span><span class="s2">] Log reset for </span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-340"><a href="#PTPManager.start_ptp-340"><span class="linenos">340</span></a>
</span><span id="PTPManager.start_ptp-341"><a href="#PTPManager.start_ptp-341"><span class="linenos">341</span></a>            <span class="c1"># Build ptp4l command</span>
</span><span id="PTPManager.start_ptp-342"><a href="#PTPManager.start_ptp-342"><span class="linenos">342</span></a>            <span class="n">command</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PTPManager.start_ptp-343"><a href="#PTPManager.start_ptp-343"><span class="linenos">343</span></a>                <span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;netns&quot;</span><span class="p">,</span> <span class="s2">&quot;exec&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span>
</span><span id="PTPManager.start_ptp-344"><a href="#PTPManager.start_ptp-344"><span class="linenos">344</span></a>                <span class="s2">&quot;ptp4l&quot;</span><span class="p">,</span> <span class="s2">&quot;-f&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">config_path</span><span class="p">),</span> <span class="s2">&quot;-s&quot;</span><span class="p">,</span> <span class="s2">&quot;-q&quot;</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;0&quot;</span>
</span><span id="PTPManager.start_ptp-345"><a href="#PTPManager.start_ptp-345"><span class="linenos">345</span></a>            <span class="p">]</span>
</span><span id="PTPManager.start_ptp-346"><a href="#PTPManager.start_ptp-346"><span class="linenos">346</span></a>
</span><span id="PTPManager.start_ptp-347"><a href="#PTPManager.start_ptp-347"><span class="linenos">347</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-348"><a href="#PTPManager.start_ptp-348"><span class="linenos">348</span></a>                <span class="c1"># Launch ptp4l process with sudo and redirect output to log</span>
</span><span id="PTPManager.start_ptp-349"><a href="#PTPManager.start_ptp-349"><span class="linenos">349</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">log_path</span><span class="p">,</span> <span class="s1">&#39;a&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">log_file</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-350"><a href="#PTPManager.start_ptp-350"><span class="linenos">350</span></a>                    <span class="n">ptp_process</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
</span><span id="PTPManager.start_ptp-351"><a href="#PTPManager.start_ptp-351"><span class="linenos">351</span></a>                        <span class="p">[</span><span class="s2">&quot;sudo&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">command</span><span class="p">,</span>
</span><span id="PTPManager.start_ptp-352"><a href="#PTPManager.start_ptp-352"><span class="linenos">352</span></a>                        <span class="n">stdout</span><span class="o">=</span><span class="n">log_file</span><span class="p">,</span>
</span><span id="PTPManager.start_ptp-353"><a href="#PTPManager.start_ptp-353"><span class="linenos">353</span></a>                        <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span><span class="p">,</span>
</span><span id="PTPManager.start_ptp-354"><a href="#PTPManager.start_ptp-354"><span class="linenos">354</span></a>                        <span class="n">stdin</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">DEVNULL</span><span class="p">,</span>
</span><span id="PTPManager.start_ptp-355"><a href="#PTPManager.start_ptp-355"><span class="linenos">355</span></a>                        <span class="n">close_fds</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
</span><span id="PTPManager.start_ptp-356"><a href="#PTPManager.start_ptp-356"><span class="linenos">356</span></a>                        <span class="n">preexec_fn</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">setpgrp</span>
</span><span id="PTPManager.start_ptp-357"><a href="#PTPManager.start_ptp-357"><span class="linenos">357</span></a>                    <span class="p">)</span>
</span><span id="PTPManager.start_ptp-358"><a href="#PTPManager.start_ptp-358"><span class="linenos">358</span></a>
</span><span id="PTPManager.start_ptp-359"><a href="#PTPManager.start_ptp-359"><span class="linenos">359</span></a>                <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-360"><a href="#PTPManager.start_ptp-360"><span class="linenos">360</span></a>
</span><span id="PTPManager.start_ptp-361"><a href="#PTPManager.start_ptp-361"><span class="linenos">361</span></a>                <span class="c1"># Locate the actual ptp4l child process</span>
</span><span id="PTPManager.start_ptp-362"><a href="#PTPManager.start_ptp-362"><span class="linenos">362</span></a>                <span class="n">ptp4l_proc</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PTPManager.start_ptp-363"><a href="#PTPManager.start_ptp-363"><span class="linenos">363</span></a>                <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-364"><a href="#PTPManager.start_ptp-364"><span class="linenos">364</span></a>                    <span class="n">parent</span> <span class="o">=</span> <span class="n">psutil</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span><span class="n">ptp_process</span><span class="o">.</span><span class="n">pid</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-365"><a href="#PTPManager.start_ptp-365"><span class="linenos">365</span></a>                    <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="n">parent</span><span class="o">.</span><span class="n">children</span><span class="p">(</span><span class="n">recursive</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
</span><span id="PTPManager.start_ptp-366"><a href="#PTPManager.start_ptp-366"><span class="linenos">366</span></a>                        <span class="k">if</span> <span class="s2">&quot;ptp4l&quot;</span> <span class="ow">in</span> <span class="n">child</span><span class="o">.</span><span class="n">name</span><span class="p">():</span>
</span><span id="PTPManager.start_ptp-367"><a href="#PTPManager.start_ptp-367"><span class="linenos">367</span></a>                            <span class="n">ptp4l_proc</span> <span class="o">=</span> <span class="n">child</span>
</span><span id="PTPManager.start_ptp-368"><a href="#PTPManager.start_ptp-368"><span class="linenos">368</span></a>                            <span class="k">break</span>
</span><span id="PTPManager.start_ptp-369"><a href="#PTPManager.start_ptp-369"><span class="linenos">369</span></a>                <span class="k">except</span> <span class="n">psutil</span><span class="o">.</span><span class="n">NoSuchProcess</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-370"><a href="#PTPManager.start_ptp-370"><span class="linenos">370</span></a>                    <span class="k">pass</span>
</span><span id="PTPManager.start_ptp-371"><a href="#PTPManager.start_ptp-371"><span class="linenos">371</span></a>
</span><span id="PTPManager.start_ptp-372"><a href="#PTPManager.start_ptp-372"><span class="linenos">372</span></a>                <span class="k">if</span> <span class="n">ptp4l_proc</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-373"><a href="#PTPManager.start_ptp-373"><span class="linenos">373</span></a>                    <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-374"><a href="#PTPManager.start_ptp-374"><span class="linenos">374</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;PTP4L process not found in </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-375"><a href="#PTPManager.start_ptp-375"><span class="linenos">375</span></a>                    <span class="k">continue</span>
</span><span id="PTPManager.start_ptp-376"><a href="#PTPManager.start_ptp-376"><span class="linenos">376</span></a>
</span><span id="PTPManager.start_ptp-377"><a href="#PTPManager.start_ptp-377"><span class="linenos">377</span></a>                <span class="c1"># Format and display process information</span>
</span><span id="PTPManager.start_ptp-378"><a href="#PTPManager.start_ptp-378"><span class="linenos">378</span></a>                <span class="n">start_time</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%D-%H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-379"><a href="#PTPManager.start_ptp-379"><span class="linenos">379</span></a>                <span class="n">cmd_str</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">command</span><span class="p">[</span><span class="mi">3</span><span class="p">:])</span>
</span><span id="PTPManager.start_ptp-380"><a href="#PTPManager.start_ptp-380"><span class="linenos">380</span></a>
</span><span id="PTPManager.start_ptp-381"><a href="#PTPManager.start_ptp-381"><span class="linenos">381</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-382"><a href="#PTPManager.start_ptp-382"><span class="linenos">382</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;PTP launched successfully.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-383"><a href="#PTPManager.start_ptp-383"><span class="linenos">383</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Client: </span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2"> | PID: </span><span class="si">{</span><span class="n">ptp4l_proc</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2"> | Started at: </span><span class="si">{</span><span class="n">start_time</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-384"><a href="#PTPManager.start_ptp-384"><span class="linenos">384</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Log: </span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-385"><a href="#PTPManager.start_ptp-385"><span class="linenos">385</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Command: </span><span class="si">{</span><span class="n">cmd_str</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.start_ptp-386"><a href="#PTPManager.start_ptp-386"><span class="linenos">386</span></a>
</span><span id="PTPManager.start_ptp-387"><a href="#PTPManager.start_ptp-387"><span class="linenos">387</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-388"><a href="#PTPManager.start_ptp-388"><span class="linenos">388</span></a>                <span class="k">with</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_lock</span><span class="p">:</span>
</span><span id="PTPManager.start_ptp-389"><a href="#PTPManager.start_ptp-389"><span class="linenos">389</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error launching PTP on </span><span class="si">{</span><span class="n">client_name</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Launches <code>ptp4l</code> processes for all configured clients.</p>

<p>If enabled, checks for existing <code>ptp4l</code> processes and prompts the user to stop them before starting new ones.
If no clients are currently loaded, attempts to load them from configuration files.</p>

<p>For each valid client, starts a <code>ptp4l</code> process within its corresponding network namespace using <code>sudo</code>,
with output redirected to a dedicated log file. Displays process information including PID, log path, and command.</p>

<h3 id="args">Args</h3>

<ul>
<li><strong>logger</strong> (<code>Optional[Any]</code>): Logger instance for logging messages. Defaults to <code>None</code>.</li>
<li><strong>extra_indent</strong> (<code>int</code>): Indentation level for console messages. Defaults to <code>0</code>.</li>
<li><strong>stop</strong> (<code>bool</code>): Whether to stop existing <code>ptp4l</code> processes before launching new ones. Defaults to <code>True</code>.</li>
</ul>
</div>


                            </div>
                            <div id="PTPManager.stop_ptp" class="classattr">
                                        <input id="PTPManager.stop_ptp-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">stop_ptp</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">preconfirmation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>,</span><span class="param">	<span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PTPManager.stop_ptp-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PTPManager.stop_ptp"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PTPManager.stop_ptp-395"><a href="#PTPManager.stop_ptp-395"><span class="linenos">395</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_ptp</span><span class="p">(</span>
</span><span id="PTPManager.stop_ptp-396"><a href="#PTPManager.stop_ptp-396"><span class="linenos">396</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="PTPManager.stop_ptp-397"><a href="#PTPManager.stop_ptp-397"><span class="linenos">397</span></a>        <span class="n">preconfirmation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="PTPManager.stop_ptp-398"><a href="#PTPManager.stop_ptp-398"><span class="linenos">398</span></a>        <span class="n">logger</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="PTPManager.stop_ptp-399"><a href="#PTPManager.stop_ptp-399"><span class="linenos">399</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span id="PTPManager.stop_ptp-400"><a href="#PTPManager.stop_ptp-400"><span class="linenos">400</span></a>        <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</span><span id="PTPManager.stop_ptp-401"><a href="#PTPManager.stop_ptp-401"><span class="linenos">401</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-402"><a href="#PTPManager.stop_ptp-402"><span class="linenos">402</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager.stop_ptp-403"><a href="#PTPManager.stop_ptp-403"><span class="linenos">403</span></a><span class="sd">        Terminates all active `ptp4l` processes and removes associated log files.</span>
</span><span id="PTPManager.stop_ptp-404"><a href="#PTPManager.stop_ptp-404"><span class="linenos">404</span></a>
</span><span id="PTPManager.stop_ptp-405"><a href="#PTPManager.stop_ptp-405"><span class="linenos">405</span></a><span class="sd">        Detects running `ptp4l` processes and optionally prompts the user for confirmation before terminating them.</span>
</span><span id="PTPManager.stop_ptp-406"><a href="#PTPManager.stop_ptp-406"><span class="linenos">406</span></a><span class="sd">        After stopping the processes, it deletes all related log files and clears the loaded client configurations.</span>
</span><span id="PTPManager.stop_ptp-407"><a href="#PTPManager.stop_ptp-407"><span class="linenos">407</span></a>
</span><span id="PTPManager.stop_ptp-408"><a href="#PTPManager.stop_ptp-408"><span class="linenos">408</span></a><span class="sd">        ### Args</span>
</span><span id="PTPManager.stop_ptp-409"><a href="#PTPManager.stop_ptp-409"><span class="linenos">409</span></a><span class="sd">        - **preconfirmation** (`Optional[bool]`): If `True`, skips the confirmation prompt. Defaults to `False`.</span>
</span><span id="PTPManager.stop_ptp-410"><a href="#PTPManager.stop_ptp-410"><span class="linenos">410</span></a><span class="sd">        - **logger** (`Optional[Any]`): Logger instance for logging messages. Defaults to `None`.</span>
</span><span id="PTPManager.stop_ptp-411"><a href="#PTPManager.stop_ptp-411"><span class="linenos">411</span></a><span class="sd">        - **extra_indent** (`int`): Indentation level for console messages. Defaults to `0`.</span>
</span><span id="PTPManager.stop_ptp-412"><a href="#PTPManager.stop_ptp-412"><span class="linenos">412</span></a><span class="sd">        - **quiet** (`bool`): If `True`, suppresses non-critical console output. Defaults to `True`.</span>
</span><span id="PTPManager.stop_ptp-413"><a href="#PTPManager.stop_ptp-413"><span class="linenos">413</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager.stop_ptp-414"><a href="#PTPManager.stop_ptp-414"><span class="linenos">414</span></a>
</span><span id="PTPManager.stop_ptp-415"><a href="#PTPManager.stop_ptp-415"><span class="linenos">415</span></a>        <span class="c1"># Show section title</span>
</span><span id="PTPManager.stop_ptp-416"><a href="#PTPManager.stop_ptp-416"><span class="linenos">416</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Stopping ptp processes&quot;</span><span class="p">,</span> <span class="s2">&quot;🛑&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-417"><a href="#PTPManager.stop_ptp-417"><span class="linenos">417</span></a>
</span><span id="PTPManager.stop_ptp-418"><a href="#PTPManager.stop_ptp-418"><span class="linenos">418</span></a>        <span class="c1"># Check for running ptp4l processes</span>
</span><span id="PTPManager.stop_ptp-419"><a href="#PTPManager.stop_ptp-419"><span class="linenos">419</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-420"><a href="#PTPManager.stop_ptp-420"><span class="linenos">420</span></a>        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="PTPManager.stop_ptp-421"><a href="#PTPManager.stop_ptp-421"><span class="linenos">421</span></a>
</span><span id="PTPManager.stop_ptp-422"><a href="#PTPManager.stop_ptp-422"><span class="linenos">422</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-423"><a href="#PTPManager.stop_ptp-423"><span class="linenos">423</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;No active ptp4l processes found.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-424"><a href="#PTPManager.stop_ptp-424"><span class="linenos">424</span></a>            <span class="k">return</span>
</span><span id="PTPManager.stop_ptp-425"><a href="#PTPManager.stop_ptp-425"><span class="linenos">425</span></a>
</span><span id="PTPManager.stop_ptp-426"><a href="#PTPManager.stop_ptp-426"><span class="linenos">426</span></a>        <span class="c1"># Ask for confirmation unless preconfirmed</span>
</span><span id="PTPManager.stop_ptp-427"><a href="#PTPManager.stop_ptp-427"><span class="linenos">427</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">preconfirmation</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-428"><a href="#PTPManager.stop_ptp-428"><span class="linenos">428</span></a>            <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Confirm</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⚠️ Are you sure you want to stop the PTP processes?&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-429"><a href="#PTPManager.stop_ptp-429"><span class="linenos">429</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-430"><a href="#PTPManager.stop_ptp-430"><span class="linenos">430</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Stop operation cancelled.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-431"><a href="#PTPManager.stop_ptp-431"><span class="linenos">431</span></a>                <span class="k">return</span>
</span><span id="PTPManager.stop_ptp-432"><a href="#PTPManager.stop_ptp-432"><span class="linenos">432</span></a>
</span><span id="PTPManager.stop_ptp-433"><a href="#PTPManager.stop_ptp-433"><span class="linenos">433</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-434"><a href="#PTPManager.stop_ptp-434"><span class="linenos">434</span></a>            <span class="c1"># Kill each ptp4l process</span>
</span><span id="PTPManager.stop_ptp-435"><a href="#PTPManager.stop_ptp-435"><span class="linenos">435</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Killing all ptp4l processes:&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-436"><a href="#PTPManager.stop_ptp-436"><span class="linenos">436</span></a>            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-437"><a href="#PTPManager.stop_ptp-437"><span class="linenos">437</span></a>                <span class="n">pid</span><span class="p">,</span> <span class="o">*</span><span class="n">cmd</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="PTPManager.stop_ptp-438"><a href="#PTPManager.stop_ptp-438"><span class="linenos">438</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Killing PTP4l process with PID </span><span class="si">{</span><span class="n">pid</span><span class="si">}</span><span class="s2"> → </span><span class="si">{</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-439"><a href="#PTPManager.stop_ptp-439"><span class="linenos">439</span></a>                <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="s2">&quot;kill&quot;</span><span class="p">,</span> <span class="s2">&quot;-9&quot;</span><span class="p">,</span> <span class="n">pid</span><span class="p">],</span> <span class="n">check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-440"><a href="#PTPManager.stop_ptp-440"><span class="linenos">440</span></a>
</span><span id="PTPManager.stop_ptp-441"><a href="#PTPManager.stop_ptp-441"><span class="linenos">441</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;All ptp4l processes have been terminated.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-442"><a href="#PTPManager.stop_ptp-442"><span class="linenos">442</span></a>
</span><span id="PTPManager.stop_ptp-443"><a href="#PTPManager.stop_ptp-443"><span class="linenos">443</span></a>        <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-444"><a href="#PTPManager.stop_ptp-444"><span class="linenos">444</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error stopping ptp4l processes: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-445"><a href="#PTPManager.stop_ptp-445"><span class="linenos">445</span></a>
</span><span id="PTPManager.stop_ptp-446"><a href="#PTPManager.stop_ptp-446"><span class="linenos">446</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-447"><a href="#PTPManager.stop_ptp-447"><span class="linenos">447</span></a>            <span class="c1"># Check and clean log directory</span>
</span><span id="PTPManager.stop_ptp-448"><a href="#PTPManager.stop_ptp-448"><span class="linenos">448</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
</span><span id="PTPManager.stop_ptp-449"><a href="#PTPManager.stop_ptp-449"><span class="linenos">449</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Log directory does not exist: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-450"><a href="#PTPManager.stop_ptp-450"><span class="linenos">450</span></a>                <span class="k">return</span>
</span><span id="PTPManager.stop_ptp-451"><a href="#PTPManager.stop_ptp-451"><span class="linenos">451</span></a>
</span><span id="PTPManager.stop_ptp-452"><a href="#PTPManager.stop_ptp-452"><span class="linenos">452</span></a>            <span class="n">logfiles</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">()</span> <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">is_file</span><span class="p">()]</span>
</span><span id="PTPManager.stop_ptp-453"><a href="#PTPManager.stop_ptp-453"><span class="linenos">453</span></a>
</span><span id="PTPManager.stop_ptp-454"><a href="#PTPManager.stop_ptp-454"><span class="linenos">454</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">logfiles</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-455"><a href="#PTPManager.stop_ptp-455"><span class="linenos">455</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No log files found in: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-456"><a href="#PTPManager.stop_ptp-456"><span class="linenos">456</span></a>                <span class="k">return</span>
</span><span id="PTPManager.stop_ptp-457"><a href="#PTPManager.stop_ptp-457"><span class="linenos">457</span></a>
</span><span id="PTPManager.stop_ptp-458"><a href="#PTPManager.stop_ptp-458"><span class="linenos">458</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Removing all ptp4l log files:&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-459"><a href="#PTPManager.stop_ptp-459"><span class="linenos">459</span></a>
</span><span id="PTPManager.stop_ptp-460"><a href="#PTPManager.stop_ptp-460"><span class="linenos">460</span></a>            <span class="c1"># Delete each log file</span>
</span><span id="PTPManager.stop_ptp-461"><a href="#PTPManager.stop_ptp-461"><span class="linenos">461</span></a>            <span class="k">for</span> <span class="n">archivo</span> <span class="ow">in</span> <span class="n">logfiles</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-462"><a href="#PTPManager.stop_ptp-462"><span class="linenos">462</span></a>                <span class="n">logpath</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">/</span> <span class="n">archivo</span>
</span><span id="PTPManager.stop_ptp-463"><a href="#PTPManager.stop_ptp-463"><span class="linenos">463</span></a>                <span class="k">if</span> <span class="n">logpath</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="PTPManager.stop_ptp-464"><a href="#PTPManager.stop_ptp-464"><span class="linenos">464</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-465"><a href="#PTPManager.stop_ptp-465"><span class="linenos">465</span></a>                        <span class="n">logpath</span><span class="o">.</span><span class="n">unlink</span><span class="p">()</span>
</span><span id="PTPManager.stop_ptp-466"><a href="#PTPManager.stop_ptp-466"><span class="linenos">466</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Deleted log file: </span><span class="si">{</span><span class="n">logpath</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-467"><a href="#PTPManager.stop_ptp-467"><span class="linenos">467</span></a>                    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-468"><a href="#PTPManager.stop_ptp-468"><span class="linenos">468</span></a>                        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Failed to delete log file </span><span class="si">{</span><span class="n">logpath</span><span class="si">}</span><span class="s2">: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-469"><a href="#PTPManager.stop_ptp-469"><span class="linenos">469</span></a>
</span><span id="PTPManager.stop_ptp-470"><a href="#PTPManager.stop_ptp-470"><span class="linenos">470</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;All log files have been processed.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-471"><a href="#PTPManager.stop_ptp-471"><span class="linenos">471</span></a>
</span><span id="PTPManager.stop_ptp-472"><a href="#PTPManager.stop_ptp-472"><span class="linenos">472</span></a>        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager.stop_ptp-473"><a href="#PTPManager.stop_ptp-473"><span class="linenos">473</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unexpected error while deleting log files: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="PTPManager.stop_ptp-474"><a href="#PTPManager.stop_ptp-474"><span class="linenos">474</span></a>
</span><span id="PTPManager.stop_ptp-475"><a href="#PTPManager.stop_ptp-475"><span class="linenos">475</span></a>        <span class="c1"># Clear loaded client configurations</span>
</span><span id="PTPManager.stop_ptp-476"><a href="#PTPManager.stop_ptp-476"><span class="linenos">476</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span> <span class="o">=</span> <span class="p">{}</span>
</span></pre></div>


            <div class="docstring"><p>Terminates all active <code>ptp4l</code> processes and removes associated log files.</p>

<p>Detects running <code>ptp4l</code> processes and optionally prompts the user for confirmation before terminating them.
After stopping the processes, it deletes all related log files and clears the loaded client configurations.</p>

<h3 id="args">Args</h3>

<ul>
<li><strong>preconfirmation</strong> (<code>Optional[bool]</code>): If <code>True</code>, skips the confirmation prompt. Defaults to <code>False</code>.</li>
<li><strong>logger</strong> (<code>Optional[Any]</code>): Logger instance for logging messages. Defaults to <code>None</code>.</li>
<li><strong>extra_indent</strong> (<code>int</code>): Indentation level for console messages. Defaults to <code>0</code>.</li>
<li><strong>quiet</strong> (<code>bool</code>): If <code>True</code>, suppresses non-critical console output. Defaults to <code>True</code>.</li>
</ul>
</div>


                            </div>
                            <div id="PTPManager.print_ptp_log" class="classattr">
                                        <input id="PTPManager.print_ptp_log-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">print_ptp_log</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PTPManager.print_ptp_log-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PTPManager.print_ptp_log"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PTPManager.print_ptp_log-482"><a href="#PTPManager.print_ptp_log-482"><span class="linenos">482</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">print_ptp_log</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager.print_ptp_log-483"><a href="#PTPManager.print_ptp_log-483"><span class="linenos">483</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager.print_ptp_log-484"><a href="#PTPManager.print_ptp_log-484"><span class="linenos">484</span></a><span class="sd">        Displays and follows the real-time log of a selected PTP client.</span>
</span><span id="PTPManager.print_ptp_log-485"><a href="#PTPManager.print_ptp_log-485"><span class="linenos">485</span></a>
</span><span id="PTPManager.print_ptp_log-486"><a href="#PTPManager.print_ptp_log-486"><span class="linenos">486</span></a><span class="sd">        Lists all available PTP log files corresponding to the namespaces defined in the `ptp_clients` dictionary.</span>
</span><span id="PTPManager.print_ptp_log-487"><a href="#PTPManager.print_ptp_log-487"><span class="linenos">487</span></a><span class="sd">        Prompts the user to select one and uses `tail -F` to stream the log output in real time.</span>
</span><span id="PTPManager.print_ptp_log-488"><a href="#PTPManager.print_ptp_log-488"><span class="linenos">488</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager.print_ptp_log-489"><a href="#PTPManager.print_ptp_log-489"><span class="linenos">489</span></a>
</span><span id="PTPManager.print_ptp_log-490"><a href="#PTPManager.print_ptp_log-490"><span class="linenos">490</span></a>        <span class="c1"># Show section title</span>
</span><span id="PTPManager.print_ptp_log-491"><a href="#PTPManager.print_ptp_log-491"><span class="linenos">491</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Printing ptp logs&quot;</span><span class="p">,</span> <span class="s2">&quot;📄&quot;</span><span class="p">)</span>
</span><span id="PTPManager.print_ptp_log-492"><a href="#PTPManager.print_ptp_log-492"><span class="linenos">492</span></a>
</span><span id="PTPManager.print_ptp_log-493"><a href="#PTPManager.print_ptp_log-493"><span class="linenos">493</span></a>        <span class="c1"># Check if ptp4l is running</span>
</span><span id="PTPManager.print_ptp_log-494"><a href="#PTPManager.print_ptp_log-494"><span class="linenos">494</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager.print_ptp_log-495"><a href="#PTPManager.print_ptp_log-495"><span class="linenos">495</span></a>        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="PTPManager.print_ptp_log-496"><a href="#PTPManager.print_ptp_log-496"><span class="linenos">496</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager.print_ptp_log-497"><a href="#PTPManager.print_ptp_log-497"><span class="linenos">497</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No PTP processes have been started or are currently running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager.print_ptp_log-498"><a href="#PTPManager.print_ptp_log-498"><span class="linenos">498</span></a>            <span class="k">return</span>
</span><span id="PTPManager.print_ptp_log-499"><a href="#PTPManager.print_ptp_log-499"><span class="linenos">499</span></a>
</span><span id="PTPManager.print_ptp_log-500"><a href="#PTPManager.print_ptp_log-500"><span class="linenos">500</span></a>        <span class="c1"># Search for log files matching the pattern ptp-&lt;name&gt;.log</span>
</span><span id="PTPManager.print_ptp_log-501"><a href="#PTPManager.print_ptp_log-501"><span class="linenos">501</span></a>        <span class="n">pattern</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^ptp-(.+)\.log$&quot;</span><span class="p">)</span>
</span><span id="PTPManager.print_ptp_log-502"><a href="#PTPManager.print_ptp_log-502"><span class="linenos">502</span></a>        <span class="n">available_logs</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="PTPManager.print_ptp_log-503"><a href="#PTPManager.print_ptp_log-503"><span class="linenos">503</span></a>
</span><span id="PTPManager.print_ptp_log-504"><a href="#PTPManager.print_ptp_log-504"><span class="linenos">504</span></a>        <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span><span class="o">.</span><span class="n">iterdir</span><span class="p">():</span>
</span><span id="PTPManager.print_ptp_log-505"><a href="#PTPManager.print_ptp_log-505"><span class="linenos">505</span></a>            <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="PTPManager.print_ptp_log-506"><a href="#PTPManager.print_ptp_log-506"><span class="linenos">506</span></a>                <span class="n">match</span> <span class="o">=</span> <span class="n">pattern</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="n">filename</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="PTPManager.print_ptp_log-507"><a href="#PTPManager.print_ptp_log-507"><span class="linenos">507</span></a>                <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
</span><span id="PTPManager.print_ptp_log-508"><a href="#PTPManager.print_ptp_log-508"><span class="linenos">508</span></a>                    <span class="n">available_logs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</span><span id="PTPManager.print_ptp_log-509"><a href="#PTPManager.print_ptp_log-509"><span class="linenos">509</span></a>
</span><span id="PTPManager.print_ptp_log-510"><a href="#PTPManager.print_ptp_log-510"><span class="linenos">510</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">available_logs</span><span class="p">:</span>
</span><span id="PTPManager.print_ptp_log-511"><a href="#PTPManager.print_ptp_log-511"><span class="linenos">511</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No log files found for the defined namespaces.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager.print_ptp_log-512"><a href="#PTPManager.print_ptp_log-512"><span class="linenos">512</span></a>            <span class="k">return</span>
</span><span id="PTPManager.print_ptp_log-513"><a href="#PTPManager.print_ptp_log-513"><span class="linenos">513</span></a>
</span><span id="PTPManager.print_ptp_log-514"><a href="#PTPManager.print_ptp_log-514"><span class="linenos">514</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.print_ptp_log-515"><a href="#PTPManager.print_ptp_log-515"><span class="linenos">515</span></a>            <span class="c1"># Build menu choices from log file names</span>
</span><span id="PTPManager.print_ptp_log-516"><a href="#PTPManager.print_ptp_log-516"><span class="linenos">516</span></a>            <span class="n">choices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="PTPManager.print_ptp_log-517"><a href="#PTPManager.print_ptp_log-517"><span class="linenos">517</span></a>                <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. 📄 </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span><span id="PTPManager.print_ptp_log-518"><a href="#PTPManager.print_ptp_log-518"><span class="linenos">518</span></a>                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">available_logs</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager.print_ptp_log-519"><a href="#PTPManager.print_ptp_log-519"><span class="linenos">519</span></a>            <span class="p">]</span>
</span><span id="PTPManager.print_ptp_log-520"><a href="#PTPManager.print_ptp_log-520"><span class="linenos">520</span></a>
</span><span id="PTPManager.print_ptp_log-521"><a href="#PTPManager.print_ptp_log-521"><span class="linenos">521</span></a>            <span class="c1"># Prompt user to select a log</span>
</span><span id="PTPManager.print_ptp_log-522"><a href="#PTPManager.print_ptp_log-522"><span class="linenos">522</span></a>            <span class="n">selected</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="PTPManager.print_ptp_log-523"><a href="#PTPManager.print_ptp_log-523"><span class="linenos">523</span></a>                <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
</span><span id="PTPManager.print_ptp_log-524"><a href="#PTPManager.print_ptp_log-524"><span class="linenos">524</span></a>                <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Available PTP Logs:&quot;</span><span class="p">,</span>
</span><span id="PTPManager.print_ptp_log-525"><a href="#PTPManager.print_ptp_log-525"><span class="linenos">525</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="PTPManager.print_ptp_log-526"><a href="#PTPManager.print_ptp_log-526"><span class="linenos">526</span></a>            <span class="p">)</span>
</span><span id="PTPManager.print_ptp_log-527"><a href="#PTPManager.print_ptp_log-527"><span class="linenos">527</span></a>
</span><span id="PTPManager.print_ptp_log-528"><a href="#PTPManager.print_ptp_log-528"><span class="linenos">528</span></a>            <span class="c1"># Build full path to the selected log file</span>
</span><span id="PTPManager.print_ptp_log-529"><a href="#PTPManager.print_ptp_log-529"><span class="linenos">529</span></a>            <span class="n">log_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">log_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;ptp-</span><span class="si">{</span><span class="n">selected</span><span class="si">}</span><span class="s2">.log&quot;</span>
</span><span id="PTPManager.print_ptp_log-530"><a href="#PTPManager.print_ptp_log-530"><span class="linenos">530</span></a>
</span><span id="PTPManager.print_ptp_log-531"><a href="#PTPManager.print_ptp_log-531"><span class="linenos">531</span></a>        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="PTPManager.print_ptp_log-532"><a href="#PTPManager.print_ptp_log-532"><span class="linenos">532</span></a>            <span class="c1"># Handle cancellation</span>
</span><span id="PTPManager.print_ptp_log-533"><a href="#PTPManager.print_ptp_log-533"><span class="linenos">533</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation cancelled by user.&quot;</span><span class="p">)</span>
</span><span id="PTPManager.print_ptp_log-534"><a href="#PTPManager.print_ptp_log-534"><span class="linenos">534</span></a>            <span class="k">return</span>
</span><span id="PTPManager.print_ptp_log-535"><a href="#PTPManager.print_ptp_log-535"><span class="linenos">535</span></a>
</span><span id="PTPManager.print_ptp_log-536"><a href="#PTPManager.print_ptp_log-536"><span class="linenos">536</span></a>        <span class="c1"># Display the log in real time</span>
</span><span id="PTPManager.print_ptp_log-537"><a href="#PTPManager.print_ptp_log-537"><span class="linenos">537</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">real_time_log</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Displays and follows the real-time log of a selected PTP client.</p>

<p>Lists all available PTP log files corresponding to the namespaces defined in the <code>ptp_clients</code> dictionary.
Prompts the user to select one and uses <code>tail -F</code> to stream the log output in real time.</p>
</div>


                            </div>
                            <div id="PTPManager.ping_server" class="classattr">
                                        <input id="PTPManager.ping_server-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">ping_server</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="PTPManager.ping_server-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#PTPManager.ping_server"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="PTPManager.ping_server-543"><a href="#PTPManager.ping_server-543"><span class="linenos">543</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">ping_server</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-544"><a href="#PTPManager.ping_server-544"><span class="linenos">544</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="PTPManager.ping_server-545"><a href="#PTPManager.ping_server-545"><span class="linenos">545</span></a><span class="sd">        Performs a ping test to the PTP server from each configured namespace.</span>
</span><span id="PTPManager.ping_server-546"><a href="#PTPManager.ping_server-546"><span class="linenos">546</span></a>
</span><span id="PTPManager.ping_server-547"><a href="#PTPManager.ping_server-547"><span class="linenos">547</span></a><span class="sd">        For each client, extracts the server&#39;s IP address from its `.config` file by locating the line containing `&#39;UDPv4&#39;`.</span>
</span><span id="PTPManager.ping_server-548"><a href="#PTPManager.ping_server-548"><span class="linenos">548</span></a><span class="sd">        Then, executes a ping command from the corresponding network namespace to verify connectivity.</span>
</span><span id="PTPManager.ping_server-549"><a href="#PTPManager.ping_server-549"><span class="linenos">549</span></a><span class="sd">        Displays the result of each ping attempt in the console.</span>
</span><span id="PTPManager.ping_server-550"><a href="#PTPManager.ping_server-550"><span class="linenos">550</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="PTPManager.ping_server-551"><a href="#PTPManager.ping_server-551"><span class="linenos">551</span></a>
</span><span id="PTPManager.ping_server-552"><a href="#PTPManager.ping_server-552"><span class="linenos">552</span></a>        <span class="c1"># Check if ptp4l is currently running</span>
</span><span id="PTPManager.ping_server-553"><a href="#PTPManager.ping_server-553"><span class="linenos">553</span></a>        <span class="n">result</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">([</span><span class="s2">&quot;pgrep&quot;</span><span class="p">,</span> <span class="s2">&quot;-a&quot;</span><span class="p">,</span> <span class="s2">&quot;ptp4l&quot;</span><span class="p">],</span> <span class="n">capture_output</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">text</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="PTPManager.ping_server-554"><a href="#PTPManager.ping_server-554"><span class="linenos">554</span></a>        <span class="n">lines</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">splitlines</span><span class="p">()</span>
</span><span id="PTPManager.ping_server-555"><a href="#PTPManager.ping_server-555"><span class="linenos">555</span></a>        <span class="k">if</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-556"><a href="#PTPManager.ping_server-556"><span class="linenos">556</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;PTP processes have been started or are currently running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager.ping_server-557"><a href="#PTPManager.ping_server-557"><span class="linenos">557</span></a>            <span class="k">return</span>
</span><span id="PTPManager.ping_server-558"><a href="#PTPManager.ping_server-558"><span class="linenos">558</span></a>
</span><span id="PTPManager.ping_server-559"><a href="#PTPManager.ping_server-559"><span class="linenos">559</span></a>        <span class="c1"># Load client configurations</span>
</span><span id="PTPManager.ping_server-560"><a href="#PTPManager.ping_server-560"><span class="linenos">560</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_clients</span><span class="p">():</span>
</span><span id="PTPManager.ping_server-561"><a href="#PTPManager.ping_server-561"><span class="linenos">561</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Aborting ping test due to failed client loading.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager.ping_server-562"><a href="#PTPManager.ping_server-562"><span class="linenos">562</span></a>            <span class="k">return</span>
</span><span id="PTPManager.ping_server-563"><a href="#PTPManager.ping_server-563"><span class="linenos">563</span></a>
</span><span id="PTPManager.ping_server-564"><a href="#PTPManager.ping_server-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Pinging PTP Server from each Namespace&quot;</span><span class="p">,</span> <span class="s2">&quot;📡&quot;</span><span class="p">)</span>
</span><span id="PTPManager.ping_server-565"><a href="#PTPManager.ping_server-565"><span class="linenos">565</span></a>
</span><span id="PTPManager.ping_server-566"><a href="#PTPManager.ping_server-566"><span class="linenos">566</span></a>        <span class="c1"># Iterate over each client to perform ping</span>
</span><span id="PTPManager.ping_server-567"><a href="#PTPManager.ping_server-567"><span class="linenos">567</span></a>        <span class="k">for</span> <span class="n">iface</span><span class="p">,</span> <span class="n">data</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_clients</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="PTPManager.ping_server-568"><a href="#PTPManager.ping_server-568"><span class="linenos">568</span></a>            <span class="n">namespace</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;namespace&quot;</span><span class="p">]</span>
</span><span id="PTPManager.ping_server-569"><a href="#PTPManager.ping_server-569"><span class="linenos">569</span></a>            <span class="n">config_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ptp4l_config_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">data</span><span class="p">[</span><span class="s2">&quot;config&quot;</span><span class="p">]</span>
</span><span id="PTPManager.ping_server-570"><a href="#PTPManager.ping_server-570"><span class="linenos">570</span></a>
</span><span id="PTPManager.ping_server-571"><a href="#PTPManager.ping_server-571"><span class="linenos">571</span></a>            <span class="c1"># Extract server IP from config file</span>
</span><span id="PTPManager.ping_server-572"><a href="#PTPManager.ping_server-572"><span class="linenos">572</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-573"><a href="#PTPManager.ping_server-573"><span class="linenos">573</span></a>                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">config_path</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-574"><a href="#PTPManager.ping_server-574"><span class="linenos">574</span></a>                    <span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
</span><span id="PTPManager.ping_server-575"><a href="#PTPManager.ping_server-575"><span class="linenos">575</span></a>
</span><span id="PTPManager.ping_server-576"><a href="#PTPManager.ping_server-576"><span class="linenos">576</span></a>                <span class="n">server_ip</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="PTPManager.ping_server-577"><a href="#PTPManager.ping_server-577"><span class="linenos">577</span></a>                <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-578"><a href="#PTPManager.ping_server-578"><span class="linenos">578</span></a>                    <span class="k">if</span> <span class="s2">&quot;UDPv4&quot;</span> <span class="ow">in</span> <span class="n">line</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-579"><a href="#PTPManager.ping_server-579"><span class="linenos">579</span></a>                        <span class="n">parts</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
</span><span id="PTPManager.ping_server-580"><a href="#PTPManager.ping_server-580"><span class="linenos">580</span></a>                        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">parts</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">2</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-581"><a href="#PTPManager.ping_server-581"><span class="linenos">581</span></a>                            <span class="n">server_ip</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="PTPManager.ping_server-582"><a href="#PTPManager.ping_server-582"><span class="linenos">582</span></a>                            <span class="k">break</span>
</span><span id="PTPManager.ping_server-583"><a href="#PTPManager.ping_server-583"><span class="linenos">583</span></a>
</span><span id="PTPManager.ping_server-584"><a href="#PTPManager.ping_server-584"><span class="linenos">584</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">server_ip</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-585"><a href="#PTPManager.ping_server-585"><span class="linenos">585</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No &#39;UDPv4&#39; entry found in config for </span><span class="si">{</span><span class="n">iface</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager.ping_server-586"><a href="#PTPManager.ping_server-586"><span class="linenos">586</span></a>                    <span class="k">continue</span>
</span><span id="PTPManager.ping_server-587"><a href="#PTPManager.ping_server-587"><span class="linenos">587</span></a>
</span><span id="PTPManager.ping_server-588"><a href="#PTPManager.ping_server-588"><span class="linenos">588</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-589"><a href="#PTPManager.ping_server-589"><span class="linenos">589</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error reading config file for </span><span class="si">{</span><span class="n">iface</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager.ping_server-590"><a href="#PTPManager.ping_server-590"><span class="linenos">590</span></a>                <span class="k">continue</span>
</span><span id="PTPManager.ping_server-591"><a href="#PTPManager.ping_server-591"><span class="linenos">591</span></a>
</span><span id="PTPManager.ping_server-592"><a href="#PTPManager.ping_server-592"><span class="linenos">592</span></a>            <span class="c1"># Notify user and execute ping</span>
</span><span id="PTPManager.ping_server-593"><a href="#PTPManager.ping_server-593"><span class="linenos">593</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Pinging from </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2"> to </span><span class="si">{</span><span class="n">server_ip</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="PTPManager.ping_server-594"><a href="#PTPManager.ping_server-594"><span class="linenos">594</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-595"><a href="#PTPManager.ping_server-595"><span class="linenos">595</span></a>                <span class="n">output</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">check_output</span><span class="p">(</span>
</span><span id="PTPManager.ping_server-596"><a href="#PTPManager.ping_server-596"><span class="linenos">596</span></a>                    <span class="p">[</span><span class="s2">&quot;sudo&quot;</span><span class="p">,</span> <span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;netns&quot;</span><span class="p">,</span> <span class="s2">&quot;exec&quot;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">,</span> <span class="s2">&quot;ping&quot;</span><span class="p">,</span> <span class="s2">&quot;-c&quot;</span><span class="p">,</span> <span class="s2">&quot;5&quot;</span><span class="p">,</span> <span class="n">server_ip</span><span class="p">],</span>
</span><span id="PTPManager.ping_server-597"><a href="#PTPManager.ping_server-597"><span class="linenos">597</span></a>                    <span class="n">stderr</span><span class="o">=</span><span class="n">subprocess</span><span class="o">.</span><span class="n">STDOUT</span>
</span><span id="PTPManager.ping_server-598"><a href="#PTPManager.ping_server-598"><span class="linenos">598</span></a>                <span class="p">)</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span>
</span><span id="PTPManager.ping_server-599"><a href="#PTPManager.ping_server-599"><span class="linenos">599</span></a>
</span><span id="PTPManager.ping_server-600"><a href="#PTPManager.ping_server-600"><span class="linenos">600</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="PTPManager.ping_server-601"><a href="#PTPManager.ping_server-601"><span class="linenos">601</span></a>
</span><span id="PTPManager.ping_server-602"><a href="#PTPManager.ping_server-602"><span class="linenos">602</span></a>            <span class="k">except</span> <span class="n">subprocess</span><span class="o">.</span><span class="n">CalledProcessError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="PTPManager.ping_server-603"><a href="#PTPManager.ping_server-603"><span class="linenos">603</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Ping failed from </span><span class="si">{</span><span class="n">namespace</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="si">{</span><span class="n">e</span><span class="o">.</span><span class="n">output</span><span class="o">.</span><span class="n">decode</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="PTPManager.ping_server-604"><a href="#PTPManager.ping_server-604"><span class="linenos">604</span></a>
</span><span id="PTPManager.ping_server-605"><a href="#PTPManager.ping_server-605"><span class="linenos">605</span></a>            <span class="c1"># Brief pause before next ping</span>
</span><span id="PTPManager.ping_server-606"><a href="#PTPManager.ping_server-606"><span class="linenos">606</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="mf">0.5</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Performs a ping test to the PTP server from each configured namespace.</p>

<p>For each client, extracts the server's IP address from its <code>.config</code> file by locating the line containing <code>'UDPv4'</code>.
Then, executes a ping command from the corresponding network namespace to verify connectivity.
Displays the result of each ping attempt in the console.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>