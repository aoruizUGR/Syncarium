<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>syncarium.tui.core.dext API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../core.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;syncarium.tui.core</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#dextpy">dext.py</a></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#DataExtractorTool">DataExtractorTool</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#DataExtractorTool.__init__">DataExtractorTool</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataExtractorTool.vt">vt</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataExtractorTool.config_dir">config_dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataExtractorTool.output_dir">output_dir</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataExtractorTool.loaded_datasources">loaded_datasources</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataExtractorTool.writer_process">writer_process</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataExtractorTool.output_filepath">output_filepath</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataExtractorTool.start_time">start_time</a>
                        </li>
                        <li>
                                <a class="variable" href="#DataExtractorTool.duration">duration</a>
                        </li>
                        <li>
                                <a class="function" href="#DataExtractorTool.main_menu">main_menu</a>
                        </li>
                        <li>
                                <a class="function" href="#DataExtractorTool.load_datasources">load_datasources</a>
                        </li>
                        <li>
                                <a class="function" href="#DataExtractorTool.start_extraction">start_extraction</a>
                        </li>
                        <li>
                                <a class="function" href="#DataExtractorTool.write_metrics">write_metrics</a>
                        </li>
                        <li>
                                <a class="function" href="#DataExtractorTool.stop_extraction">stop_extraction</a>
                        </li>
                        <li>
                                <a class="function" href="#DataExtractorTool.show_progress">show_progress</a>
                        </li>
                        <li>
                                <a class="function" href="#DataExtractorTool.show_extracted_data">show_extracted_data</a>
                        </li>
                        <li>
                                <a class="function" href="#DataExtractorTool.exit">exit</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
syncarium<wbr>.<a href="./../../tui.html">tui</a><wbr>.<a href="./../core.html">core</a><wbr>.dext    </h1>

                        <div class="docstring"><h1 id="dextpy">dext.py</h1>

<p><strong>Project</strong>: Syncarium – Intelligent Timing Platform Toolkit<br />
<strong>Description</strong>: Data Extractor Tool for TUI<br />
<strong>Author</strong>: PhD Student Alberto Ortega Ruiz, PhD Student Víctor Vázquez, University of Granada<br />
<strong>Created</strong>: 2025-05-31<br />
<strong>Version</strong>: 1.0.0<br />
<strong>License</strong>: GPLv3</p>
</div>

                        <input id="mod-dext-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-dext-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="ch">#!/usr/bin/env python3</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="c1"># -*- coding: utf-8 -*-</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="sd"># dext.py</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="sd">**Project**: Syncarium – Intelligent Timing Platform Toolkit  </span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="sd">**Description**: Data Extractor Tool for TUI  </span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a><span class="sd">**Author**: PhD Student Alberto Ortega Ruiz, PhD Student Víctor Vázquez, University of Granada  </span>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="sd">**Created**: 2025-05-31  </span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="sd">**Version**: 1.0.0  </span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">**License**: GPLv3</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="c1"># Standard Library Imports</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">csv</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">threading</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">multiprocessing</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">queue</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">yaml</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">datetime</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">signal</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">pathlib</span><span class="w"> </span><span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a><span class="c1"># Third-Party Imports</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">rich.prompt</span><span class="w"> </span><span class="kn">import</span> <span class="n">Prompt</span><span class="p">,</span> <span class="n">IntPrompt</span><span class="p">,</span> <span class="n">Confirm</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a><span class="c1"># Local Application Imports</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">syncarium.tui.utils</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">utils</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">syncarium.tui.core.dsources</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">dsources</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="c1"># 📈 Data Extractor Tool Class</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DataExtractorTool</span><span class="p">:</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">    Tool for extracting data from configured sources and managing output files.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">    ### Attributes</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">    - **vt** (`utils.ViewTools`): Utility tools for view-related operations.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">    - **output_dir** (`Path`): Directory where output files will be stored.</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a><span class="sd">    - **loaded_datasources** (`List[dsources.DataSource]`): List of data sources that have been loaded.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a><span class="sd">    - **writer_process** (`multiprocessing.Process`): Background process responsible for writing output.</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a><span class="sd">    - **output_filepath** (`Optional[Path]`): Path to the output file, if available.</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a><span class="sd">    - **start_time** (`Optional[float]`): Timestamp marking the start of the extraction process.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a><span class="sd">    - **duration** (`Optional[int]`): Duration of the extraction process in seconds.</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>    <span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>    <span class="c1"># 🚧 Constructor</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>    <span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a><span class="sd">        Initialize a new instance of `DataExtractorTool` with default paths and metadata.</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a><span class="sd">        ### Args</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a><span class="sd">        - **vt** (`utils.ViewTools`): Utility tools for view-related operations.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a>        <span class="c1"># Store the view tools instance</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span> <span class="o">=</span> <span class="n">vt</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a>        <span class="c1"># Define configuration and output directories using pathlib</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;suite&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">)</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>        <span class="c1"># Initialize the list of loaded data sources</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dsources</span><span class="o">.</span><span class="n">DataSource</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>        <span class="c1"># Prepare the writer process (not started yet)</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>        <span class="c1"># Initialize metadata for output tracking</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="c1"># 📋 Function: main_menu</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">main_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a><span class="sd">        Render and manage the interactive terminal-based main menu for data extraction.</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a><span class="sd">        Continuously displays a menu using InquirerPy, allowing the user to:</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a><span class="sd">        - Load data sources</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a><span class="sd">        - Start or stop the extractor</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a><span class="sd">        - View progress and extracted data</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a><span class="sd">        - Refresh the view</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a><span class="sd">        - Exit the tool</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a><span class="sd">        The loop runs until the user selects **&quot;❌ Exit&quot;** or interrupts the process with **Ctrl+C**.</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a><span class="sd">        ### Menu Options</span>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a><span class="sd">        - 🛢️ Load Data Sources → `load_datasources`</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="sd">        - 📈 Start Extractor → `start_extraction`</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        - 🛑 Stop Extractor → `stop_extraction`</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        - ⏳ Show Progress → `show_progress`</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        - 📄 Show Extracted Data → `show_extracted_data`</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a><span class="sd">        - 🔄 Refresh View → no action</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a><span class="sd">        - ❌ Exit → terminates the menu loop</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a><span class="sd">        ### Notes</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a><span class="sd">        - Graceful termination is supported via **Ctrl+C**.</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>                <span class="c1"># Show software title without delay</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_software_title</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>                <span class="c1"># Display the main menu title</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;main_title&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Extractor Tool Menu&quot;</span><span class="p">,</span> <span class="s2">&quot;📈&quot;</span><span class="p">)</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>                <span class="c1"># Show the most recent metric</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_last_metric</span><span class="p">()</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>                <span class="c1"># Display loaded data sources</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_datasources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">)</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a>                <span class="c1"># Show extractor status and output information</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_data_extractor</span><span class="p">(</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="p">,</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">,</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span><span class="p">,</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>                <span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>                <span class="c1"># Present interactive menu options</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>                <span class="n">choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="p">[</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🛢️ Load Data Sources&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;load_datasources&quot;</span><span class="p">},</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📈 Start Extractor&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;start_extraction&quot;</span><span class="p">},</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🛑 Stop Extractor&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;stop_extraction&quot;</span><span class="p">},</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;⏳ Show Progress&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;show_progress&quot;</span><span class="p">},</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📄 Show Extracted Data&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;show_extracted_data&quot;</span><span class="p">},</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🔄 Refresh view&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">},</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;❌ Exit&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;exit&quot;</span><span class="p">},</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>                    <span class="p">],</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>                <span class="p">)</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>                <span class="c1"># Map menu options to corresponding methods</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>                <span class="n">submenu</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a>                    <span class="s2">&quot;load_datasources&quot;</span><span class="p">:</span>     <span class="bp">self</span><span class="o">.</span><span class="n">load_datasources</span><span class="p">,</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>                    <span class="s2">&quot;start_extraction&quot;</span><span class="p">:</span>     <span class="bp">self</span><span class="o">.</span><span class="n">start_extraction</span><span class="p">,</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a>                    <span class="s2">&quot;stop_extraction&quot;</span><span class="p">:</span>      <span class="bp">self</span><span class="o">.</span><span class="n">stop_extraction</span><span class="p">,</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a>                    <span class="s2">&quot;show_progress&quot;</span><span class="p">:</span>        <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a>                    <span class="s2">&quot;show_extracted_data&quot;</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">show_extracted_data</span><span class="p">,</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a>                <span class="p">}</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a>                <span class="c1"># Handle user selection</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a>                <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;exit&quot;</span><span class="p">:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>                    <span class="k">break</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>                <span class="k">elif</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">:</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>                    <span class="n">action</span> <span class="o">=</span> <span class="n">submenu</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>                    <span class="k">if</span> <span class="n">action</span><span class="p">:</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>                        <span class="n">action</span><span class="p">()</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>                        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🔙 Press ⏎ to return to the menu...&quot;</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>            <span class="c1"># Gracefully handle Ctrl+C interruption</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;Exiting...&quot;</span><span class="p">)</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a><span class="c1"># 📌 Function: load_datasources</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_datasources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_cfg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a><span class="sd">        Load and configure data sources from a YAML configuration file.</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a><span class="sd">        Clears any previously loaded sources and parses the selected configuration file,</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a><span class="sd">        instantiating the appropriate data source classes. If no file is provided, the user</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a><span class="sd">        is prompted to select one interactively from the available files in the config directory.</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a><span class="sd">        ### Args</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a><span class="sd">        - **file_cfg** (`Optional[str]`): Path to the YAML configuration file. If `None`, prompts the user to select one.</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a><span class="sd">        - **quiet** (`bool`): If `True`, suppresses console output messages.</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a><span class="sd">        ### Notes</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a><span class="sd">        - Prevents loading if the extractor process is currently running.</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a><span class="sd">        - Supports graceful cancellation via **Ctrl+C**.</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a><span class="sd">        - Automatically creates missing log files if required by a `FileLogDataSource`.</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a><span class="sd">        - Displays success or error messages for each data source loaded.</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Sources Configuration&quot;</span><span class="p">,</span> <span class="s2">&quot;🛢️&quot;</span><span class="p">)</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>        <span class="c1"># Prevent loading if extractor is running</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Data extractor is running already.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>            <span class="k">return</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>        <span class="c1"># Clear previously loaded data sources</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="s2">&quot;Deleting previous data sources.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>        <span class="c1"># Determine configuration file path</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>        <span class="k">if</span> <span class="n">file_cfg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>            <span class="n">config_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.yaml&quot;</span><span class="p">)]</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">config_files</span><span class="p">:</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No data sources files found in &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>                <span class="k">return</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>                <span class="n">choices</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>                    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. 📄 </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">config_files</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>                <span class="p">]</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a>                <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a>                    <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Available Data Sources Files:&quot;</span><span class="p">,</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a>                <span class="p">)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>                <span class="n">filepath_cfg</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">selected</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation cancelled by user.&quot;</span><span class="p">)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                <span class="k">return</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>            <span class="n">filepath_cfg</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_cfg</span><span class="p">)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="c1"># Load YAML configuration</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath_cfg</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>            <span class="n">yaml_data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">yaml_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dext_datasources&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a>        <span class="c1"># Parse each data source entry</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a>        <span class="k">for</span> <span class="n">source_name</span><span class="p">,</span> <span class="n">source_info</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a>                <span class="n">data_class</span> <span class="o">=</span> <span class="n">source_info</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;data_class&#39;</span><span class="p">)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a>                <span class="k">if</span> <span class="n">data_class</span> <span class="o">==</span> <span class="s1">&#39;FileLogDataSource&#39;</span><span class="p">:</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loading FileLogDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>                    <span class="n">log_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;filepath&quot;</span><span class="p">])</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">log_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> 
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Log file not found: </span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Creating log file: </span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>                        <span class="n">log_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>                        <span class="n">log_path</span><span class="o">.</span><span class="n">touch</span><span class="p">()</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>                        <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">dsources</span><span class="o">.</span><span class="n">FileLogDataSource</span><span class="p">,</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">source_name</span><span class="p">,</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>                        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>                            <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;pattern&quot;</span><span class="p">],</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>                            <span class="s2">&quot;filepath&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>                        <span class="p">}</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>                    <span class="p">})</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loaded FileLogDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>                <span class="k">elif</span> <span class="n">data_class</span> <span class="o">==</span> <span class="s2">&quot;PPSAnalyzerDataSource&quot;</span><span class="p">:</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loading PPSAnalyzerDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>                        <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">dsources</span><span class="o">.</span><span class="n">PPSAnalyzerDataSource</span><span class="p">,</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">source_name</span><span class="p">,</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>                        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>                            <span class="s2">&quot;serial_port&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;serial_port&quot;</span><span class="p">],</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>                            <span class="s2">&quot;pps_inputs&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;pps_inputs&quot;</span><span class="p">],</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>                            <span class="s2">&quot;cable_delays&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;cable_delays&quot;</span><span class="p">],</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>                        <span class="p">}</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>                    <span class="p">})</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loaded PPSAnalyzerDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unknown Data Source: </span><span class="si">{</span><span class="n">data_class</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error loading </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">data_class</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>        <span class="c1"># Final confirmation</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Data Sources successfully loaded from </span><span class="si">{</span><span class="n">filepath_cfg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a><span class="c1"># 📌 Function: start_extraction</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">start_extraction</span><span class="p">(</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>        <span class="n">suffix_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>        <span class="n">dir_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>        <span class="n">duration_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>        <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a><span class="sd">        Start the data extraction process using the configured data sources.</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a><span class="sd">        Launches a background writer process that collects metrics and stores them</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a><span class="sd">        in a CSV file. A YAML summary file is also generated, containing metadata</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a><span class="sd">        about the extraction session.</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a><span class="sd">        ### Args</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a><span class="sd">        - **suffix_out** (`Optional[str]`): Suffix for the output CSV file name. If `None`, the user is prompted.</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a><span class="sd">        - **dir_out** (`Optional[str]`): Directory where output files will be saved. If `None`, defaults to the configured output directory.</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a><span class="sd">        - **duration_out** (`Optional[int]`): Duration of the extraction in seconds. If `None`, the user is prompted.</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a><span class="sd">        - **logger**: Optional logger instance for logging messages.</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages.</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos">318</span></a>
</span><span id="L-319"><a href="#L-319"><span class="linenos">319</span></a><span class="sd">        ### Notes</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos">320</span></a><span class="sd">        - Prevents starting a new extraction if a writer process is already running.</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos">321</span></a><span class="sd">        - Prompts the user interactively for missing parameters unless provided.</span>
</span><span id="L-322"><a href="#L-322"><span class="linenos">322</span></a><span class="sd">        - Automatically creates missing output directories and log files.</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos">323</span></a><span class="sd">        - Saves extraction metadata to a YAML file alongside the CSV output.</span>
</span><span id="L-324"><a href="#L-324"><span class="linenos">324</span></a><span class="sd">        - Displays process details including PID, start time, duration, and assigned data sources.</span>
</span><span id="L-325"><a href="#L-325"><span class="linenos">325</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos">326</span></a>
</span><span id="L-327"><a href="#L-327"><span class="linenos">327</span></a>        <span class="c1"># Prevent starting if a writer process is already running</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos">328</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos">329</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos">330</span></a>                <span class="s2">&quot;caution&quot;</span><span class="p">,</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos">331</span></a>                <span class="sa">f</span><span class="s2">&quot;A writer process is already running with PID </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos">332</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos">333</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos">334</span></a>            <span class="p">)</span>
</span><span id="L-335"><a href="#L-335"><span class="linenos">335</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos">336</span></a>                <span class="s2">&quot;info&quot;</span><span class="p">,</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos">337</span></a>                <span class="s2">&quot;To start a new extraction it is necessary to manually stop extraction from menu.&quot;</span><span class="p">,</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos">338</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-339"><a href="#L-339"><span class="linenos">339</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos">340</span></a>            <span class="p">)</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos">341</span></a>            <span class="k">return</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos">342</span></a>
</span><span id="L-343"><a href="#L-343"><span class="linenos">343</span></a>        <span class="c1"># Ensure data sources are loaded</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos">344</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos">345</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos">346</span></a>                <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos">347</span></a>                <span class="s2">&quot;No data sources registered. Cannot start extraction.&quot;</span><span class="p">,</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos">348</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos">349</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="L-350"><a href="#L-350"><span class="linenos">350</span></a>            <span class="p">)</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos">351</span></a>            <span class="k">return</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos">352</span></a>
</span><span id="L-353"><a href="#L-353"><span class="linenos">353</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Starting extraction&quot;</span><span class="p">,</span> <span class="s2">&quot;📈&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos">354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos">355</span></a>        <span class="c1"># Prompt user for suffix and duration if not provided</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos">356</span></a>        <span class="k">if</span> <span class="n">suffix_out</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos">357</span></a>            <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Prompt</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;📁 Enter a suffix for the output CSV file&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;metrics&quot;</span><span class="p">)</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos">358</span></a>            <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">IntPrompt</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⏱️ Enter duration in seconds&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos">359</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-360"><a href="#L-360"><span class="linenos">360</span></a>            <span class="n">suffix</span> <span class="o">=</span> <span class="n">suffix_out</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos">361</span></a>            <span class="n">duration</span> <span class="o">=</span> <span class="n">duration_out</span> <span class="k">if</span> <span class="n">duration_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">60</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos">362</span></a>
</span><span id="L-363"><a href="#L-363"><span class="linenos">363</span></a>        <span class="c1"># Update output directory if provided</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos">364</span></a>        <span class="k">if</span> <span class="n">dir_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos">365</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dir_out</span><span class="p">)</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos">366</span></a>
</span><span id="L-367"><a href="#L-367"><span class="linenos">367</span></a>        <span class="c1"># Record start time and calculate planned end time</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos">368</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos">369</span></a>        <span class="n">start_time_hr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y %H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos">370</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">duration</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos">371</span></a>        <span class="n">planned_end_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos">372</span></a>        <span class="n">planned_end_time_hr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">planned_end_time</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y %H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos">373</span></a>
</span><span id="L-374"><a href="#L-374"><span class="linenos">374</span></a>        <span class="c1"># Create output file path with timestamp</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos">375</span></a>        <span class="n">output_filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">.csv&quot;</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos">376</span></a>        <span class="n">output_filepath</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos">377</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_filepath</span><span class="p">)</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos">378</span></a>
</span><span id="L-379"><a href="#L-379"><span class="linenos">379</span></a>        <span class="c1"># Prepare data source configurations for the writer process</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos">380</span></a>        <span class="n">source_configs</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos">381</span></a>            <span class="p">{</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos">382</span></a>                <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">],</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos">383</span></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos">384</span></a>                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos">385</span></a>            <span class="p">}</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos">386</span></a>            <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos">387</span></a>        <span class="p">]</span>
</span><span id="L-388"><a href="#L-388"><span class="linenos">388</span></a>
</span><span id="L-389"><a href="#L-389"><span class="linenos">389</span></a>        <span class="c1"># Save extractor parameters to a YAML file</span>
</span><span id="L-390"><a href="#L-390"><span class="linenos">390</span></a>        <span class="n">extractor_output</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-391"><a href="#L-391"><span class="linenos">391</span></a>            <span class="s2">&quot;datasources&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos">392</span></a>                <span class="n">source</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="p">{</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos">393</span></a>                    <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos">394</span></a>                <span class="p">}</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos">395</span></a>                <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos">396</span></a>            <span class="p">},</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos">397</span></a>            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos">398</span></a>            <span class="s2">&quot;started_at&quot;</span><span class="p">:</span> <span class="n">start_time_hr</span><span class="p">,</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos">399</span></a>            <span class="s2">&quot;finished_at_planned&quot;</span><span class="p">:</span> <span class="n">planned_end_time_hr</span>
</span><span id="L-400"><a href="#L-400"><span class="linenos">400</span></a>        <span class="p">}</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos">401</span></a>
</span><span id="L-402"><a href="#L-402"><span class="linenos">402</span></a>        <span class="n">extractor_output_filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">.yaml&quot;</span>
</span><span id="L-403"><a href="#L-403"><span class="linenos">403</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">extractor_output_filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos">404</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">extractor_output</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos">405</span></a>
</span><span id="L-406"><a href="#L-406"><span class="linenos">406</span></a>        <span class="c1"># Launch the writer process</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos">407</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos">408</span></a>            <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">write_metrics</span><span class="p">,</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos">409</span></a>            <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">output_filepath</span><span class="p">,</span> <span class="n">extractor_output_filepath</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">source_configs</span><span class="p">)</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos">410</span></a>        <span class="p">)</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos">411</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos">412</span></a>
</span><span id="L-413"><a href="#L-413"><span class="linenos">413</span></a>        <span class="c1"># Display confirmation and process details</span>
</span><span id="L-414"><a href="#L-414"><span class="linenos">414</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Extractor launched successfully.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos">415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;PID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2"> | Started at: </span><span class="si">{</span><span class="n">start_time_hr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Duration: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Data Sources assigned: </span><span class="si">{</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">source_configs</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos">418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos">419</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos">420</span></a><span class="c1"># 🧪 Function: write_metrics</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos">421</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos">422</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_metrics</span><span class="p">(</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos">423</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos">424</span></a>        <span class="n">output_filepath</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos">425</span></a>        <span class="n">extractor_output_filepath</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="L-426"><a href="#L-426"><span class="linenos">426</span></a>        <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos">427</span></a>        <span class="n">source_configs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos">428</span></a>        <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos">429</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos">430</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos">431</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos">432</span></a><span class="sd">        Collect metrics from configured data sources and write them to a CSV file.</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos">433</span></a>
</span><span id="L-434"><a href="#L-434"><span class="linenos">434</span></a><span class="sd">        Starts each data source in a separate thread and coordinates data collection</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos">435</span></a><span class="sd">        through a shared queue. Metrics are timestamped and written to the output file.</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos">436</span></a><span class="sd">        Upon completion, metadata is appended to a YAML summary file.</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos">437</span></a>
</span><span id="L-438"><a href="#L-438"><span class="linenos">438</span></a><span class="sd">        ### Args</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos">439</span></a><span class="sd">        - **output_filepath** (`Path`): Path to the output CSV file.</span>
</span><span id="L-440"><a href="#L-440"><span class="linenos">440</span></a><span class="sd">        - **extractor_output_filepath** (`Path`): Path to the YAML metadata file.</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos">441</span></a><span class="sd">        - **duration** (`int`): Duration of the extraction process in seconds.</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos">442</span></a><span class="sd">        - **source_configs** (`List[Dict[str, Any]]`): Configuration for each data source.</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos">443</span></a><span class="sd">        - **logger**: Optional logger instance for logging messages.</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos">444</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages.</span>
</span><span id="L-445"><a href="#L-445"><span class="linenos">445</span></a>
</span><span id="L-446"><a href="#L-446"><span class="linenos">446</span></a><span class="sd">        ### Notes</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos">447</span></a><span class="sd">        - Each data source runs in its own thread and pushes metrics to a shared queue.</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos">448</span></a><span class="sd">        - The process ignores `SIGINT` to prevent interruption via keyboard.</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos">449</span></a><span class="sd">        - Graceful termination is supported via `SIGTERM`.</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos">450</span></a><span class="sd">        - Metadata including the stop time is appended to the YAML file after extraction ends.</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos">451</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos">452</span></a>       
</span><span id="L-453"><a href="#L-453"><span class="linenos">453</span></a>        <span class="c1"># Ignore SIGINT to prevent interruption from keyboard</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos">454</span></a>        <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIG_IGN</span><span class="p">)</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos">455</span></a>
</span><span id="L-456"><a href="#L-456"><span class="linenos">456</span></a>        <span class="c1"># Graceful termination handler</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos">457</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">handle_signal</span><span class="p">(</span><span class="n">signum</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
</span><span id="L-458"><a href="#L-458"><span class="linenos">458</span></a>            <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos">459</span></a>
</span><span id="L-460"><a href="#L-460"><span class="linenos">460</span></a>        <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGTERM</span><span class="p">,</span> <span class="n">handle_signal</span><span class="p">)</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos">461</span></a>
</span><span id="L-462"><a href="#L-462"><span class="linenos">462</span></a>        <span class="c1"># Shared event and queue for thread coordination</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos">463</span></a>        <span class="n">event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos">464</span></a>        <span class="n">q</span><span class="p">:</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos">465</span></a>
</span><span id="L-466"><a href="#L-466"><span class="linenos">466</span></a>        <span class="n">sources</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos">467</span></a>        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">source_configs</span><span class="p">:</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos">468</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos">469</span></a>                <span class="c1"># Instantiate and start each data source thread</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos">470</span></a>                <span class="n">source_class</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span>
</span><span id="L-471"><a href="#L-471"><span class="linenos">471</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos">472</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
</span><span id="L-473"><a href="#L-473"><span class="linenos">473</span></a>                <span class="n">source</span> <span class="o">=</span> <span class="n">source_class</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="L-474"><a href="#L-474"><span class="linenos">474</span></a>                <span class="n">source</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos">475</span></a>                <span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos">476</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos">477</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos">478</span></a>                    <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos">479</span></a>                    <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">] Error starting source: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos">480</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="L-481"><a href="#L-481"><span class="linenos">481</span></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos">482</span></a>                <span class="p">)</span>
</span><span id="L-483"><a href="#L-483"><span class="linenos">483</span></a>
</span><span id="L-484"><a href="#L-484"><span class="linenos">484</span></a>        <span class="c1"># Open CSV file and write header</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos">485</span></a>        <span class="k">with</span> <span class="n">output_filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos">486</span></a>            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos">487</span></a>            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;metric&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">])</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos">488</span></a>
</span><span id="L-489"><a href="#L-489"><span class="linenos">489</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="L-490"><a href="#L-490"><span class="linenos">490</span></a>                <span class="c1"># Collect data until duration expires or event is triggered</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos">491</span></a>                <span class="n">t_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">duration</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos">492</span></a>                <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">t_end</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos">493</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos">494</span></a>                        <span class="n">timestamp</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-495"><a href="#L-495"><span class="linenos">495</span></a>                        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">])</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos">496</span></a>                    <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos">497</span></a>                        <span class="k">continue</span>  <span class="c1"># No data available, continue waiting</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos">498</span></a>            <span class="k">finally</span><span class="p">:</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos">499</span></a>                <span class="c1"># Signal all threads to stop</span>
</span><span id="L-500"><a href="#L-500"><span class="linenos">500</span></a>                <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos">501</span></a>                <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos">502</span></a>                    <span class="n">source</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos">503</span></a>
</span><span id="L-504"><a href="#L-504"><span class="linenos">504</span></a>                <span class="c1"># Record stop time and append to YAML metadata</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos">505</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stop_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos">506</span></a>                <span class="n">stop_time_hr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_time</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y %H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos">507</span></a>
</span><span id="L-508"><a href="#L-508"><span class="linenos">508</span></a>                <span class="n">extractor_output</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos">509</span></a>                    <span class="s2">&quot;finished_at&quot;</span><span class="p">:</span> <span class="n">stop_time_hr</span><span class="p">,</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos">510</span></a>                <span class="p">}</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos">511</span></a>                <span class="k">with</span> <span class="n">extractor_output_filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos">512</span></a>                    <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">extractor_output</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos">513</span></a>
</span><span id="L-514"><a href="#L-514"><span class="linenos">514</span></a>
</span><span id="L-515"><a href="#L-515"><span class="linenos">515</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos">516</span></a><span class="c1"># 📌 Function: stop_extraction</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos">517</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos">518</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_extraction</span><span class="p">(</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos">519</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos">520</span></a>        <span class="n">preconfirmation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="L-521"><a href="#L-521"><span class="linenos">521</span></a>        <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="L-522"><a href="#L-522"><span class="linenos">522</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos">523</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos">524</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos">525</span></a><span class="sd">        Forcefully stops the active data extraction process and resets session metadata.</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos">526</span></a>
</span><span id="L-527"><a href="#L-527"><span class="linenos">527</span></a><span class="sd">        If the writer process is running, this method optionally prompts the user for confirmation,</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos">528</span></a><span class="sd">        terminates the process, and clears output-related session variables.</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos">529</span></a>
</span><span id="L-530"><a href="#L-530"><span class="linenos">530</span></a><span class="sd">        ### Args:</span>
</span><span id="L-531"><a href="#L-531"><span class="linenos">531</span></a><span class="sd">        - **preconfirmation** (`Optional[bool]`): If `True`, skips the confirmation prompt. Defaults to `False`.</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos">532</span></a><span class="sd">        - **logger**: Logger instance used for logging messages. Defaults to `None`.</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos">533</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages. Defaults to `0`.</span>
</span><span id="L-534"><a href="#L-534"><span class="linenos">534</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos">535</span></a>
</span><span id="L-536"><a href="#L-536"><span class="linenos">536</span></a>
</span><span id="L-537"><a href="#L-537"><span class="linenos">537</span></a>        <span class="c1"># Display section title</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos">538</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Stopping extraction&quot;</span><span class="p">,</span> <span class="s2">&quot;🛑&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos">539</span></a>
</span><span id="L-540"><a href="#L-540"><span class="linenos">540</span></a>        <span class="c1"># Check if the writer process is running</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos">541</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos">542</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;No Data Extractor running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos">543</span></a>            <span class="k">return</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos">544</span></a>
</span><span id="L-545"><a href="#L-545"><span class="linenos">545</span></a>        <span class="c1"># Ask user for confirmation before terminating the process</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos">546</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">preconfirmation</span><span class="p">:</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos">547</span></a>            <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Confirm</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⚠️ Are you sure you want to forcefully stop the extraction process?&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos">548</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos">549</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Stop operation cancelled.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-550"><a href="#L-550"><span class="linenos">550</span></a>                <span class="k">return</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos">551</span></a>
</span><span id="L-552"><a href="#L-552"><span class="linenos">552</span></a>        <span class="c1"># Terminate the writer process if still alive</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos">553</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos">554</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="s2">&quot;Terminating writer process...&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-555"><a href="#L-555"><span class="linenos">555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos">556</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos">557</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Writer process forcefully terminated.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos">558</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos">559</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Writer process is not running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos">560</span></a>
</span><span id="L-561"><a href="#L-561"><span class="linenos">561</span></a>        <span class="c1"># Reset extraction session state</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos">562</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos">565</span></a>
</span><span id="L-566"><a href="#L-566"><span class="linenos">566</span></a>
</span><span id="L-567"><a href="#L-567"><span class="linenos">567</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos">568</span></a><span class="c1"># 📌 Function: show_progress</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos">569</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos">570</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">show_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos">571</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos">572</span></a><span class="sd">        Displays a real-time progress indicator for the ongoing data extraction process.</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos">573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos">574</span></a><span class="sd">        If the writer process is active, this method uses the view tools to render a progress bar</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos">575</span></a><span class="sd">        based on the elapsed time since the extraction started.</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos">576</span></a>
</span><span id="L-577"><a href="#L-577"><span class="linenos">577</span></a><span class="sd">        Console messages are shown if no extraction process is currently running.</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos">578</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos">579</span></a>
</span><span id="L-580"><a href="#L-580"><span class="linenos">580</span></a>        <span class="c1"># Display section title</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos">581</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Showing progress&quot;</span><span class="p">,</span> <span class="s2">&quot;⏳&quot;</span><span class="p">)</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos">582</span></a>
</span><span id="L-583"><a href="#L-583"><span class="linenos">583</span></a>        <span class="c1"># Check if extraction is active</span>
</span><span id="L-584"><a href="#L-584"><span class="linenos">584</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos">585</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No data extraction was started.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-586"><a href="#L-586"><span class="linenos">586</span></a>            <span class="k">return</span>
</span><span id="L-587"><a href="#L-587"><span class="linenos">587</span></a>
</span><span id="L-588"><a href="#L-588"><span class="linenos">588</span></a>        <span class="c1"># Show real-time progress bar</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos">589</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">real_time_progress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="s2">&quot;⏳ Extracting data...&quot;</span><span class="p">)</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos">590</span></a>
</span><span id="L-591"><a href="#L-591"><span class="linenos">591</span></a>
</span><span id="L-592"><a href="#L-592"><span class="linenos">592</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos">593</span></a><span class="c1"># 📌 Function: show_extracted_data</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos">594</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos">595</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">show_extracted_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-596"><a href="#L-596"><span class="linenos">596</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos">597</span></a><span class="sd">        Streams the real-time log output of the data extraction process to the console.</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos">598</span></a>
</span><span id="L-599"><a href="#L-599"><span class="linenos">599</span></a><span class="sd">        If the writer process is active, this method uses the view tools to display the contents</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos">600</span></a><span class="sd">        of the output log file. Otherwise, it notifies the user that no process is running.</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos">601</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos">602</span></a>
</span><span id="L-603"><a href="#L-603"><span class="linenos">603</span></a>        <span class="c1"># Check if extraction is active</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos">604</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos">605</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No data extraction was started.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos">606</span></a>            <span class="k">return</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos">607</span></a>
</span><span id="L-608"><a href="#L-608"><span class="linenos">608</span></a>        <span class="c1"># Stream the real-time log output</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos">609</span></a>        <span class="n">log_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span> <span class="k">else</span> <span class="n">Path</span><span class="p">()</span>
</span><span id="L-610"><a href="#L-610"><span class="linenos">610</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">real_time_log</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos">611</span></a>
</span><span id="L-612"><a href="#L-612"><span class="linenos">612</span></a>
</span><span id="L-613"><a href="#L-613"><span class="linenos">613</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos">614</span></a><span class="c1"># 📌 Function: exit</span>
</span><span id="L-615"><a href="#L-615"><span class="linenos">615</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos">616</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos">617</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos">618</span></a><span class="sd">        Exits the TUI menu and performs cleanup operations.</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos">619</span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos">620</span></a><span class="sd">        This method is intended to be called when the user chooses to exit the interface.</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos">621</span></a><span class="sd">        It stops any active data extraction process and releases associated resources.</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos">622</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos">623</span></a>  
</span><span id="L-624"><a href="#L-624"><span class="linenos">624</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stop_extraction</span><span class="p">()</span>
</span></pre></div>


            </section>
                <section id="DataExtractorTool">
                            <input id="DataExtractorTool-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">DataExtractorTool</span>:

                <label class="view-source-button" for="DataExtractorTool-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataExtractorTool"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataExtractorTool-42"><a href="#DataExtractorTool-42"><span class="linenos"> 42</span></a><span class="k">class</span><span class="w"> </span><span class="nc">DataExtractorTool</span><span class="p">:</span>
</span><span id="DataExtractorTool-43"><a href="#DataExtractorTool-43"><span class="linenos"> 43</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-44"><a href="#DataExtractorTool-44"><span class="linenos"> 44</span></a><span class="sd">    Tool for extracting data from configured sources and managing output files.</span>
</span><span id="DataExtractorTool-45"><a href="#DataExtractorTool-45"><span class="linenos"> 45</span></a>
</span><span id="DataExtractorTool-46"><a href="#DataExtractorTool-46"><span class="linenos"> 46</span></a><span class="sd">    ### Attributes</span>
</span><span id="DataExtractorTool-47"><a href="#DataExtractorTool-47"><span class="linenos"> 47</span></a><span class="sd">    - **vt** (`utils.ViewTools`): Utility tools for view-related operations.</span>
</span><span id="DataExtractorTool-48"><a href="#DataExtractorTool-48"><span class="linenos"> 48</span></a><span class="sd">    - **output_dir** (`Path`): Directory where output files will be stored.</span>
</span><span id="DataExtractorTool-49"><a href="#DataExtractorTool-49"><span class="linenos"> 49</span></a><span class="sd">    - **loaded_datasources** (`List[dsources.DataSource]`): List of data sources that have been loaded.</span>
</span><span id="DataExtractorTool-50"><a href="#DataExtractorTool-50"><span class="linenos"> 50</span></a><span class="sd">    - **writer_process** (`multiprocessing.Process`): Background process responsible for writing output.</span>
</span><span id="DataExtractorTool-51"><a href="#DataExtractorTool-51"><span class="linenos"> 51</span></a><span class="sd">    - **output_filepath** (`Optional[Path]`): Path to the output file, if available.</span>
</span><span id="DataExtractorTool-52"><a href="#DataExtractorTool-52"><span class="linenos"> 52</span></a><span class="sd">    - **start_time** (`Optional[float]`): Timestamp marking the start of the extraction process.</span>
</span><span id="DataExtractorTool-53"><a href="#DataExtractorTool-53"><span class="linenos"> 53</span></a><span class="sd">    - **duration** (`Optional[int]`): Duration of the extraction process in seconds.</span>
</span><span id="DataExtractorTool-54"><a href="#DataExtractorTool-54"><span class="linenos"> 54</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-55"><a href="#DataExtractorTool-55"><span class="linenos"> 55</span></a>
</span><span id="DataExtractorTool-56"><a href="#DataExtractorTool-56"><span class="linenos"> 56</span></a>    <span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-57"><a href="#DataExtractorTool-57"><span class="linenos"> 57</span></a>    <span class="c1"># 🚧 Constructor</span>
</span><span id="DataExtractorTool-58"><a href="#DataExtractorTool-58"><span class="linenos"> 58</span></a>    <span class="c1"># ─────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-59"><a href="#DataExtractorTool-59"><span class="linenos"> 59</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-60"><a href="#DataExtractorTool-60"><span class="linenos"> 60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-61"><a href="#DataExtractorTool-61"><span class="linenos"> 61</span></a><span class="sd">        Initialize a new instance of `DataExtractorTool` with default paths and metadata.</span>
</span><span id="DataExtractorTool-62"><a href="#DataExtractorTool-62"><span class="linenos"> 62</span></a>
</span><span id="DataExtractorTool-63"><a href="#DataExtractorTool-63"><span class="linenos"> 63</span></a><span class="sd">        ### Args</span>
</span><span id="DataExtractorTool-64"><a href="#DataExtractorTool-64"><span class="linenos"> 64</span></a><span class="sd">        - **vt** (`utils.ViewTools`): Utility tools for view-related operations.</span>
</span><span id="DataExtractorTool-65"><a href="#DataExtractorTool-65"><span class="linenos"> 65</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-66"><a href="#DataExtractorTool-66"><span class="linenos"> 66</span></a>
</span><span id="DataExtractorTool-67"><a href="#DataExtractorTool-67"><span class="linenos"> 67</span></a>        <span class="c1"># Store the view tools instance</span>
</span><span id="DataExtractorTool-68"><a href="#DataExtractorTool-68"><span class="linenos"> 68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span> <span class="o">=</span> <span class="n">vt</span>
</span><span id="DataExtractorTool-69"><a href="#DataExtractorTool-69"><span class="linenos"> 69</span></a>
</span><span id="DataExtractorTool-70"><a href="#DataExtractorTool-70"><span class="linenos"> 70</span></a>        <span class="c1"># Define configuration and output directories using pathlib</span>
</span><span id="DataExtractorTool-71"><a href="#DataExtractorTool-71"><span class="linenos"> 71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;suite&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span>
</span><span id="DataExtractorTool-72"><a href="#DataExtractorTool-72"><span class="linenos"> 72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-73"><a href="#DataExtractorTool-73"><span class="linenos"> 73</span></a>
</span><span id="DataExtractorTool-74"><a href="#DataExtractorTool-74"><span class="linenos"> 74</span></a>        <span class="c1"># Initialize the list of loaded data sources</span>
</span><span id="DataExtractorTool-75"><a href="#DataExtractorTool-75"><span class="linenos"> 75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dsources</span><span class="o">.</span><span class="n">DataSource</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DataExtractorTool-76"><a href="#DataExtractorTool-76"><span class="linenos"> 76</span></a>
</span><span id="DataExtractorTool-77"><a href="#DataExtractorTool-77"><span class="linenos"> 77</span></a>        <span class="c1"># Prepare the writer process (not started yet)</span>
</span><span id="DataExtractorTool-78"><a href="#DataExtractorTool-78"><span class="linenos"> 78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
</span><span id="DataExtractorTool-79"><a href="#DataExtractorTool-79"><span class="linenos"> 79</span></a>
</span><span id="DataExtractorTool-80"><a href="#DataExtractorTool-80"><span class="linenos"> 80</span></a>        <span class="c1"># Initialize metadata for output tracking</span>
</span><span id="DataExtractorTool-81"><a href="#DataExtractorTool-81"><span class="linenos"> 81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DataExtractorTool-82"><a href="#DataExtractorTool-82"><span class="linenos"> 82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DataExtractorTool-83"><a href="#DataExtractorTool-83"><span class="linenos"> 83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DataExtractorTool-84"><a href="#DataExtractorTool-84"><span class="linenos"> 84</span></a>
</span><span id="DataExtractorTool-85"><a href="#DataExtractorTool-85"><span class="linenos"> 85</span></a>
</span><span id="DataExtractorTool-86"><a href="#DataExtractorTool-86"><span class="linenos"> 86</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-87"><a href="#DataExtractorTool-87"><span class="linenos"> 87</span></a><span class="c1"># 📋 Function: main_menu</span>
</span><span id="DataExtractorTool-88"><a href="#DataExtractorTool-88"><span class="linenos"> 88</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-89"><a href="#DataExtractorTool-89"><span class="linenos"> 89</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">main_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-90"><a href="#DataExtractorTool-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-91"><a href="#DataExtractorTool-91"><span class="linenos"> 91</span></a><span class="sd">        Render and manage the interactive terminal-based main menu for data extraction.</span>
</span><span id="DataExtractorTool-92"><a href="#DataExtractorTool-92"><span class="linenos"> 92</span></a>
</span><span id="DataExtractorTool-93"><a href="#DataExtractorTool-93"><span class="linenos"> 93</span></a><span class="sd">        Continuously displays a menu using InquirerPy, allowing the user to:</span>
</span><span id="DataExtractorTool-94"><a href="#DataExtractorTool-94"><span class="linenos"> 94</span></a><span class="sd">        - Load data sources</span>
</span><span id="DataExtractorTool-95"><a href="#DataExtractorTool-95"><span class="linenos"> 95</span></a><span class="sd">        - Start or stop the extractor</span>
</span><span id="DataExtractorTool-96"><a href="#DataExtractorTool-96"><span class="linenos"> 96</span></a><span class="sd">        - View progress and extracted data</span>
</span><span id="DataExtractorTool-97"><a href="#DataExtractorTool-97"><span class="linenos"> 97</span></a><span class="sd">        - Refresh the view</span>
</span><span id="DataExtractorTool-98"><a href="#DataExtractorTool-98"><span class="linenos"> 98</span></a><span class="sd">        - Exit the tool</span>
</span><span id="DataExtractorTool-99"><a href="#DataExtractorTool-99"><span class="linenos"> 99</span></a>
</span><span id="DataExtractorTool-100"><a href="#DataExtractorTool-100"><span class="linenos">100</span></a><span class="sd">        The loop runs until the user selects **&quot;❌ Exit&quot;** or interrupts the process with **Ctrl+C**.</span>
</span><span id="DataExtractorTool-101"><a href="#DataExtractorTool-101"><span class="linenos">101</span></a>
</span><span id="DataExtractorTool-102"><a href="#DataExtractorTool-102"><span class="linenos">102</span></a><span class="sd">        ### Menu Options</span>
</span><span id="DataExtractorTool-103"><a href="#DataExtractorTool-103"><span class="linenos">103</span></a><span class="sd">        - 🛢️ Load Data Sources → `load_datasources`</span>
</span><span id="DataExtractorTool-104"><a href="#DataExtractorTool-104"><span class="linenos">104</span></a><span class="sd">        - 📈 Start Extractor → `start_extraction`</span>
</span><span id="DataExtractorTool-105"><a href="#DataExtractorTool-105"><span class="linenos">105</span></a><span class="sd">        - 🛑 Stop Extractor → `stop_extraction`</span>
</span><span id="DataExtractorTool-106"><a href="#DataExtractorTool-106"><span class="linenos">106</span></a><span class="sd">        - ⏳ Show Progress → `show_progress`</span>
</span><span id="DataExtractorTool-107"><a href="#DataExtractorTool-107"><span class="linenos">107</span></a><span class="sd">        - 📄 Show Extracted Data → `show_extracted_data`</span>
</span><span id="DataExtractorTool-108"><a href="#DataExtractorTool-108"><span class="linenos">108</span></a><span class="sd">        - 🔄 Refresh View → no action</span>
</span><span id="DataExtractorTool-109"><a href="#DataExtractorTool-109"><span class="linenos">109</span></a><span class="sd">        - ❌ Exit → terminates the menu loop</span>
</span><span id="DataExtractorTool-110"><a href="#DataExtractorTool-110"><span class="linenos">110</span></a>
</span><span id="DataExtractorTool-111"><a href="#DataExtractorTool-111"><span class="linenos">111</span></a><span class="sd">        ### Notes</span>
</span><span id="DataExtractorTool-112"><a href="#DataExtractorTool-112"><span class="linenos">112</span></a><span class="sd">        - Graceful termination is supported via **Ctrl+C**.</span>
</span><span id="DataExtractorTool-113"><a href="#DataExtractorTool-113"><span class="linenos">113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-114"><a href="#DataExtractorTool-114"><span class="linenos">114</span></a>
</span><span id="DataExtractorTool-115"><a href="#DataExtractorTool-115"><span class="linenos">115</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool-116"><a href="#DataExtractorTool-116"><span class="linenos">116</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="DataExtractorTool-117"><a href="#DataExtractorTool-117"><span class="linenos">117</span></a>                <span class="c1"># Show software title without delay</span>
</span><span id="DataExtractorTool-118"><a href="#DataExtractorTool-118"><span class="linenos">118</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_software_title</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DataExtractorTool-119"><a href="#DataExtractorTool-119"><span class="linenos">119</span></a>
</span><span id="DataExtractorTool-120"><a href="#DataExtractorTool-120"><span class="linenos">120</span></a>                <span class="c1"># Display the main menu title</span>
</span><span id="DataExtractorTool-121"><a href="#DataExtractorTool-121"><span class="linenos">121</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;main_title&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Extractor Tool Menu&quot;</span><span class="p">,</span> <span class="s2">&quot;📈&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-122"><a href="#DataExtractorTool-122"><span class="linenos">122</span></a>
</span><span id="DataExtractorTool-123"><a href="#DataExtractorTool-123"><span class="linenos">123</span></a>                <span class="c1"># Show the most recent metric</span>
</span><span id="DataExtractorTool-124"><a href="#DataExtractorTool-124"><span class="linenos">124</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_last_metric</span><span class="p">()</span>
</span><span id="DataExtractorTool-125"><a href="#DataExtractorTool-125"><span class="linenos">125</span></a>
</span><span id="DataExtractorTool-126"><a href="#DataExtractorTool-126"><span class="linenos">126</span></a>                <span class="c1"># Display loaded data sources</span>
</span><span id="DataExtractorTool-127"><a href="#DataExtractorTool-127"><span class="linenos">127</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_datasources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">)</span>
</span><span id="DataExtractorTool-128"><a href="#DataExtractorTool-128"><span class="linenos">128</span></a>
</span><span id="DataExtractorTool-129"><a href="#DataExtractorTool-129"><span class="linenos">129</span></a>                <span class="c1"># Show extractor status and output information</span>
</span><span id="DataExtractorTool-130"><a href="#DataExtractorTool-130"><span class="linenos">130</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_data_extractor</span><span class="p">(</span>
</span><span id="DataExtractorTool-131"><a href="#DataExtractorTool-131"><span class="linenos">131</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="p">,</span>
</span><span id="DataExtractorTool-132"><a href="#DataExtractorTool-132"><span class="linenos">132</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">,</span>
</span><span id="DataExtractorTool-133"><a href="#DataExtractorTool-133"><span class="linenos">133</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span><span class="p">,</span>
</span><span id="DataExtractorTool-134"><a href="#DataExtractorTool-134"><span class="linenos">134</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span>
</span><span id="DataExtractorTool-135"><a href="#DataExtractorTool-135"><span class="linenos">135</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
</span><span id="DataExtractorTool-136"><a href="#DataExtractorTool-136"><span class="linenos">136</span></a>                <span class="p">)</span>
</span><span id="DataExtractorTool-137"><a href="#DataExtractorTool-137"><span class="linenos">137</span></a>
</span><span id="DataExtractorTool-138"><a href="#DataExtractorTool-138"><span class="linenos">138</span></a>                <span class="c1"># Present interactive menu options</span>
</span><span id="DataExtractorTool-139"><a href="#DataExtractorTool-139"><span class="linenos">139</span></a>                <span class="n">choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="DataExtractorTool-140"><a href="#DataExtractorTool-140"><span class="linenos">140</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="p">[</span>
</span><span id="DataExtractorTool-141"><a href="#DataExtractorTool-141"><span class="linenos">141</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🛢️ Load Data Sources&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;load_datasources&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool-142"><a href="#DataExtractorTool-142"><span class="linenos">142</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📈 Start Extractor&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;start_extraction&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool-143"><a href="#DataExtractorTool-143"><span class="linenos">143</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🛑 Stop Extractor&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;stop_extraction&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool-144"><a href="#DataExtractorTool-144"><span class="linenos">144</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;⏳ Show Progress&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;show_progress&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool-145"><a href="#DataExtractorTool-145"><span class="linenos">145</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📄 Show Extracted Data&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;show_extracted_data&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool-146"><a href="#DataExtractorTool-146"><span class="linenos">146</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🔄 Refresh view&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool-147"><a href="#DataExtractorTool-147"><span class="linenos">147</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;❌ Exit&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;exit&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool-148"><a href="#DataExtractorTool-148"><span class="linenos">148</span></a>                    <span class="p">],</span>
</span><span id="DataExtractorTool-149"><a href="#DataExtractorTool-149"><span class="linenos">149</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="DataExtractorTool-150"><a href="#DataExtractorTool-150"><span class="linenos">150</span></a>                <span class="p">)</span>
</span><span id="DataExtractorTool-151"><a href="#DataExtractorTool-151"><span class="linenos">151</span></a>
</span><span id="DataExtractorTool-152"><a href="#DataExtractorTool-152"><span class="linenos">152</span></a>                <span class="c1"># Map menu options to corresponding methods</span>
</span><span id="DataExtractorTool-153"><a href="#DataExtractorTool-153"><span class="linenos">153</span></a>                <span class="n">submenu</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DataExtractorTool-154"><a href="#DataExtractorTool-154"><span class="linenos">154</span></a>                    <span class="s2">&quot;load_datasources&quot;</span><span class="p">:</span>     <span class="bp">self</span><span class="o">.</span><span class="n">load_datasources</span><span class="p">,</span>
</span><span id="DataExtractorTool-155"><a href="#DataExtractorTool-155"><span class="linenos">155</span></a>                    <span class="s2">&quot;start_extraction&quot;</span><span class="p">:</span>     <span class="bp">self</span><span class="o">.</span><span class="n">start_extraction</span><span class="p">,</span>
</span><span id="DataExtractorTool-156"><a href="#DataExtractorTool-156"><span class="linenos">156</span></a>                    <span class="s2">&quot;stop_extraction&quot;</span><span class="p">:</span>      <span class="bp">self</span><span class="o">.</span><span class="n">stop_extraction</span><span class="p">,</span>
</span><span id="DataExtractorTool-157"><a href="#DataExtractorTool-157"><span class="linenos">157</span></a>                    <span class="s2">&quot;show_progress&quot;</span><span class="p">:</span>        <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="DataExtractorTool-158"><a href="#DataExtractorTool-158"><span class="linenos">158</span></a>                    <span class="s2">&quot;show_extracted_data&quot;</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">show_extracted_data</span><span class="p">,</span>
</span><span id="DataExtractorTool-159"><a href="#DataExtractorTool-159"><span class="linenos">159</span></a>                <span class="p">}</span>
</span><span id="DataExtractorTool-160"><a href="#DataExtractorTool-160"><span class="linenos">160</span></a>
</span><span id="DataExtractorTool-161"><a href="#DataExtractorTool-161"><span class="linenos">161</span></a>                <span class="c1"># Handle user selection</span>
</span><span id="DataExtractorTool-162"><a href="#DataExtractorTool-162"><span class="linenos">162</span></a>                <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;exit&quot;</span><span class="p">:</span>
</span><span id="DataExtractorTool-163"><a href="#DataExtractorTool-163"><span class="linenos">163</span></a>                    <span class="k">break</span>
</span><span id="DataExtractorTool-164"><a href="#DataExtractorTool-164"><span class="linenos">164</span></a>                <span class="k">elif</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">:</span>
</span><span id="DataExtractorTool-165"><a href="#DataExtractorTool-165"><span class="linenos">165</span></a>                    <span class="n">action</span> <span class="o">=</span> <span class="n">submenu</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
</span><span id="DataExtractorTool-166"><a href="#DataExtractorTool-166"><span class="linenos">166</span></a>                    <span class="k">if</span> <span class="n">action</span><span class="p">:</span>
</span><span id="DataExtractorTool-167"><a href="#DataExtractorTool-167"><span class="linenos">167</span></a>                        <span class="n">action</span><span class="p">()</span>
</span><span id="DataExtractorTool-168"><a href="#DataExtractorTool-168"><span class="linenos">168</span></a>                        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🔙 Press ⏎ to return to the menu...&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-169"><a href="#DataExtractorTool-169"><span class="linenos">169</span></a>
</span><span id="DataExtractorTool-170"><a href="#DataExtractorTool-170"><span class="linenos">170</span></a>        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="DataExtractorTool-171"><a href="#DataExtractorTool-171"><span class="linenos">171</span></a>            <span class="c1"># Gracefully handle Ctrl+C interruption</span>
</span><span id="DataExtractorTool-172"><a href="#DataExtractorTool-172"><span class="linenos">172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;Exiting...&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-173"><a href="#DataExtractorTool-173"><span class="linenos">173</span></a>
</span><span id="DataExtractorTool-174"><a href="#DataExtractorTool-174"><span class="linenos">174</span></a>
</span><span id="DataExtractorTool-175"><a href="#DataExtractorTool-175"><span class="linenos">175</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-176"><a href="#DataExtractorTool-176"><span class="linenos">176</span></a><span class="c1"># 📌 Function: load_datasources</span>
</span><span id="DataExtractorTool-177"><a href="#DataExtractorTool-177"><span class="linenos">177</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-178"><a href="#DataExtractorTool-178"><span class="linenos">178</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_datasources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_cfg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-179"><a href="#DataExtractorTool-179"><span class="linenos">179</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-180"><a href="#DataExtractorTool-180"><span class="linenos">180</span></a><span class="sd">        Load and configure data sources from a YAML configuration file.</span>
</span><span id="DataExtractorTool-181"><a href="#DataExtractorTool-181"><span class="linenos">181</span></a>
</span><span id="DataExtractorTool-182"><a href="#DataExtractorTool-182"><span class="linenos">182</span></a><span class="sd">        Clears any previously loaded sources and parses the selected configuration file,</span>
</span><span id="DataExtractorTool-183"><a href="#DataExtractorTool-183"><span class="linenos">183</span></a><span class="sd">        instantiating the appropriate data source classes. If no file is provided, the user</span>
</span><span id="DataExtractorTool-184"><a href="#DataExtractorTool-184"><span class="linenos">184</span></a><span class="sd">        is prompted to select one interactively from the available files in the config directory.</span>
</span><span id="DataExtractorTool-185"><a href="#DataExtractorTool-185"><span class="linenos">185</span></a>
</span><span id="DataExtractorTool-186"><a href="#DataExtractorTool-186"><span class="linenos">186</span></a><span class="sd">        ### Args</span>
</span><span id="DataExtractorTool-187"><a href="#DataExtractorTool-187"><span class="linenos">187</span></a><span class="sd">        - **file_cfg** (`Optional[str]`): Path to the YAML configuration file. If `None`, prompts the user to select one.</span>
</span><span id="DataExtractorTool-188"><a href="#DataExtractorTool-188"><span class="linenos">188</span></a><span class="sd">        - **quiet** (`bool`): If `True`, suppresses console output messages.</span>
</span><span id="DataExtractorTool-189"><a href="#DataExtractorTool-189"><span class="linenos">189</span></a>
</span><span id="DataExtractorTool-190"><a href="#DataExtractorTool-190"><span class="linenos">190</span></a><span class="sd">        ### Notes</span>
</span><span id="DataExtractorTool-191"><a href="#DataExtractorTool-191"><span class="linenos">191</span></a><span class="sd">        - Prevents loading if the extractor process is currently running.</span>
</span><span id="DataExtractorTool-192"><a href="#DataExtractorTool-192"><span class="linenos">192</span></a><span class="sd">        - Supports graceful cancellation via **Ctrl+C**.</span>
</span><span id="DataExtractorTool-193"><a href="#DataExtractorTool-193"><span class="linenos">193</span></a><span class="sd">        - Automatically creates missing log files if required by a `FileLogDataSource`.</span>
</span><span id="DataExtractorTool-194"><a href="#DataExtractorTool-194"><span class="linenos">194</span></a><span class="sd">        - Displays success or error messages for each data source loaded.</span>
</span><span id="DataExtractorTool-195"><a href="#DataExtractorTool-195"><span class="linenos">195</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-196"><a href="#DataExtractorTool-196"><span class="linenos">196</span></a>
</span><span id="DataExtractorTool-197"><a href="#DataExtractorTool-197"><span class="linenos">197</span></a>
</span><span id="DataExtractorTool-198"><a href="#DataExtractorTool-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Sources Configuration&quot;</span><span class="p">,</span> <span class="s2">&quot;🛢️&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-199"><a href="#DataExtractorTool-199"><span class="linenos">199</span></a>
</span><span id="DataExtractorTool-200"><a href="#DataExtractorTool-200"><span class="linenos">200</span></a>        <span class="c1"># Prevent loading if extractor is running</span>
</span><span id="DataExtractorTool-201"><a href="#DataExtractorTool-201"><span class="linenos">201</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool-202"><a href="#DataExtractorTool-202"><span class="linenos">202</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Data extractor is running already.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-203"><a href="#DataExtractorTool-203"><span class="linenos">203</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool-204"><a href="#DataExtractorTool-204"><span class="linenos">204</span></a>
</span><span id="DataExtractorTool-205"><a href="#DataExtractorTool-205"><span class="linenos">205</span></a>        <span class="c1"># Clear previously loaded data sources</span>
</span><span id="DataExtractorTool-206"><a href="#DataExtractorTool-206"><span class="linenos">206</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span>
</span><span id="DataExtractorTool-207"><a href="#DataExtractorTool-207"><span class="linenos">207</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="s2">&quot;Deleting previous data sources.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-208"><a href="#DataExtractorTool-208"><span class="linenos">208</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DataExtractorTool-209"><a href="#DataExtractorTool-209"><span class="linenos">209</span></a>
</span><span id="DataExtractorTool-210"><a href="#DataExtractorTool-210"><span class="linenos">210</span></a>        <span class="c1"># Determine configuration file path</span>
</span><span id="DataExtractorTool-211"><a href="#DataExtractorTool-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="n">file_cfg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-212"><a href="#DataExtractorTool-212"><span class="linenos">212</span></a>            <span class="n">config_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.yaml&quot;</span><span class="p">)]</span>
</span><span id="DataExtractorTool-213"><a href="#DataExtractorTool-213"><span class="linenos">213</span></a>
</span><span id="DataExtractorTool-214"><a href="#DataExtractorTool-214"><span class="linenos">214</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">config_files</span><span class="p">:</span>
</span><span id="DataExtractorTool-215"><a href="#DataExtractorTool-215"><span class="linenos">215</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No data sources files found in &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-216"><a href="#DataExtractorTool-216"><span class="linenos">216</span></a>                <span class="k">return</span>
</span><span id="DataExtractorTool-217"><a href="#DataExtractorTool-217"><span class="linenos">217</span></a>
</span><span id="DataExtractorTool-218"><a href="#DataExtractorTool-218"><span class="linenos">218</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool-219"><a href="#DataExtractorTool-219"><span class="linenos">219</span></a>                <span class="n">choices</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DataExtractorTool-220"><a href="#DataExtractorTool-220"><span class="linenos">220</span></a>                    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. 📄 </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span><span id="DataExtractorTool-221"><a href="#DataExtractorTool-221"><span class="linenos">221</span></a>                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">config_files</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-222"><a href="#DataExtractorTool-222"><span class="linenos">222</span></a>                <span class="p">]</span>
</span><span id="DataExtractorTool-223"><a href="#DataExtractorTool-223"><span class="linenos">223</span></a>
</span><span id="DataExtractorTool-224"><a href="#DataExtractorTool-224"><span class="linenos">224</span></a>                <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="DataExtractorTool-225"><a href="#DataExtractorTool-225"><span class="linenos">225</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
</span><span id="DataExtractorTool-226"><a href="#DataExtractorTool-226"><span class="linenos">226</span></a>                    <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Available Data Sources Files:&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool-227"><a href="#DataExtractorTool-227"><span class="linenos">227</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="DataExtractorTool-228"><a href="#DataExtractorTool-228"><span class="linenos">228</span></a>                <span class="p">)</span>
</span><span id="DataExtractorTool-229"><a href="#DataExtractorTool-229"><span class="linenos">229</span></a>
</span><span id="DataExtractorTool-230"><a href="#DataExtractorTool-230"><span class="linenos">230</span></a>                <span class="n">filepath_cfg</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">selected</span>
</span><span id="DataExtractorTool-231"><a href="#DataExtractorTool-231"><span class="linenos">231</span></a>
</span><span id="DataExtractorTool-232"><a href="#DataExtractorTool-232"><span class="linenos">232</span></a>            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="DataExtractorTool-233"><a href="#DataExtractorTool-233"><span class="linenos">233</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation cancelled by user.&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-234"><a href="#DataExtractorTool-234"><span class="linenos">234</span></a>                <span class="k">return</span>
</span><span id="DataExtractorTool-235"><a href="#DataExtractorTool-235"><span class="linenos">235</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DataExtractorTool-236"><a href="#DataExtractorTool-236"><span class="linenos">236</span></a>            <span class="n">filepath_cfg</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_cfg</span><span class="p">)</span>
</span><span id="DataExtractorTool-237"><a href="#DataExtractorTool-237"><span class="linenos">237</span></a>
</span><span id="DataExtractorTool-238"><a href="#DataExtractorTool-238"><span class="linenos">238</span></a>        <span class="c1"># Load YAML configuration</span>
</span><span id="DataExtractorTool-239"><a href="#DataExtractorTool-239"><span class="linenos">239</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath_cfg</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="DataExtractorTool-240"><a href="#DataExtractorTool-240"><span class="linenos">240</span></a>            <span class="n">yaml_data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="DataExtractorTool-241"><a href="#DataExtractorTool-241"><span class="linenos">241</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">yaml_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dext_datasources&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="DataExtractorTool-242"><a href="#DataExtractorTool-242"><span class="linenos">242</span></a>
</span><span id="DataExtractorTool-243"><a href="#DataExtractorTool-243"><span class="linenos">243</span></a>        <span class="c1"># Parse each data source entry</span>
</span><span id="DataExtractorTool-244"><a href="#DataExtractorTool-244"><span class="linenos">244</span></a>        <span class="k">for</span> <span class="n">source_name</span><span class="p">,</span> <span class="n">source_info</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DataExtractorTool-245"><a href="#DataExtractorTool-245"><span class="linenos">245</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool-246"><a href="#DataExtractorTool-246"><span class="linenos">246</span></a>                <span class="n">data_class</span> <span class="o">=</span> <span class="n">source_info</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;data_class&#39;</span><span class="p">)</span>
</span><span id="DataExtractorTool-247"><a href="#DataExtractorTool-247"><span class="linenos">247</span></a>
</span><span id="DataExtractorTool-248"><a href="#DataExtractorTool-248"><span class="linenos">248</span></a>                <span class="k">if</span> <span class="n">data_class</span> <span class="o">==</span> <span class="s1">&#39;FileLogDataSource&#39;</span><span class="p">:</span>
</span><span id="DataExtractorTool-249"><a href="#DataExtractorTool-249"><span class="linenos">249</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loading FileLogDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-250"><a href="#DataExtractorTool-250"><span class="linenos">250</span></a>
</span><span id="DataExtractorTool-251"><a href="#DataExtractorTool-251"><span class="linenos">251</span></a>                    <span class="n">log_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;filepath&quot;</span><span class="p">])</span>
</span><span id="DataExtractorTool-252"><a href="#DataExtractorTool-252"><span class="linenos">252</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">log_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="DataExtractorTool-253"><a href="#DataExtractorTool-253"><span class="linenos">253</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> 
</span><span id="DataExtractorTool-254"><a href="#DataExtractorTool-254"><span class="linenos">254</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Log file not found: </span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DataExtractorTool-255"><a href="#DataExtractorTool-255"><span class="linenos">255</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Creating log file: </span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DataExtractorTool-256"><a href="#DataExtractorTool-256"><span class="linenos">256</span></a>                        <span class="n">log_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DataExtractorTool-257"><a href="#DataExtractorTool-257"><span class="linenos">257</span></a>                        <span class="n">log_path</span><span class="o">.</span><span class="n">touch</span><span class="p">()</span>
</span><span id="DataExtractorTool-258"><a href="#DataExtractorTool-258"><span class="linenos">258</span></a>
</span><span id="DataExtractorTool-259"><a href="#DataExtractorTool-259"><span class="linenos">259</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="DataExtractorTool-260"><a href="#DataExtractorTool-260"><span class="linenos">260</span></a>                        <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">dsources</span><span class="o">.</span><span class="n">FileLogDataSource</span><span class="p">,</span>
</span><span id="DataExtractorTool-261"><a href="#DataExtractorTool-261"><span class="linenos">261</span></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">source_name</span><span class="p">,</span>
</span><span id="DataExtractorTool-262"><a href="#DataExtractorTool-262"><span class="linenos">262</span></a>                        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DataExtractorTool-263"><a href="#DataExtractorTool-263"><span class="linenos">263</span></a>                            <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;pattern&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool-264"><a href="#DataExtractorTool-264"><span class="linenos">264</span></a>                            <span class="s2">&quot;filepath&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>
</span><span id="DataExtractorTool-265"><a href="#DataExtractorTool-265"><span class="linenos">265</span></a>                        <span class="p">}</span>
</span><span id="DataExtractorTool-266"><a href="#DataExtractorTool-266"><span class="linenos">266</span></a>                    <span class="p">})</span>
</span><span id="DataExtractorTool-267"><a href="#DataExtractorTool-267"><span class="linenos">267</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loaded FileLogDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DataExtractorTool-268"><a href="#DataExtractorTool-268"><span class="linenos">268</span></a>
</span><span id="DataExtractorTool-269"><a href="#DataExtractorTool-269"><span class="linenos">269</span></a>                <span class="k">elif</span> <span class="n">data_class</span> <span class="o">==</span> <span class="s2">&quot;PPSAnalyzerDataSource&quot;</span><span class="p">:</span>
</span><span id="DataExtractorTool-270"><a href="#DataExtractorTool-270"><span class="linenos">270</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loading PPSAnalyzerDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-271"><a href="#DataExtractorTool-271"><span class="linenos">271</span></a>
</span><span id="DataExtractorTool-272"><a href="#DataExtractorTool-272"><span class="linenos">272</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="DataExtractorTool-273"><a href="#DataExtractorTool-273"><span class="linenos">273</span></a>                        <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">dsources</span><span class="o">.</span><span class="n">PPSAnalyzerDataSource</span><span class="p">,</span>
</span><span id="DataExtractorTool-274"><a href="#DataExtractorTool-274"><span class="linenos">274</span></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">source_name</span><span class="p">,</span>
</span><span id="DataExtractorTool-275"><a href="#DataExtractorTool-275"><span class="linenos">275</span></a>                        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DataExtractorTool-276"><a href="#DataExtractorTool-276"><span class="linenos">276</span></a>                            <span class="s2">&quot;serial_port&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;serial_port&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool-277"><a href="#DataExtractorTool-277"><span class="linenos">277</span></a>                            <span class="s2">&quot;pps_inputs&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;pps_inputs&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool-278"><a href="#DataExtractorTool-278"><span class="linenos">278</span></a>                            <span class="s2">&quot;cable_delays&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;cable_delays&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool-279"><a href="#DataExtractorTool-279"><span class="linenos">279</span></a>                        <span class="p">}</span>
</span><span id="DataExtractorTool-280"><a href="#DataExtractorTool-280"><span class="linenos">280</span></a>                    <span class="p">})</span>
</span><span id="DataExtractorTool-281"><a href="#DataExtractorTool-281"><span class="linenos">281</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loaded PPSAnalyzerDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DataExtractorTool-282"><a href="#DataExtractorTool-282"><span class="linenos">282</span></a>
</span><span id="DataExtractorTool-283"><a href="#DataExtractorTool-283"><span class="linenos">283</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="DataExtractorTool-284"><a href="#DataExtractorTool-284"><span class="linenos">284</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unknown Data Source: </span><span class="si">{</span><span class="n">data_class</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-285"><a href="#DataExtractorTool-285"><span class="linenos">285</span></a>
</span><span id="DataExtractorTool-286"><a href="#DataExtractorTool-286"><span class="linenos">286</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DataExtractorTool-287"><a href="#DataExtractorTool-287"><span class="linenos">287</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error loading </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">data_class</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-288"><a href="#DataExtractorTool-288"><span class="linenos">288</span></a>
</span><span id="DataExtractorTool-289"><a href="#DataExtractorTool-289"><span class="linenos">289</span></a>        <span class="c1"># Final confirmation</span>
</span><span id="DataExtractorTool-290"><a href="#DataExtractorTool-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span>
</span><span id="DataExtractorTool-291"><a href="#DataExtractorTool-291"><span class="linenos">291</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Data Sources successfully loaded from </span><span class="si">{</span><span class="n">filepath_cfg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-292"><a href="#DataExtractorTool-292"><span class="linenos">292</span></a>
</span><span id="DataExtractorTool-293"><a href="#DataExtractorTool-293"><span class="linenos">293</span></a>
</span><span id="DataExtractorTool-294"><a href="#DataExtractorTool-294"><span class="linenos">294</span></a>
</span><span id="DataExtractorTool-295"><a href="#DataExtractorTool-295"><span class="linenos">295</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-296"><a href="#DataExtractorTool-296"><span class="linenos">296</span></a><span class="c1"># 📌 Function: start_extraction</span>
</span><span id="DataExtractorTool-297"><a href="#DataExtractorTool-297"><span class="linenos">297</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-298"><a href="#DataExtractorTool-298"><span class="linenos">298</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">start_extraction</span><span class="p">(</span>
</span><span id="DataExtractorTool-299"><a href="#DataExtractorTool-299"><span class="linenos">299</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DataExtractorTool-300"><a href="#DataExtractorTool-300"><span class="linenos">300</span></a>        <span class="n">suffix_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool-301"><a href="#DataExtractorTool-301"><span class="linenos">301</span></a>        <span class="n">dir_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool-302"><a href="#DataExtractorTool-302"><span class="linenos">302</span></a>        <span class="n">duration_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool-303"><a href="#DataExtractorTool-303"><span class="linenos">303</span></a>        <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool-304"><a href="#DataExtractorTool-304"><span class="linenos">304</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DataExtractorTool-305"><a href="#DataExtractorTool-305"><span class="linenos">305</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-306"><a href="#DataExtractorTool-306"><span class="linenos">306</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-307"><a href="#DataExtractorTool-307"><span class="linenos">307</span></a><span class="sd">        Start the data extraction process using the configured data sources.</span>
</span><span id="DataExtractorTool-308"><a href="#DataExtractorTool-308"><span class="linenos">308</span></a>
</span><span id="DataExtractorTool-309"><a href="#DataExtractorTool-309"><span class="linenos">309</span></a><span class="sd">        Launches a background writer process that collects metrics and stores them</span>
</span><span id="DataExtractorTool-310"><a href="#DataExtractorTool-310"><span class="linenos">310</span></a><span class="sd">        in a CSV file. A YAML summary file is also generated, containing metadata</span>
</span><span id="DataExtractorTool-311"><a href="#DataExtractorTool-311"><span class="linenos">311</span></a><span class="sd">        about the extraction session.</span>
</span><span id="DataExtractorTool-312"><a href="#DataExtractorTool-312"><span class="linenos">312</span></a>
</span><span id="DataExtractorTool-313"><a href="#DataExtractorTool-313"><span class="linenos">313</span></a><span class="sd">        ### Args</span>
</span><span id="DataExtractorTool-314"><a href="#DataExtractorTool-314"><span class="linenos">314</span></a><span class="sd">        - **suffix_out** (`Optional[str]`): Suffix for the output CSV file name. If `None`, the user is prompted.</span>
</span><span id="DataExtractorTool-315"><a href="#DataExtractorTool-315"><span class="linenos">315</span></a><span class="sd">        - **dir_out** (`Optional[str]`): Directory where output files will be saved. If `None`, defaults to the configured output directory.</span>
</span><span id="DataExtractorTool-316"><a href="#DataExtractorTool-316"><span class="linenos">316</span></a><span class="sd">        - **duration_out** (`Optional[int]`): Duration of the extraction in seconds. If `None`, the user is prompted.</span>
</span><span id="DataExtractorTool-317"><a href="#DataExtractorTool-317"><span class="linenos">317</span></a><span class="sd">        - **logger**: Optional logger instance for logging messages.</span>
</span><span id="DataExtractorTool-318"><a href="#DataExtractorTool-318"><span class="linenos">318</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages.</span>
</span><span id="DataExtractorTool-319"><a href="#DataExtractorTool-319"><span class="linenos">319</span></a>
</span><span id="DataExtractorTool-320"><a href="#DataExtractorTool-320"><span class="linenos">320</span></a><span class="sd">        ### Notes</span>
</span><span id="DataExtractorTool-321"><a href="#DataExtractorTool-321"><span class="linenos">321</span></a><span class="sd">        - Prevents starting a new extraction if a writer process is already running.</span>
</span><span id="DataExtractorTool-322"><a href="#DataExtractorTool-322"><span class="linenos">322</span></a><span class="sd">        - Prompts the user interactively for missing parameters unless provided.</span>
</span><span id="DataExtractorTool-323"><a href="#DataExtractorTool-323"><span class="linenos">323</span></a><span class="sd">        - Automatically creates missing output directories and log files.</span>
</span><span id="DataExtractorTool-324"><a href="#DataExtractorTool-324"><span class="linenos">324</span></a><span class="sd">        - Saves extraction metadata to a YAML file alongside the CSV output.</span>
</span><span id="DataExtractorTool-325"><a href="#DataExtractorTool-325"><span class="linenos">325</span></a><span class="sd">        - Displays process details including PID, start time, duration, and assigned data sources.</span>
</span><span id="DataExtractorTool-326"><a href="#DataExtractorTool-326"><span class="linenos">326</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-327"><a href="#DataExtractorTool-327"><span class="linenos">327</span></a>
</span><span id="DataExtractorTool-328"><a href="#DataExtractorTool-328"><span class="linenos">328</span></a>        <span class="c1"># Prevent starting if a writer process is already running</span>
</span><span id="DataExtractorTool-329"><a href="#DataExtractorTool-329"><span class="linenos">329</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool-330"><a href="#DataExtractorTool-330"><span class="linenos">330</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="DataExtractorTool-331"><a href="#DataExtractorTool-331"><span class="linenos">331</span></a>                <span class="s2">&quot;caution&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool-332"><a href="#DataExtractorTool-332"><span class="linenos">332</span></a>                <span class="sa">f</span><span class="s2">&quot;A writer process is already running with PID </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool-333"><a href="#DataExtractorTool-333"><span class="linenos">333</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DataExtractorTool-334"><a href="#DataExtractorTool-334"><span class="linenos">334</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="DataExtractorTool-335"><a href="#DataExtractorTool-335"><span class="linenos">335</span></a>            <span class="p">)</span>
</span><span id="DataExtractorTool-336"><a href="#DataExtractorTool-336"><span class="linenos">336</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="DataExtractorTool-337"><a href="#DataExtractorTool-337"><span class="linenos">337</span></a>                <span class="s2">&quot;info&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool-338"><a href="#DataExtractorTool-338"><span class="linenos">338</span></a>                <span class="s2">&quot;To start a new extraction it is necessary to manually stop extraction from menu.&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool-339"><a href="#DataExtractorTool-339"><span class="linenos">339</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DataExtractorTool-340"><a href="#DataExtractorTool-340"><span class="linenos">340</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="DataExtractorTool-341"><a href="#DataExtractorTool-341"><span class="linenos">341</span></a>            <span class="p">)</span>
</span><span id="DataExtractorTool-342"><a href="#DataExtractorTool-342"><span class="linenos">342</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool-343"><a href="#DataExtractorTool-343"><span class="linenos">343</span></a>
</span><span id="DataExtractorTool-344"><a href="#DataExtractorTool-344"><span class="linenos">344</span></a>        <span class="c1"># Ensure data sources are loaded</span>
</span><span id="DataExtractorTool-345"><a href="#DataExtractorTool-345"><span class="linenos">345</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span>
</span><span id="DataExtractorTool-346"><a href="#DataExtractorTool-346"><span class="linenos">346</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="DataExtractorTool-347"><a href="#DataExtractorTool-347"><span class="linenos">347</span></a>                <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool-348"><a href="#DataExtractorTool-348"><span class="linenos">348</span></a>                <span class="s2">&quot;No data sources registered. Cannot start extraction.&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool-349"><a href="#DataExtractorTool-349"><span class="linenos">349</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DataExtractorTool-350"><a href="#DataExtractorTool-350"><span class="linenos">350</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="DataExtractorTool-351"><a href="#DataExtractorTool-351"><span class="linenos">351</span></a>            <span class="p">)</span>
</span><span id="DataExtractorTool-352"><a href="#DataExtractorTool-352"><span class="linenos">352</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool-353"><a href="#DataExtractorTool-353"><span class="linenos">353</span></a>
</span><span id="DataExtractorTool-354"><a href="#DataExtractorTool-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Starting extraction&quot;</span><span class="p">,</span> <span class="s2">&quot;📈&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="DataExtractorTool-355"><a href="#DataExtractorTool-355"><span class="linenos">355</span></a>
</span><span id="DataExtractorTool-356"><a href="#DataExtractorTool-356"><span class="linenos">356</span></a>        <span class="c1"># Prompt user for suffix and duration if not provided</span>
</span><span id="DataExtractorTool-357"><a href="#DataExtractorTool-357"><span class="linenos">357</span></a>        <span class="k">if</span> <span class="n">suffix_out</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-358"><a href="#DataExtractorTool-358"><span class="linenos">358</span></a>            <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Prompt</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;📁 Enter a suffix for the output CSV file&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;metrics&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-359"><a href="#DataExtractorTool-359"><span class="linenos">359</span></a>            <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">IntPrompt</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⏱️ Enter duration in seconds&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</span><span id="DataExtractorTool-360"><a href="#DataExtractorTool-360"><span class="linenos">360</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DataExtractorTool-361"><a href="#DataExtractorTool-361"><span class="linenos">361</span></a>            <span class="n">suffix</span> <span class="o">=</span> <span class="n">suffix_out</span>
</span><span id="DataExtractorTool-362"><a href="#DataExtractorTool-362"><span class="linenos">362</span></a>            <span class="n">duration</span> <span class="o">=</span> <span class="n">duration_out</span> <span class="k">if</span> <span class="n">duration_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">60</span>
</span><span id="DataExtractorTool-363"><a href="#DataExtractorTool-363"><span class="linenos">363</span></a>
</span><span id="DataExtractorTool-364"><a href="#DataExtractorTool-364"><span class="linenos">364</span></a>        <span class="c1"># Update output directory if provided</span>
</span><span id="DataExtractorTool-365"><a href="#DataExtractorTool-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="n">dir_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-366"><a href="#DataExtractorTool-366"><span class="linenos">366</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dir_out</span><span class="p">)</span>
</span><span id="DataExtractorTool-367"><a href="#DataExtractorTool-367"><span class="linenos">367</span></a>
</span><span id="DataExtractorTool-368"><a href="#DataExtractorTool-368"><span class="linenos">368</span></a>        <span class="c1"># Record start time and calculate planned end time</span>
</span><span id="DataExtractorTool-369"><a href="#DataExtractorTool-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="DataExtractorTool-370"><a href="#DataExtractorTool-370"><span class="linenos">370</span></a>        <span class="n">start_time_hr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y %H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-371"><a href="#DataExtractorTool-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">duration</span>
</span><span id="DataExtractorTool-372"><a href="#DataExtractorTool-372"><span class="linenos">372</span></a>        <span class="n">planned_end_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
</span><span id="DataExtractorTool-373"><a href="#DataExtractorTool-373"><span class="linenos">373</span></a>        <span class="n">planned_end_time_hr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">planned_end_time</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y %H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-374"><a href="#DataExtractorTool-374"><span class="linenos">374</span></a>
</span><span id="DataExtractorTool-375"><a href="#DataExtractorTool-375"><span class="linenos">375</span></a>        <span class="c1"># Create output file path with timestamp</span>
</span><span id="DataExtractorTool-376"><a href="#DataExtractorTool-376"><span class="linenos">376</span></a>        <span class="n">output_filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">.csv&quot;</span>
</span><span id="DataExtractorTool-377"><a href="#DataExtractorTool-377"><span class="linenos">377</span></a>        <span class="n">output_filepath</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DataExtractorTool-378"><a href="#DataExtractorTool-378"><span class="linenos">378</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_filepath</span><span class="p">)</span>
</span><span id="DataExtractorTool-379"><a href="#DataExtractorTool-379"><span class="linenos">379</span></a>
</span><span id="DataExtractorTool-380"><a href="#DataExtractorTool-380"><span class="linenos">380</span></a>        <span class="c1"># Prepare data source configurations for the writer process</span>
</span><span id="DataExtractorTool-381"><a href="#DataExtractorTool-381"><span class="linenos">381</span></a>        <span class="n">source_configs</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DataExtractorTool-382"><a href="#DataExtractorTool-382"><span class="linenos">382</span></a>            <span class="p">{</span>
</span><span id="DataExtractorTool-383"><a href="#DataExtractorTool-383"><span class="linenos">383</span></a>                <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool-384"><a href="#DataExtractorTool-384"><span class="linenos">384</span></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool-385"><a href="#DataExtractorTool-385"><span class="linenos">385</span></a>                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
</span><span id="DataExtractorTool-386"><a href="#DataExtractorTool-386"><span class="linenos">386</span></a>            <span class="p">}</span>
</span><span id="DataExtractorTool-387"><a href="#DataExtractorTool-387"><span class="linenos">387</span></a>            <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span>
</span><span id="DataExtractorTool-388"><a href="#DataExtractorTool-388"><span class="linenos">388</span></a>        <span class="p">]</span>
</span><span id="DataExtractorTool-389"><a href="#DataExtractorTool-389"><span class="linenos">389</span></a>
</span><span id="DataExtractorTool-390"><a href="#DataExtractorTool-390"><span class="linenos">390</span></a>        <span class="c1"># Save extractor parameters to a YAML file</span>
</span><span id="DataExtractorTool-391"><a href="#DataExtractorTool-391"><span class="linenos">391</span></a>        <span class="n">extractor_output</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DataExtractorTool-392"><a href="#DataExtractorTool-392"><span class="linenos">392</span></a>            <span class="s2">&quot;datasources&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DataExtractorTool-393"><a href="#DataExtractorTool-393"><span class="linenos">393</span></a>                <span class="n">source</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="p">{</span>
</span><span id="DataExtractorTool-394"><a href="#DataExtractorTool-394"><span class="linenos">394</span></a>                    <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
</span><span id="DataExtractorTool-395"><a href="#DataExtractorTool-395"><span class="linenos">395</span></a>                <span class="p">}</span>
</span><span id="DataExtractorTool-396"><a href="#DataExtractorTool-396"><span class="linenos">396</span></a>                <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span>
</span><span id="DataExtractorTool-397"><a href="#DataExtractorTool-397"><span class="linenos">397</span></a>            <span class="p">},</span>
</span><span id="DataExtractorTool-398"><a href="#DataExtractorTool-398"><span class="linenos">398</span></a>            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span>
</span><span id="DataExtractorTool-399"><a href="#DataExtractorTool-399"><span class="linenos">399</span></a>            <span class="s2">&quot;started_at&quot;</span><span class="p">:</span> <span class="n">start_time_hr</span><span class="p">,</span>
</span><span id="DataExtractorTool-400"><a href="#DataExtractorTool-400"><span class="linenos">400</span></a>            <span class="s2">&quot;finished_at_planned&quot;</span><span class="p">:</span> <span class="n">planned_end_time_hr</span>
</span><span id="DataExtractorTool-401"><a href="#DataExtractorTool-401"><span class="linenos">401</span></a>        <span class="p">}</span>
</span><span id="DataExtractorTool-402"><a href="#DataExtractorTool-402"><span class="linenos">402</span></a>
</span><span id="DataExtractorTool-403"><a href="#DataExtractorTool-403"><span class="linenos">403</span></a>        <span class="n">extractor_output_filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">.yaml&quot;</span>
</span><span id="DataExtractorTool-404"><a href="#DataExtractorTool-404"><span class="linenos">404</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">extractor_output_filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="DataExtractorTool-405"><a href="#DataExtractorTool-405"><span class="linenos">405</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">extractor_output</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DataExtractorTool-406"><a href="#DataExtractorTool-406"><span class="linenos">406</span></a>
</span><span id="DataExtractorTool-407"><a href="#DataExtractorTool-407"><span class="linenos">407</span></a>        <span class="c1"># Launch the writer process</span>
</span><span id="DataExtractorTool-408"><a href="#DataExtractorTool-408"><span class="linenos">408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span>
</span><span id="DataExtractorTool-409"><a href="#DataExtractorTool-409"><span class="linenos">409</span></a>            <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">write_metrics</span><span class="p">,</span>
</span><span id="DataExtractorTool-410"><a href="#DataExtractorTool-410"><span class="linenos">410</span></a>            <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">output_filepath</span><span class="p">,</span> <span class="n">extractor_output_filepath</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">source_configs</span><span class="p">)</span>
</span><span id="DataExtractorTool-411"><a href="#DataExtractorTool-411"><span class="linenos">411</span></a>        <span class="p">)</span>
</span><span id="DataExtractorTool-412"><a href="#DataExtractorTool-412"><span class="linenos">412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="DataExtractorTool-413"><a href="#DataExtractorTool-413"><span class="linenos">413</span></a>
</span><span id="DataExtractorTool-414"><a href="#DataExtractorTool-414"><span class="linenos">414</span></a>        <span class="c1"># Display confirmation and process details</span>
</span><span id="DataExtractorTool-415"><a href="#DataExtractorTool-415"><span class="linenos">415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Extractor launched successfully.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool-416"><a href="#DataExtractorTool-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;PID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2"> | Started at: </span><span class="si">{</span><span class="n">start_time_hr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool-417"><a href="#DataExtractorTool-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Duration: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool-418"><a href="#DataExtractorTool-418"><span class="linenos">418</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Data Sources assigned: </span><span class="si">{</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">source_configs</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool-419"><a href="#DataExtractorTool-419"><span class="linenos">419</span></a>
</span><span id="DataExtractorTool-420"><a href="#DataExtractorTool-420"><span class="linenos">420</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-421"><a href="#DataExtractorTool-421"><span class="linenos">421</span></a><span class="c1"># 🧪 Function: write_metrics</span>
</span><span id="DataExtractorTool-422"><a href="#DataExtractorTool-422"><span class="linenos">422</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-423"><a href="#DataExtractorTool-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_metrics</span><span class="p">(</span>
</span><span id="DataExtractorTool-424"><a href="#DataExtractorTool-424"><span class="linenos">424</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DataExtractorTool-425"><a href="#DataExtractorTool-425"><span class="linenos">425</span></a>        <span class="n">output_filepath</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="DataExtractorTool-426"><a href="#DataExtractorTool-426"><span class="linenos">426</span></a>        <span class="n">extractor_output_filepath</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="DataExtractorTool-427"><a href="#DataExtractorTool-427"><span class="linenos">427</span></a>        <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="DataExtractorTool-428"><a href="#DataExtractorTool-428"><span class="linenos">428</span></a>        <span class="n">source_configs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
</span><span id="DataExtractorTool-429"><a href="#DataExtractorTool-429"><span class="linenos">429</span></a>        <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool-430"><a href="#DataExtractorTool-430"><span class="linenos">430</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DataExtractorTool-431"><a href="#DataExtractorTool-431"><span class="linenos">431</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-432"><a href="#DataExtractorTool-432"><span class="linenos">432</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-433"><a href="#DataExtractorTool-433"><span class="linenos">433</span></a><span class="sd">        Collect metrics from configured data sources and write them to a CSV file.</span>
</span><span id="DataExtractorTool-434"><a href="#DataExtractorTool-434"><span class="linenos">434</span></a>
</span><span id="DataExtractorTool-435"><a href="#DataExtractorTool-435"><span class="linenos">435</span></a><span class="sd">        Starts each data source in a separate thread and coordinates data collection</span>
</span><span id="DataExtractorTool-436"><a href="#DataExtractorTool-436"><span class="linenos">436</span></a><span class="sd">        through a shared queue. Metrics are timestamped and written to the output file.</span>
</span><span id="DataExtractorTool-437"><a href="#DataExtractorTool-437"><span class="linenos">437</span></a><span class="sd">        Upon completion, metadata is appended to a YAML summary file.</span>
</span><span id="DataExtractorTool-438"><a href="#DataExtractorTool-438"><span class="linenos">438</span></a>
</span><span id="DataExtractorTool-439"><a href="#DataExtractorTool-439"><span class="linenos">439</span></a><span class="sd">        ### Args</span>
</span><span id="DataExtractorTool-440"><a href="#DataExtractorTool-440"><span class="linenos">440</span></a><span class="sd">        - **output_filepath** (`Path`): Path to the output CSV file.</span>
</span><span id="DataExtractorTool-441"><a href="#DataExtractorTool-441"><span class="linenos">441</span></a><span class="sd">        - **extractor_output_filepath** (`Path`): Path to the YAML metadata file.</span>
</span><span id="DataExtractorTool-442"><a href="#DataExtractorTool-442"><span class="linenos">442</span></a><span class="sd">        - **duration** (`int`): Duration of the extraction process in seconds.</span>
</span><span id="DataExtractorTool-443"><a href="#DataExtractorTool-443"><span class="linenos">443</span></a><span class="sd">        - **source_configs** (`List[Dict[str, Any]]`): Configuration for each data source.</span>
</span><span id="DataExtractorTool-444"><a href="#DataExtractorTool-444"><span class="linenos">444</span></a><span class="sd">        - **logger**: Optional logger instance for logging messages.</span>
</span><span id="DataExtractorTool-445"><a href="#DataExtractorTool-445"><span class="linenos">445</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages.</span>
</span><span id="DataExtractorTool-446"><a href="#DataExtractorTool-446"><span class="linenos">446</span></a>
</span><span id="DataExtractorTool-447"><a href="#DataExtractorTool-447"><span class="linenos">447</span></a><span class="sd">        ### Notes</span>
</span><span id="DataExtractorTool-448"><a href="#DataExtractorTool-448"><span class="linenos">448</span></a><span class="sd">        - Each data source runs in its own thread and pushes metrics to a shared queue.</span>
</span><span id="DataExtractorTool-449"><a href="#DataExtractorTool-449"><span class="linenos">449</span></a><span class="sd">        - The process ignores `SIGINT` to prevent interruption via keyboard.</span>
</span><span id="DataExtractorTool-450"><a href="#DataExtractorTool-450"><span class="linenos">450</span></a><span class="sd">        - Graceful termination is supported via `SIGTERM`.</span>
</span><span id="DataExtractorTool-451"><a href="#DataExtractorTool-451"><span class="linenos">451</span></a><span class="sd">        - Metadata including the stop time is appended to the YAML file after extraction ends.</span>
</span><span id="DataExtractorTool-452"><a href="#DataExtractorTool-452"><span class="linenos">452</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-453"><a href="#DataExtractorTool-453"><span class="linenos">453</span></a>       
</span><span id="DataExtractorTool-454"><a href="#DataExtractorTool-454"><span class="linenos">454</span></a>        <span class="c1"># Ignore SIGINT to prevent interruption from keyboard</span>
</span><span id="DataExtractorTool-455"><a href="#DataExtractorTool-455"><span class="linenos">455</span></a>        <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIG_IGN</span><span class="p">)</span>
</span><span id="DataExtractorTool-456"><a href="#DataExtractorTool-456"><span class="linenos">456</span></a>
</span><span id="DataExtractorTool-457"><a href="#DataExtractorTool-457"><span class="linenos">457</span></a>        <span class="c1"># Graceful termination handler</span>
</span><span id="DataExtractorTool-458"><a href="#DataExtractorTool-458"><span class="linenos">458</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">handle_signal</span><span class="p">(</span><span class="n">signum</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
</span><span id="DataExtractorTool-459"><a href="#DataExtractorTool-459"><span class="linenos">459</span></a>            <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="DataExtractorTool-460"><a href="#DataExtractorTool-460"><span class="linenos">460</span></a>
</span><span id="DataExtractorTool-461"><a href="#DataExtractorTool-461"><span class="linenos">461</span></a>        <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGTERM</span><span class="p">,</span> <span class="n">handle_signal</span><span class="p">)</span>
</span><span id="DataExtractorTool-462"><a href="#DataExtractorTool-462"><span class="linenos">462</span></a>
</span><span id="DataExtractorTool-463"><a href="#DataExtractorTool-463"><span class="linenos">463</span></a>        <span class="c1"># Shared event and queue for thread coordination</span>
</span><span id="DataExtractorTool-464"><a href="#DataExtractorTool-464"><span class="linenos">464</span></a>        <span class="n">event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
</span><span id="DataExtractorTool-465"><a href="#DataExtractorTool-465"><span class="linenos">465</span></a>        <span class="n">q</span><span class="p">:</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="DataExtractorTool-466"><a href="#DataExtractorTool-466"><span class="linenos">466</span></a>
</span><span id="DataExtractorTool-467"><a href="#DataExtractorTool-467"><span class="linenos">467</span></a>        <span class="n">sources</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DataExtractorTool-468"><a href="#DataExtractorTool-468"><span class="linenos">468</span></a>        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">source_configs</span><span class="p">:</span>
</span><span id="DataExtractorTool-469"><a href="#DataExtractorTool-469"><span class="linenos">469</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool-470"><a href="#DataExtractorTool-470"><span class="linenos">470</span></a>                <span class="c1"># Instantiate and start each data source thread</span>
</span><span id="DataExtractorTool-471"><a href="#DataExtractorTool-471"><span class="linenos">471</span></a>                <span class="n">source_class</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span>
</span><span id="DataExtractorTool-472"><a href="#DataExtractorTool-472"><span class="linenos">472</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="DataExtractorTool-473"><a href="#DataExtractorTool-473"><span class="linenos">473</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
</span><span id="DataExtractorTool-474"><a href="#DataExtractorTool-474"><span class="linenos">474</span></a>                <span class="n">source</span> <span class="o">=</span> <span class="n">source_class</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="DataExtractorTool-475"><a href="#DataExtractorTool-475"><span class="linenos">475</span></a>                <span class="n">source</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="DataExtractorTool-476"><a href="#DataExtractorTool-476"><span class="linenos">476</span></a>                <span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</span><span id="DataExtractorTool-477"><a href="#DataExtractorTool-477"><span class="linenos">477</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DataExtractorTool-478"><a href="#DataExtractorTool-478"><span class="linenos">478</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="DataExtractorTool-479"><a href="#DataExtractorTool-479"><span class="linenos">479</span></a>                    <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool-480"><a href="#DataExtractorTool-480"><span class="linenos">480</span></a>                    <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">] Error starting source: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool-481"><a href="#DataExtractorTool-481"><span class="linenos">481</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="DataExtractorTool-482"><a href="#DataExtractorTool-482"><span class="linenos">482</span></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="DataExtractorTool-483"><a href="#DataExtractorTool-483"><span class="linenos">483</span></a>                <span class="p">)</span>
</span><span id="DataExtractorTool-484"><a href="#DataExtractorTool-484"><span class="linenos">484</span></a>
</span><span id="DataExtractorTool-485"><a href="#DataExtractorTool-485"><span class="linenos">485</span></a>        <span class="c1"># Open CSV file and write header</span>
</span><span id="DataExtractorTool-486"><a href="#DataExtractorTool-486"><span class="linenos">486</span></a>        <span class="k">with</span> <span class="n">output_filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="DataExtractorTool-487"><a href="#DataExtractorTool-487"><span class="linenos">487</span></a>            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="DataExtractorTool-488"><a href="#DataExtractorTool-488"><span class="linenos">488</span></a>            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;metric&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">])</span>
</span><span id="DataExtractorTool-489"><a href="#DataExtractorTool-489"><span class="linenos">489</span></a>
</span><span id="DataExtractorTool-490"><a href="#DataExtractorTool-490"><span class="linenos">490</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool-491"><a href="#DataExtractorTool-491"><span class="linenos">491</span></a>                <span class="c1"># Collect data until duration expires or event is triggered</span>
</span><span id="DataExtractorTool-492"><a href="#DataExtractorTool-492"><span class="linenos">492</span></a>                <span class="n">t_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">duration</span>
</span><span id="DataExtractorTool-493"><a href="#DataExtractorTool-493"><span class="linenos">493</span></a>                <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">t_end</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span><span id="DataExtractorTool-494"><a href="#DataExtractorTool-494"><span class="linenos">494</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool-495"><a href="#DataExtractorTool-495"><span class="linenos">495</span></a>                        <span class="n">timestamp</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-496"><a href="#DataExtractorTool-496"><span class="linenos">496</span></a>                        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">])</span>
</span><span id="DataExtractorTool-497"><a href="#DataExtractorTool-497"><span class="linenos">497</span></a>                    <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
</span><span id="DataExtractorTool-498"><a href="#DataExtractorTool-498"><span class="linenos">498</span></a>                        <span class="k">continue</span>  <span class="c1"># No data available, continue waiting</span>
</span><span id="DataExtractorTool-499"><a href="#DataExtractorTool-499"><span class="linenos">499</span></a>            <span class="k">finally</span><span class="p">:</span>
</span><span id="DataExtractorTool-500"><a href="#DataExtractorTool-500"><span class="linenos">500</span></a>                <span class="c1"># Signal all threads to stop</span>
</span><span id="DataExtractorTool-501"><a href="#DataExtractorTool-501"><span class="linenos">501</span></a>                <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="DataExtractorTool-502"><a href="#DataExtractorTool-502"><span class="linenos">502</span></a>                <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
</span><span id="DataExtractorTool-503"><a href="#DataExtractorTool-503"><span class="linenos">503</span></a>                    <span class="n">source</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span id="DataExtractorTool-504"><a href="#DataExtractorTool-504"><span class="linenos">504</span></a>
</span><span id="DataExtractorTool-505"><a href="#DataExtractorTool-505"><span class="linenos">505</span></a>                <span class="c1"># Record stop time and append to YAML metadata</span>
</span><span id="DataExtractorTool-506"><a href="#DataExtractorTool-506"><span class="linenos">506</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stop_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="DataExtractorTool-507"><a href="#DataExtractorTool-507"><span class="linenos">507</span></a>                <span class="n">stop_time_hr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_time</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y %H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-508"><a href="#DataExtractorTool-508"><span class="linenos">508</span></a>
</span><span id="DataExtractorTool-509"><a href="#DataExtractorTool-509"><span class="linenos">509</span></a>                <span class="n">extractor_output</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DataExtractorTool-510"><a href="#DataExtractorTool-510"><span class="linenos">510</span></a>                    <span class="s2">&quot;finished_at&quot;</span><span class="p">:</span> <span class="n">stop_time_hr</span><span class="p">,</span>
</span><span id="DataExtractorTool-511"><a href="#DataExtractorTool-511"><span class="linenos">511</span></a>                <span class="p">}</span>
</span><span id="DataExtractorTool-512"><a href="#DataExtractorTool-512"><span class="linenos">512</span></a>                <span class="k">with</span> <span class="n">extractor_output_filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="DataExtractorTool-513"><a href="#DataExtractorTool-513"><span class="linenos">513</span></a>                    <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">extractor_output</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DataExtractorTool-514"><a href="#DataExtractorTool-514"><span class="linenos">514</span></a>
</span><span id="DataExtractorTool-515"><a href="#DataExtractorTool-515"><span class="linenos">515</span></a>
</span><span id="DataExtractorTool-516"><a href="#DataExtractorTool-516"><span class="linenos">516</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-517"><a href="#DataExtractorTool-517"><span class="linenos">517</span></a><span class="c1"># 📌 Function: stop_extraction</span>
</span><span id="DataExtractorTool-518"><a href="#DataExtractorTool-518"><span class="linenos">518</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-519"><a href="#DataExtractorTool-519"><span class="linenos">519</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_extraction</span><span class="p">(</span>
</span><span id="DataExtractorTool-520"><a href="#DataExtractorTool-520"><span class="linenos">520</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DataExtractorTool-521"><a href="#DataExtractorTool-521"><span class="linenos">521</span></a>        <span class="n">preconfirmation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DataExtractorTool-522"><a href="#DataExtractorTool-522"><span class="linenos">522</span></a>        <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool-523"><a href="#DataExtractorTool-523"><span class="linenos">523</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DataExtractorTool-524"><a href="#DataExtractorTool-524"><span class="linenos">524</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-525"><a href="#DataExtractorTool-525"><span class="linenos">525</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-526"><a href="#DataExtractorTool-526"><span class="linenos">526</span></a><span class="sd">        Forcefully stops the active data extraction process and resets session metadata.</span>
</span><span id="DataExtractorTool-527"><a href="#DataExtractorTool-527"><span class="linenos">527</span></a>
</span><span id="DataExtractorTool-528"><a href="#DataExtractorTool-528"><span class="linenos">528</span></a><span class="sd">        If the writer process is running, this method optionally prompts the user for confirmation,</span>
</span><span id="DataExtractorTool-529"><a href="#DataExtractorTool-529"><span class="linenos">529</span></a><span class="sd">        terminates the process, and clears output-related session variables.</span>
</span><span id="DataExtractorTool-530"><a href="#DataExtractorTool-530"><span class="linenos">530</span></a>
</span><span id="DataExtractorTool-531"><a href="#DataExtractorTool-531"><span class="linenos">531</span></a><span class="sd">        ### Args:</span>
</span><span id="DataExtractorTool-532"><a href="#DataExtractorTool-532"><span class="linenos">532</span></a><span class="sd">        - **preconfirmation** (`Optional[bool]`): If `True`, skips the confirmation prompt. Defaults to `False`.</span>
</span><span id="DataExtractorTool-533"><a href="#DataExtractorTool-533"><span class="linenos">533</span></a><span class="sd">        - **logger**: Logger instance used for logging messages. Defaults to `None`.</span>
</span><span id="DataExtractorTool-534"><a href="#DataExtractorTool-534"><span class="linenos">534</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages. Defaults to `0`.</span>
</span><span id="DataExtractorTool-535"><a href="#DataExtractorTool-535"><span class="linenos">535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-536"><a href="#DataExtractorTool-536"><span class="linenos">536</span></a>
</span><span id="DataExtractorTool-537"><a href="#DataExtractorTool-537"><span class="linenos">537</span></a>
</span><span id="DataExtractorTool-538"><a href="#DataExtractorTool-538"><span class="linenos">538</span></a>        <span class="c1"># Display section title</span>
</span><span id="DataExtractorTool-539"><a href="#DataExtractorTool-539"><span class="linenos">539</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Stopping extraction&quot;</span><span class="p">,</span> <span class="s2">&quot;🛑&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="DataExtractorTool-540"><a href="#DataExtractorTool-540"><span class="linenos">540</span></a>
</span><span id="DataExtractorTool-541"><a href="#DataExtractorTool-541"><span class="linenos">541</span></a>        <span class="c1"># Check if the writer process is running</span>
</span><span id="DataExtractorTool-542"><a href="#DataExtractorTool-542"><span class="linenos">542</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool-543"><a href="#DataExtractorTool-543"><span class="linenos">543</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;No Data Extractor running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool-544"><a href="#DataExtractorTool-544"><span class="linenos">544</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool-545"><a href="#DataExtractorTool-545"><span class="linenos">545</span></a>
</span><span id="DataExtractorTool-546"><a href="#DataExtractorTool-546"><span class="linenos">546</span></a>        <span class="c1"># Ask user for confirmation before terminating the process</span>
</span><span id="DataExtractorTool-547"><a href="#DataExtractorTool-547"><span class="linenos">547</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">preconfirmation</span><span class="p">:</span>
</span><span id="DataExtractorTool-548"><a href="#DataExtractorTool-548"><span class="linenos">548</span></a>            <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Confirm</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⚠️ Are you sure you want to forcefully stop the extraction process?&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DataExtractorTool-549"><a href="#DataExtractorTool-549"><span class="linenos">549</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span>
</span><span id="DataExtractorTool-550"><a href="#DataExtractorTool-550"><span class="linenos">550</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Stop operation cancelled.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool-551"><a href="#DataExtractorTool-551"><span class="linenos">551</span></a>                <span class="k">return</span>
</span><span id="DataExtractorTool-552"><a href="#DataExtractorTool-552"><span class="linenos">552</span></a>
</span><span id="DataExtractorTool-553"><a href="#DataExtractorTool-553"><span class="linenos">553</span></a>        <span class="c1"># Terminate the writer process if still alive</span>
</span><span id="DataExtractorTool-554"><a href="#DataExtractorTool-554"><span class="linenos">554</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool-555"><a href="#DataExtractorTool-555"><span class="linenos">555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="s2">&quot;Terminating writer process...&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool-556"><a href="#DataExtractorTool-556"><span class="linenos">556</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
</span><span id="DataExtractorTool-557"><a href="#DataExtractorTool-557"><span class="linenos">557</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span id="DataExtractorTool-558"><a href="#DataExtractorTool-558"><span class="linenos">558</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Writer process forcefully terminated.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool-559"><a href="#DataExtractorTool-559"><span class="linenos">559</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DataExtractorTool-560"><a href="#DataExtractorTool-560"><span class="linenos">560</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Writer process is not running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool-561"><a href="#DataExtractorTool-561"><span class="linenos">561</span></a>
</span><span id="DataExtractorTool-562"><a href="#DataExtractorTool-562"><span class="linenos">562</span></a>        <span class="c1"># Reset extraction session state</span>
</span><span id="DataExtractorTool-563"><a href="#DataExtractorTool-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DataExtractorTool-564"><a href="#DataExtractorTool-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DataExtractorTool-565"><a href="#DataExtractorTool-565"><span class="linenos">565</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DataExtractorTool-566"><a href="#DataExtractorTool-566"><span class="linenos">566</span></a>
</span><span id="DataExtractorTool-567"><a href="#DataExtractorTool-567"><span class="linenos">567</span></a>
</span><span id="DataExtractorTool-568"><a href="#DataExtractorTool-568"><span class="linenos">568</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-569"><a href="#DataExtractorTool-569"><span class="linenos">569</span></a><span class="c1"># 📌 Function: show_progress</span>
</span><span id="DataExtractorTool-570"><a href="#DataExtractorTool-570"><span class="linenos">570</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-571"><a href="#DataExtractorTool-571"><span class="linenos">571</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">show_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-572"><a href="#DataExtractorTool-572"><span class="linenos">572</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-573"><a href="#DataExtractorTool-573"><span class="linenos">573</span></a><span class="sd">        Displays a real-time progress indicator for the ongoing data extraction process.</span>
</span><span id="DataExtractorTool-574"><a href="#DataExtractorTool-574"><span class="linenos">574</span></a>
</span><span id="DataExtractorTool-575"><a href="#DataExtractorTool-575"><span class="linenos">575</span></a><span class="sd">        If the writer process is active, this method uses the view tools to render a progress bar</span>
</span><span id="DataExtractorTool-576"><a href="#DataExtractorTool-576"><span class="linenos">576</span></a><span class="sd">        based on the elapsed time since the extraction started.</span>
</span><span id="DataExtractorTool-577"><a href="#DataExtractorTool-577"><span class="linenos">577</span></a>
</span><span id="DataExtractorTool-578"><a href="#DataExtractorTool-578"><span class="linenos">578</span></a><span class="sd">        Console messages are shown if no extraction process is currently running.</span>
</span><span id="DataExtractorTool-579"><a href="#DataExtractorTool-579"><span class="linenos">579</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-580"><a href="#DataExtractorTool-580"><span class="linenos">580</span></a>
</span><span id="DataExtractorTool-581"><a href="#DataExtractorTool-581"><span class="linenos">581</span></a>        <span class="c1"># Display section title</span>
</span><span id="DataExtractorTool-582"><a href="#DataExtractorTool-582"><span class="linenos">582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Showing progress&quot;</span><span class="p">,</span> <span class="s2">&quot;⏳&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-583"><a href="#DataExtractorTool-583"><span class="linenos">583</span></a>
</span><span id="DataExtractorTool-584"><a href="#DataExtractorTool-584"><span class="linenos">584</span></a>        <span class="c1"># Check if extraction is active</span>
</span><span id="DataExtractorTool-585"><a href="#DataExtractorTool-585"><span class="linenos">585</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool-586"><a href="#DataExtractorTool-586"><span class="linenos">586</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No data extraction was started.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-587"><a href="#DataExtractorTool-587"><span class="linenos">587</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool-588"><a href="#DataExtractorTool-588"><span class="linenos">588</span></a>
</span><span id="DataExtractorTool-589"><a href="#DataExtractorTool-589"><span class="linenos">589</span></a>        <span class="c1"># Show real-time progress bar</span>
</span><span id="DataExtractorTool-590"><a href="#DataExtractorTool-590"><span class="linenos">590</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">real_time_progress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="s2">&quot;⏳ Extracting data...&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool-591"><a href="#DataExtractorTool-591"><span class="linenos">591</span></a>
</span><span id="DataExtractorTool-592"><a href="#DataExtractorTool-592"><span class="linenos">592</span></a>
</span><span id="DataExtractorTool-593"><a href="#DataExtractorTool-593"><span class="linenos">593</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-594"><a href="#DataExtractorTool-594"><span class="linenos">594</span></a><span class="c1"># 📌 Function: show_extracted_data</span>
</span><span id="DataExtractorTool-595"><a href="#DataExtractorTool-595"><span class="linenos">595</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-596"><a href="#DataExtractorTool-596"><span class="linenos">596</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">show_extracted_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-597"><a href="#DataExtractorTool-597"><span class="linenos">597</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-598"><a href="#DataExtractorTool-598"><span class="linenos">598</span></a><span class="sd">        Streams the real-time log output of the data extraction process to the console.</span>
</span><span id="DataExtractorTool-599"><a href="#DataExtractorTool-599"><span class="linenos">599</span></a>
</span><span id="DataExtractorTool-600"><a href="#DataExtractorTool-600"><span class="linenos">600</span></a><span class="sd">        If the writer process is active, this method uses the view tools to display the contents</span>
</span><span id="DataExtractorTool-601"><a href="#DataExtractorTool-601"><span class="linenos">601</span></a><span class="sd">        of the output log file. Otherwise, it notifies the user that no process is running.</span>
</span><span id="DataExtractorTool-602"><a href="#DataExtractorTool-602"><span class="linenos">602</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-603"><a href="#DataExtractorTool-603"><span class="linenos">603</span></a>
</span><span id="DataExtractorTool-604"><a href="#DataExtractorTool-604"><span class="linenos">604</span></a>        <span class="c1"># Check if extraction is active</span>
</span><span id="DataExtractorTool-605"><a href="#DataExtractorTool-605"><span class="linenos">605</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool-606"><a href="#DataExtractorTool-606"><span class="linenos">606</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No data extraction was started.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool-607"><a href="#DataExtractorTool-607"><span class="linenos">607</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool-608"><a href="#DataExtractorTool-608"><span class="linenos">608</span></a>
</span><span id="DataExtractorTool-609"><a href="#DataExtractorTool-609"><span class="linenos">609</span></a>        <span class="c1"># Stream the real-time log output</span>
</span><span id="DataExtractorTool-610"><a href="#DataExtractorTool-610"><span class="linenos">610</span></a>        <span class="n">log_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span> <span class="k">else</span> <span class="n">Path</span><span class="p">()</span>
</span><span id="DataExtractorTool-611"><a href="#DataExtractorTool-611"><span class="linenos">611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">real_time_log</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>
</span><span id="DataExtractorTool-612"><a href="#DataExtractorTool-612"><span class="linenos">612</span></a>
</span><span id="DataExtractorTool-613"><a href="#DataExtractorTool-613"><span class="linenos">613</span></a>
</span><span id="DataExtractorTool-614"><a href="#DataExtractorTool-614"><span class="linenos">614</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-615"><a href="#DataExtractorTool-615"><span class="linenos">615</span></a><span class="c1"># 📌 Function: exit</span>
</span><span id="DataExtractorTool-616"><a href="#DataExtractorTool-616"><span class="linenos">616</span></a><span class="c1"># ─────────────────────────────────────────────────────────────────────────────</span>
</span><span id="DataExtractorTool-617"><a href="#DataExtractorTool-617"><span class="linenos">617</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool-618"><a href="#DataExtractorTool-618"><span class="linenos">618</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-619"><a href="#DataExtractorTool-619"><span class="linenos">619</span></a><span class="sd">        Exits the TUI menu and performs cleanup operations.</span>
</span><span id="DataExtractorTool-620"><a href="#DataExtractorTool-620"><span class="linenos">620</span></a>
</span><span id="DataExtractorTool-621"><a href="#DataExtractorTool-621"><span class="linenos">621</span></a><span class="sd">        This method is intended to be called when the user chooses to exit the interface.</span>
</span><span id="DataExtractorTool-622"><a href="#DataExtractorTool-622"><span class="linenos">622</span></a><span class="sd">        It stops any active data extraction process and releases associated resources.</span>
</span><span id="DataExtractorTool-623"><a href="#DataExtractorTool-623"><span class="linenos">623</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool-624"><a href="#DataExtractorTool-624"><span class="linenos">624</span></a>  
</span><span id="DataExtractorTool-625"><a href="#DataExtractorTool-625"><span class="linenos">625</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stop_extraction</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Tool for extracting data from configured sources and managing output files.</p>

<h3 id="attributes">Attributes</h3>

<ul>
<li><strong>vt</strong> (<code>utils.ViewTools</code>): Utility tools for view-related operations.</li>
<li><strong>output_dir</strong> (<code>Path</code>): Directory where output files will be stored.</li>
<li><strong>loaded_datasources</strong> (<code>List[dsources.DataSource]</code>): List of data sources that have been loaded.</li>
<li><strong>writer_process</strong> (<code>multiprocessing.Process</code>): Background process responsible for writing output.</li>
<li><strong>output_filepath</strong> (<code>Optional[Path]</code>): Path to the output file, if available.</li>
<li><strong>start_time</strong> (<code>Optional[float]</code>): Timestamp marking the start of the extraction process.</li>
<li><strong>duration</strong> (<code>Optional[int]</code>): Duration of the extraction process in seconds.</li>
</ul>
</div>


                            <div id="DataExtractorTool.__init__" class="classattr">
                                        <input id="DataExtractorTool.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">DataExtractorTool</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">vt</span><span class="p">:</span> <span class="n"><a href="../utils/viewtools.html#ViewTools">syncarium.tui.utils.viewtools.ViewTools</a></span></span>)</span>

                <label class="view-source-button" for="DataExtractorTool.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataExtractorTool.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataExtractorTool.__init__-59"><a href="#DataExtractorTool.__init__-59"><span class="linenos">59</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.__init__-60"><a href="#DataExtractorTool.__init__-60"><span class="linenos">60</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.__init__-61"><a href="#DataExtractorTool.__init__-61"><span class="linenos">61</span></a><span class="sd">        Initialize a new instance of `DataExtractorTool` with default paths and metadata.</span>
</span><span id="DataExtractorTool.__init__-62"><a href="#DataExtractorTool.__init__-62"><span class="linenos">62</span></a>
</span><span id="DataExtractorTool.__init__-63"><a href="#DataExtractorTool.__init__-63"><span class="linenos">63</span></a><span class="sd">        ### Args</span>
</span><span id="DataExtractorTool.__init__-64"><a href="#DataExtractorTool.__init__-64"><span class="linenos">64</span></a><span class="sd">        - **vt** (`utils.ViewTools`): Utility tools for view-related operations.</span>
</span><span id="DataExtractorTool.__init__-65"><a href="#DataExtractorTool.__init__-65"><span class="linenos">65</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.__init__-66"><a href="#DataExtractorTool.__init__-66"><span class="linenos">66</span></a>
</span><span id="DataExtractorTool.__init__-67"><a href="#DataExtractorTool.__init__-67"><span class="linenos">67</span></a>        <span class="c1"># Store the view tools instance</span>
</span><span id="DataExtractorTool.__init__-68"><a href="#DataExtractorTool.__init__-68"><span class="linenos">68</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="p">:</span> <span class="n">utils</span><span class="o">.</span><span class="n">ViewTools</span> <span class="o">=</span> <span class="n">vt</span>
</span><span id="DataExtractorTool.__init__-69"><a href="#DataExtractorTool.__init__-69"><span class="linenos">69</span></a>
</span><span id="DataExtractorTool.__init__-70"><a href="#DataExtractorTool.__init__-70"><span class="linenos">70</span></a>        <span class="c1"># Define configuration and output directories using pathlib</span>
</span><span id="DataExtractorTool.__init__-71"><a href="#DataExtractorTool.__init__-71"><span class="linenos">71</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;suite&quot;</span><span class="p">)</span> <span class="o">/</span> <span class="s2">&quot;config&quot;</span>
</span><span id="DataExtractorTool.__init__-72"><a href="#DataExtractorTool.__init__-72"><span class="linenos">72</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;output&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool.__init__-73"><a href="#DataExtractorTool.__init__-73"><span class="linenos">73</span></a>
</span><span id="DataExtractorTool.__init__-74"><a href="#DataExtractorTool.__init__-74"><span class="linenos">74</span></a>        <span class="c1"># Initialize the list of loaded data sources</span>
</span><span id="DataExtractorTool.__init__-75"><a href="#DataExtractorTool.__init__-75"><span class="linenos">75</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">dsources</span><span class="o">.</span><span class="n">DataSource</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DataExtractorTool.__init__-76"><a href="#DataExtractorTool.__init__-76"><span class="linenos">76</span></a>
</span><span id="DataExtractorTool.__init__-77"><a href="#DataExtractorTool.__init__-77"><span class="linenos">77</span></a>        <span class="c1"># Prepare the writer process (not started yet)</span>
</span><span id="DataExtractorTool.__init__-78"><a href="#DataExtractorTool.__init__-78"><span class="linenos">78</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="p">:</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">()</span>
</span><span id="DataExtractorTool.__init__-79"><a href="#DataExtractorTool.__init__-79"><span class="linenos">79</span></a>
</span><span id="DataExtractorTool.__init__-80"><a href="#DataExtractorTool.__init__-80"><span class="linenos">80</span></a>        <span class="c1"># Initialize metadata for output tracking</span>
</span><span id="DataExtractorTool.__init__-81"><a href="#DataExtractorTool.__init__-81"><span class="linenos">81</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Path</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DataExtractorTool.__init__-82"><a href="#DataExtractorTool.__init__-82"><span class="linenos">82</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DataExtractorTool.__init__-83"><a href="#DataExtractorTool.__init__-83"><span class="linenos">83</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Initialize a new instance of <code><a href="#DataExtractorTool">DataExtractorTool</a></code> with default paths and metadata.</p>

<h3 id="args">Args</h3>

<ul>
<li><strong>vt</strong> (<code>utils.ViewTools</code>): Utility tools for view-related operations.</li>
</ul>
</div>


                            </div>
                            <div id="DataExtractorTool.vt" class="classattr">
                                <div class="attr variable">
            <span class="name">vt</span><span class="annotation">: <a href="../utils/viewtools.html#ViewTools">syncarium.tui.utils.viewtools.ViewTools</a></span>

        
    </div>
    <a class="headerlink" href="#DataExtractorTool.vt"></a>
    
    

                            </div>
                            <div id="DataExtractorTool.config_dir" class="classattr">
                                <div class="attr variable">
            <span class="name">config_dir</span><span class="annotation">: pathlib.Path</span>

        
    </div>
    <a class="headerlink" href="#DataExtractorTool.config_dir"></a>
    
    

                            </div>
                            <div id="DataExtractorTool.output_dir" class="classattr">
                                <div class="attr variable">
            <span class="name">output_dir</span><span class="annotation">: pathlib.Path</span>

        
    </div>
    <a class="headerlink" href="#DataExtractorTool.output_dir"></a>
    
    

                            </div>
                            <div id="DataExtractorTool.loaded_datasources" class="classattr">
                                <div class="attr variable">
            <span class="name">loaded_datasources</span><span class="annotation">: List[<a href="dsources/datasource.html#DataSource">syncarium.tui.core.dsources.datasource.DataSource</a>]</span>

        
    </div>
    <a class="headerlink" href="#DataExtractorTool.loaded_datasources"></a>
    
    

                            </div>
                            <div id="DataExtractorTool.writer_process" class="classattr">
                                <div class="attr variable">
            <span class="name">writer_process</span><span class="annotation">: multiprocessing.context.Process</span>

        
    </div>
    <a class="headerlink" href="#DataExtractorTool.writer_process"></a>
    
    

                            </div>
                            <div id="DataExtractorTool.output_filepath" class="classattr">
                                <div class="attr variable">
            <span class="name">output_filepath</span><span class="annotation">: Optional[pathlib.Path]</span>

        
    </div>
    <a class="headerlink" href="#DataExtractorTool.output_filepath"></a>
    
    

                            </div>
                            <div id="DataExtractorTool.start_time" class="classattr">
                                <div class="attr variable">
            <span class="name">start_time</span><span class="annotation">: Optional[float]</span>

        
    </div>
    <a class="headerlink" href="#DataExtractorTool.start_time"></a>
    
    

                            </div>
                            <div id="DataExtractorTool.duration" class="classattr">
                                <div class="attr variable">
            <span class="name">duration</span><span class="annotation">: Optional[int]</span>

        
    </div>
    <a class="headerlink" href="#DataExtractorTool.duration"></a>
    
    

                            </div>
                            <div id="DataExtractorTool.main_menu" class="classattr">
                                        <input id="DataExtractorTool.main_menu-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">main_menu</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DataExtractorTool.main_menu-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataExtractorTool.main_menu"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataExtractorTool.main_menu-89"><a href="#DataExtractorTool.main_menu-89"><span class="linenos"> 89</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">main_menu</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.main_menu-90"><a href="#DataExtractorTool.main_menu-90"><span class="linenos"> 90</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.main_menu-91"><a href="#DataExtractorTool.main_menu-91"><span class="linenos"> 91</span></a><span class="sd">        Render and manage the interactive terminal-based main menu for data extraction.</span>
</span><span id="DataExtractorTool.main_menu-92"><a href="#DataExtractorTool.main_menu-92"><span class="linenos"> 92</span></a>
</span><span id="DataExtractorTool.main_menu-93"><a href="#DataExtractorTool.main_menu-93"><span class="linenos"> 93</span></a><span class="sd">        Continuously displays a menu using InquirerPy, allowing the user to:</span>
</span><span id="DataExtractorTool.main_menu-94"><a href="#DataExtractorTool.main_menu-94"><span class="linenos"> 94</span></a><span class="sd">        - Load data sources</span>
</span><span id="DataExtractorTool.main_menu-95"><a href="#DataExtractorTool.main_menu-95"><span class="linenos"> 95</span></a><span class="sd">        - Start or stop the extractor</span>
</span><span id="DataExtractorTool.main_menu-96"><a href="#DataExtractorTool.main_menu-96"><span class="linenos"> 96</span></a><span class="sd">        - View progress and extracted data</span>
</span><span id="DataExtractorTool.main_menu-97"><a href="#DataExtractorTool.main_menu-97"><span class="linenos"> 97</span></a><span class="sd">        - Refresh the view</span>
</span><span id="DataExtractorTool.main_menu-98"><a href="#DataExtractorTool.main_menu-98"><span class="linenos"> 98</span></a><span class="sd">        - Exit the tool</span>
</span><span id="DataExtractorTool.main_menu-99"><a href="#DataExtractorTool.main_menu-99"><span class="linenos"> 99</span></a>
</span><span id="DataExtractorTool.main_menu-100"><a href="#DataExtractorTool.main_menu-100"><span class="linenos">100</span></a><span class="sd">        The loop runs until the user selects **&quot;❌ Exit&quot;** or interrupts the process with **Ctrl+C**.</span>
</span><span id="DataExtractorTool.main_menu-101"><a href="#DataExtractorTool.main_menu-101"><span class="linenos">101</span></a>
</span><span id="DataExtractorTool.main_menu-102"><a href="#DataExtractorTool.main_menu-102"><span class="linenos">102</span></a><span class="sd">        ### Menu Options</span>
</span><span id="DataExtractorTool.main_menu-103"><a href="#DataExtractorTool.main_menu-103"><span class="linenos">103</span></a><span class="sd">        - 🛢️ Load Data Sources → `load_datasources`</span>
</span><span id="DataExtractorTool.main_menu-104"><a href="#DataExtractorTool.main_menu-104"><span class="linenos">104</span></a><span class="sd">        - 📈 Start Extractor → `start_extraction`</span>
</span><span id="DataExtractorTool.main_menu-105"><a href="#DataExtractorTool.main_menu-105"><span class="linenos">105</span></a><span class="sd">        - 🛑 Stop Extractor → `stop_extraction`</span>
</span><span id="DataExtractorTool.main_menu-106"><a href="#DataExtractorTool.main_menu-106"><span class="linenos">106</span></a><span class="sd">        - ⏳ Show Progress → `show_progress`</span>
</span><span id="DataExtractorTool.main_menu-107"><a href="#DataExtractorTool.main_menu-107"><span class="linenos">107</span></a><span class="sd">        - 📄 Show Extracted Data → `show_extracted_data`</span>
</span><span id="DataExtractorTool.main_menu-108"><a href="#DataExtractorTool.main_menu-108"><span class="linenos">108</span></a><span class="sd">        - 🔄 Refresh View → no action</span>
</span><span id="DataExtractorTool.main_menu-109"><a href="#DataExtractorTool.main_menu-109"><span class="linenos">109</span></a><span class="sd">        - ❌ Exit → terminates the menu loop</span>
</span><span id="DataExtractorTool.main_menu-110"><a href="#DataExtractorTool.main_menu-110"><span class="linenos">110</span></a>
</span><span id="DataExtractorTool.main_menu-111"><a href="#DataExtractorTool.main_menu-111"><span class="linenos">111</span></a><span class="sd">        ### Notes</span>
</span><span id="DataExtractorTool.main_menu-112"><a href="#DataExtractorTool.main_menu-112"><span class="linenos">112</span></a><span class="sd">        - Graceful termination is supported via **Ctrl+C**.</span>
</span><span id="DataExtractorTool.main_menu-113"><a href="#DataExtractorTool.main_menu-113"><span class="linenos">113</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.main_menu-114"><a href="#DataExtractorTool.main_menu-114"><span class="linenos">114</span></a>
</span><span id="DataExtractorTool.main_menu-115"><a href="#DataExtractorTool.main_menu-115"><span class="linenos">115</span></a>        <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool.main_menu-116"><a href="#DataExtractorTool.main_menu-116"><span class="linenos">116</span></a>            <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="DataExtractorTool.main_menu-117"><a href="#DataExtractorTool.main_menu-117"><span class="linenos">117</span></a>                <span class="c1"># Show software title without delay</span>
</span><span id="DataExtractorTool.main_menu-118"><a href="#DataExtractorTool.main_menu-118"><span class="linenos">118</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_software_title</span><span class="p">(</span><span class="n">delay</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
</span><span id="DataExtractorTool.main_menu-119"><a href="#DataExtractorTool.main_menu-119"><span class="linenos">119</span></a>
</span><span id="DataExtractorTool.main_menu-120"><a href="#DataExtractorTool.main_menu-120"><span class="linenos">120</span></a>                <span class="c1"># Display the main menu title</span>
</span><span id="DataExtractorTool.main_menu-121"><a href="#DataExtractorTool.main_menu-121"><span class="linenos">121</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;main_title&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Extractor Tool Menu&quot;</span><span class="p">,</span> <span class="s2">&quot;📈&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool.main_menu-122"><a href="#DataExtractorTool.main_menu-122"><span class="linenos">122</span></a>
</span><span id="DataExtractorTool.main_menu-123"><a href="#DataExtractorTool.main_menu-123"><span class="linenos">123</span></a>                <span class="c1"># Show the most recent metric</span>
</span><span id="DataExtractorTool.main_menu-124"><a href="#DataExtractorTool.main_menu-124"><span class="linenos">124</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_last_metric</span><span class="p">()</span>
</span><span id="DataExtractorTool.main_menu-125"><a href="#DataExtractorTool.main_menu-125"><span class="linenos">125</span></a>
</span><span id="DataExtractorTool.main_menu-126"><a href="#DataExtractorTool.main_menu-126"><span class="linenos">126</span></a>                <span class="c1"># Display loaded data sources</span>
</span><span id="DataExtractorTool.main_menu-127"><a href="#DataExtractorTool.main_menu-127"><span class="linenos">127</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_datasources</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">)</span>
</span><span id="DataExtractorTool.main_menu-128"><a href="#DataExtractorTool.main_menu-128"><span class="linenos">128</span></a>
</span><span id="DataExtractorTool.main_menu-129"><a href="#DataExtractorTool.main_menu-129"><span class="linenos">129</span></a>                <span class="c1"># Show extractor status and output information</span>
</span><span id="DataExtractorTool.main_menu-130"><a href="#DataExtractorTool.main_menu-130"><span class="linenos">130</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">table_data_extractor</span><span class="p">(</span>
</span><span id="DataExtractorTool.main_menu-131"><a href="#DataExtractorTool.main_menu-131"><span class="linenos">131</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="p">,</span>
</span><span id="DataExtractorTool.main_menu-132"><a href="#DataExtractorTool.main_menu-132"><span class="linenos">132</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">,</span>
</span><span id="DataExtractorTool.main_menu-133"><a href="#DataExtractorTool.main_menu-133"><span class="linenos">133</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span><span class="p">,</span>
</span><span id="DataExtractorTool.main_menu-134"><a href="#DataExtractorTool.main_menu-134"><span class="linenos">134</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span>
</span><span id="DataExtractorTool.main_menu-135"><a href="#DataExtractorTool.main_menu-135"><span class="linenos">135</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
</span><span id="DataExtractorTool.main_menu-136"><a href="#DataExtractorTool.main_menu-136"><span class="linenos">136</span></a>                <span class="p">)</span>
</span><span id="DataExtractorTool.main_menu-137"><a href="#DataExtractorTool.main_menu-137"><span class="linenos">137</span></a>
</span><span id="DataExtractorTool.main_menu-138"><a href="#DataExtractorTool.main_menu-138"><span class="linenos">138</span></a>                <span class="c1"># Present interactive menu options</span>
</span><span id="DataExtractorTool.main_menu-139"><a href="#DataExtractorTool.main_menu-139"><span class="linenos">139</span></a>                <span class="n">choice</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="DataExtractorTool.main_menu-140"><a href="#DataExtractorTool.main_menu-140"><span class="linenos">140</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="p">[</span>
</span><span id="DataExtractorTool.main_menu-141"><a href="#DataExtractorTool.main_menu-141"><span class="linenos">141</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🛢️ Load Data Sources&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;load_datasources&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool.main_menu-142"><a href="#DataExtractorTool.main_menu-142"><span class="linenos">142</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📈 Start Extractor&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;start_extraction&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool.main_menu-143"><a href="#DataExtractorTool.main_menu-143"><span class="linenos">143</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🛑 Stop Extractor&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;stop_extraction&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool.main_menu-144"><a href="#DataExtractorTool.main_menu-144"><span class="linenos">144</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;⏳ Show Progress&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;show_progress&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool.main_menu-145"><a href="#DataExtractorTool.main_menu-145"><span class="linenos">145</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;📄 Show Extracted Data&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;show_extracted_data&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool.main_menu-146"><a href="#DataExtractorTool.main_menu-146"><span class="linenos">146</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;🔄 Refresh view&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool.main_menu-147"><a href="#DataExtractorTool.main_menu-147"><span class="linenos">147</span></a>                        <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;❌ Exit&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="s2">&quot;exit&quot;</span><span class="p">},</span>
</span><span id="DataExtractorTool.main_menu-148"><a href="#DataExtractorTool.main_menu-148"><span class="linenos">148</span></a>                    <span class="p">],</span>
</span><span id="DataExtractorTool.main_menu-149"><a href="#DataExtractorTool.main_menu-149"><span class="linenos">149</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="DataExtractorTool.main_menu-150"><a href="#DataExtractorTool.main_menu-150"><span class="linenos">150</span></a>                <span class="p">)</span>
</span><span id="DataExtractorTool.main_menu-151"><a href="#DataExtractorTool.main_menu-151"><span class="linenos">151</span></a>
</span><span id="DataExtractorTool.main_menu-152"><a href="#DataExtractorTool.main_menu-152"><span class="linenos">152</span></a>                <span class="c1"># Map menu options to corresponding methods</span>
</span><span id="DataExtractorTool.main_menu-153"><a href="#DataExtractorTool.main_menu-153"><span class="linenos">153</span></a>                <span class="n">submenu</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[],</span> <span class="kc">None</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DataExtractorTool.main_menu-154"><a href="#DataExtractorTool.main_menu-154"><span class="linenos">154</span></a>                    <span class="s2">&quot;load_datasources&quot;</span><span class="p">:</span>     <span class="bp">self</span><span class="o">.</span><span class="n">load_datasources</span><span class="p">,</span>
</span><span id="DataExtractorTool.main_menu-155"><a href="#DataExtractorTool.main_menu-155"><span class="linenos">155</span></a>                    <span class="s2">&quot;start_extraction&quot;</span><span class="p">:</span>     <span class="bp">self</span><span class="o">.</span><span class="n">start_extraction</span><span class="p">,</span>
</span><span id="DataExtractorTool.main_menu-156"><a href="#DataExtractorTool.main_menu-156"><span class="linenos">156</span></a>                    <span class="s2">&quot;stop_extraction&quot;</span><span class="p">:</span>      <span class="bp">self</span><span class="o">.</span><span class="n">stop_extraction</span><span class="p">,</span>
</span><span id="DataExtractorTool.main_menu-157"><a href="#DataExtractorTool.main_menu-157"><span class="linenos">157</span></a>                    <span class="s2">&quot;show_progress&quot;</span><span class="p">:</span>        <span class="bp">self</span><span class="o">.</span><span class="n">show_progress</span><span class="p">,</span>
</span><span id="DataExtractorTool.main_menu-158"><a href="#DataExtractorTool.main_menu-158"><span class="linenos">158</span></a>                    <span class="s2">&quot;show_extracted_data&quot;</span><span class="p">:</span>  <span class="bp">self</span><span class="o">.</span><span class="n">show_extracted_data</span><span class="p">,</span>
</span><span id="DataExtractorTool.main_menu-159"><a href="#DataExtractorTool.main_menu-159"><span class="linenos">159</span></a>                <span class="p">}</span>
</span><span id="DataExtractorTool.main_menu-160"><a href="#DataExtractorTool.main_menu-160"><span class="linenos">160</span></a>
</span><span id="DataExtractorTool.main_menu-161"><a href="#DataExtractorTool.main_menu-161"><span class="linenos">161</span></a>                <span class="c1"># Handle user selection</span>
</span><span id="DataExtractorTool.main_menu-162"><a href="#DataExtractorTool.main_menu-162"><span class="linenos">162</span></a>                <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="s2">&quot;exit&quot;</span><span class="p">:</span>
</span><span id="DataExtractorTool.main_menu-163"><a href="#DataExtractorTool.main_menu-163"><span class="linenos">163</span></a>                    <span class="k">break</span>
</span><span id="DataExtractorTool.main_menu-164"><a href="#DataExtractorTool.main_menu-164"><span class="linenos">164</span></a>                <span class="k">elif</span> <span class="n">choice</span> <span class="o">!=</span> <span class="s2">&quot;refresh_view&quot;</span><span class="p">:</span>
</span><span id="DataExtractorTool.main_menu-165"><a href="#DataExtractorTool.main_menu-165"><span class="linenos">165</span></a>                    <span class="n">action</span> <span class="o">=</span> <span class="n">submenu</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>
</span><span id="DataExtractorTool.main_menu-166"><a href="#DataExtractorTool.main_menu-166"><span class="linenos">166</span></a>                    <span class="k">if</span> <span class="n">action</span><span class="p">:</span>
</span><span id="DataExtractorTool.main_menu-167"><a href="#DataExtractorTool.main_menu-167"><span class="linenos">167</span></a>                        <span class="n">action</span><span class="p">()</span>
</span><span id="DataExtractorTool.main_menu-168"><a href="#DataExtractorTool.main_menu-168"><span class="linenos">168</span></a>                        <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">🔙 Press ⏎ to return to the menu...&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool.main_menu-169"><a href="#DataExtractorTool.main_menu-169"><span class="linenos">169</span></a>
</span><span id="DataExtractorTool.main_menu-170"><a href="#DataExtractorTool.main_menu-170"><span class="linenos">170</span></a>        <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="DataExtractorTool.main_menu-171"><a href="#DataExtractorTool.main_menu-171"><span class="linenos">171</span></a>            <span class="c1"># Gracefully handle Ctrl+C interruption</span>
</span><span id="DataExtractorTool.main_menu-172"><a href="#DataExtractorTool.main_menu-172"><span class="linenos">172</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;exit&quot;</span><span class="p">,</span> <span class="s2">&quot;Exiting...&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Render and manage the interactive terminal-based main menu for data extraction.</p>

<p>Continuously displays a menu using InquirerPy, allowing the user to:</p>

<ul>
<li>Load data sources</li>
<li>Start or stop the extractor</li>
<li>View progress and extracted data</li>
<li>Refresh the view</li>
<li>Exit the tool</li>
</ul>

<p>The loop runs until the user selects <strong>"❌ Exit"</strong> or interrupts the process with <strong>Ctrl+C</strong>.</p>

<h3 id="menu-options">Menu Options</h3>

<ul>
<li>🛢️ Load Data Sources → <code><a href="#DataExtractorTool.load_datasources">load_datasources</a></code></li>
<li>📈 Start Extractor → <code><a href="#DataExtractorTool.start_extraction">start_extraction</a></code></li>
<li>🛑 Stop Extractor → <code><a href="#DataExtractorTool.stop_extraction">stop_extraction</a></code></li>
<li>⏳ Show Progress → <code><a href="#DataExtractorTool.show_progress">show_progress</a></code></li>
<li>📄 Show Extracted Data → <code><a href="#DataExtractorTool.show_extracted_data">show_extracted_data</a></code></li>
<li>🔄 Refresh View → no action</li>
<li>❌ Exit → terminates the menu loop</li>
</ul>

<h3 id="notes">Notes</h3>

<ul>
<li>Graceful termination is supported via <strong>Ctrl+C</strong>.</li>
</ul>
</div>


                            </div>
                            <div id="DataExtractorTool.load_datasources" class="classattr">
                                        <input id="DataExtractorTool.load_datasources-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">load_datasources</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">file_cfg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>, </span><span class="param"><span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DataExtractorTool.load_datasources-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataExtractorTool.load_datasources"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataExtractorTool.load_datasources-178"><a href="#DataExtractorTool.load_datasources-178"><span class="linenos">178</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">load_datasources</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">file_cfg</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">quiet</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-179"><a href="#DataExtractorTool.load_datasources-179"><span class="linenos">179</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.load_datasources-180"><a href="#DataExtractorTool.load_datasources-180"><span class="linenos">180</span></a><span class="sd">        Load and configure data sources from a YAML configuration file.</span>
</span><span id="DataExtractorTool.load_datasources-181"><a href="#DataExtractorTool.load_datasources-181"><span class="linenos">181</span></a>
</span><span id="DataExtractorTool.load_datasources-182"><a href="#DataExtractorTool.load_datasources-182"><span class="linenos">182</span></a><span class="sd">        Clears any previously loaded sources and parses the selected configuration file,</span>
</span><span id="DataExtractorTool.load_datasources-183"><a href="#DataExtractorTool.load_datasources-183"><span class="linenos">183</span></a><span class="sd">        instantiating the appropriate data source classes. If no file is provided, the user</span>
</span><span id="DataExtractorTool.load_datasources-184"><a href="#DataExtractorTool.load_datasources-184"><span class="linenos">184</span></a><span class="sd">        is prompted to select one interactively from the available files in the config directory.</span>
</span><span id="DataExtractorTool.load_datasources-185"><a href="#DataExtractorTool.load_datasources-185"><span class="linenos">185</span></a>
</span><span id="DataExtractorTool.load_datasources-186"><a href="#DataExtractorTool.load_datasources-186"><span class="linenos">186</span></a><span class="sd">        ### Args</span>
</span><span id="DataExtractorTool.load_datasources-187"><a href="#DataExtractorTool.load_datasources-187"><span class="linenos">187</span></a><span class="sd">        - **file_cfg** (`Optional[str]`): Path to the YAML configuration file. If `None`, prompts the user to select one.</span>
</span><span id="DataExtractorTool.load_datasources-188"><a href="#DataExtractorTool.load_datasources-188"><span class="linenos">188</span></a><span class="sd">        - **quiet** (`bool`): If `True`, suppresses console output messages.</span>
</span><span id="DataExtractorTool.load_datasources-189"><a href="#DataExtractorTool.load_datasources-189"><span class="linenos">189</span></a>
</span><span id="DataExtractorTool.load_datasources-190"><a href="#DataExtractorTool.load_datasources-190"><span class="linenos">190</span></a><span class="sd">        ### Notes</span>
</span><span id="DataExtractorTool.load_datasources-191"><a href="#DataExtractorTool.load_datasources-191"><span class="linenos">191</span></a><span class="sd">        - Prevents loading if the extractor process is currently running.</span>
</span><span id="DataExtractorTool.load_datasources-192"><a href="#DataExtractorTool.load_datasources-192"><span class="linenos">192</span></a><span class="sd">        - Supports graceful cancellation via **Ctrl+C**.</span>
</span><span id="DataExtractorTool.load_datasources-193"><a href="#DataExtractorTool.load_datasources-193"><span class="linenos">193</span></a><span class="sd">        - Automatically creates missing log files if required by a `FileLogDataSource`.</span>
</span><span id="DataExtractorTool.load_datasources-194"><a href="#DataExtractorTool.load_datasources-194"><span class="linenos">194</span></a><span class="sd">        - Displays success or error messages for each data source loaded.</span>
</span><span id="DataExtractorTool.load_datasources-195"><a href="#DataExtractorTool.load_datasources-195"><span class="linenos">195</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.load_datasources-196"><a href="#DataExtractorTool.load_datasources-196"><span class="linenos">196</span></a>
</span><span id="DataExtractorTool.load_datasources-197"><a href="#DataExtractorTool.load_datasources-197"><span class="linenos">197</span></a>
</span><span id="DataExtractorTool.load_datasources-198"><a href="#DataExtractorTool.load_datasources-198"><span class="linenos">198</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Sources Configuration&quot;</span><span class="p">,</span> <span class="s2">&quot;🛢️&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-199"><a href="#DataExtractorTool.load_datasources-199"><span class="linenos">199</span></a>
</span><span id="DataExtractorTool.load_datasources-200"><a href="#DataExtractorTool.load_datasources-200"><span class="linenos">200</span></a>        <span class="c1"># Prevent loading if extractor is running</span>
</span><span id="DataExtractorTool.load_datasources-201"><a href="#DataExtractorTool.load_datasources-201"><span class="linenos">201</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool.load_datasources-202"><a href="#DataExtractorTool.load_datasources-202"><span class="linenos">202</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Data extractor is running already.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-203"><a href="#DataExtractorTool.load_datasources-203"><span class="linenos">203</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool.load_datasources-204"><a href="#DataExtractorTool.load_datasources-204"><span class="linenos">204</span></a>
</span><span id="DataExtractorTool.load_datasources-205"><a href="#DataExtractorTool.load_datasources-205"><span class="linenos">205</span></a>        <span class="c1"># Clear previously loaded data sources</span>
</span><span id="DataExtractorTool.load_datasources-206"><a href="#DataExtractorTool.load_datasources-206"><span class="linenos">206</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-207"><a href="#DataExtractorTool.load_datasources-207"><span class="linenos">207</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="s2">&quot;Deleting previous data sources.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-208"><a href="#DataExtractorTool.load_datasources-208"><span class="linenos">208</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DataExtractorTool.load_datasources-209"><a href="#DataExtractorTool.load_datasources-209"><span class="linenos">209</span></a>
</span><span id="DataExtractorTool.load_datasources-210"><a href="#DataExtractorTool.load_datasources-210"><span class="linenos">210</span></a>        <span class="c1"># Determine configuration file path</span>
</span><span id="DataExtractorTool.load_datasources-211"><a href="#DataExtractorTool.load_datasources-211"><span class="linenos">211</span></a>        <span class="k">if</span> <span class="n">file_cfg</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-212"><a href="#DataExtractorTool.load_datasources-212"><span class="linenos">212</span></a>            <span class="n">config_files</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">)</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s2">&quot;*.yaml&quot;</span><span class="p">)]</span>
</span><span id="DataExtractorTool.load_datasources-213"><a href="#DataExtractorTool.load_datasources-213"><span class="linenos">213</span></a>
</span><span id="DataExtractorTool.load_datasources-214"><a href="#DataExtractorTool.load_datasources-214"><span class="linenos">214</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">config_files</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-215"><a href="#DataExtractorTool.load_datasources-215"><span class="linenos">215</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;No data sources files found in &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-216"><a href="#DataExtractorTool.load_datasources-216"><span class="linenos">216</span></a>                <span class="k">return</span>
</span><span id="DataExtractorTool.load_datasources-217"><a href="#DataExtractorTool.load_datasources-217"><span class="linenos">217</span></a>
</span><span id="DataExtractorTool.load_datasources-218"><a href="#DataExtractorTool.load_datasources-218"><span class="linenos">218</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-219"><a href="#DataExtractorTool.load_datasources-219"><span class="linenos">219</span></a>                <span class="n">choices</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DataExtractorTool.load_datasources-220"><a href="#DataExtractorTool.load_datasources-220"><span class="linenos">220</span></a>                    <span class="p">{</span><span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">. 📄 </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">:</span> <span class="n">name</span><span class="p">}</span>
</span><span id="DataExtractorTool.load_datasources-221"><a href="#DataExtractorTool.load_datasources-221"><span class="linenos">221</span></a>                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">sorted</span><span class="p">(</span><span class="n">config_files</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-222"><a href="#DataExtractorTool.load_datasources-222"><span class="linenos">222</span></a>                <span class="p">]</span>
</span><span id="DataExtractorTool.load_datasources-223"><a href="#DataExtractorTool.load_datasources-223"><span class="linenos">223</span></a>
</span><span id="DataExtractorTool.load_datasources-224"><a href="#DataExtractorTool.load_datasources-224"><span class="linenos">224</span></a>                <span class="n">selected</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_select_menu</span><span class="p">(</span>
</span><span id="DataExtractorTool.load_datasources-225"><a href="#DataExtractorTool.load_datasources-225"><span class="linenos">225</span></a>                    <span class="n">choices</span><span class="o">=</span><span class="n">choices</span><span class="p">,</span>
</span><span id="DataExtractorTool.load_datasources-226"><a href="#DataExtractorTool.load_datasources-226"><span class="linenos">226</span></a>                    <span class="n">message</span><span class="o">=</span><span class="s2">&quot;Available Data Sources Files:&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool.load_datasources-227"><a href="#DataExtractorTool.load_datasources-227"><span class="linenos">227</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span>
</span><span id="DataExtractorTool.load_datasources-228"><a href="#DataExtractorTool.load_datasources-228"><span class="linenos">228</span></a>                <span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-229"><a href="#DataExtractorTool.load_datasources-229"><span class="linenos">229</span></a>
</span><span id="DataExtractorTool.load_datasources-230"><a href="#DataExtractorTool.load_datasources-230"><span class="linenos">230</span></a>                <span class="n">filepath_cfg</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config_dir</span><span class="p">)</span> <span class="o">/</span> <span class="n">selected</span>
</span><span id="DataExtractorTool.load_datasources-231"><a href="#DataExtractorTool.load_datasources-231"><span class="linenos">231</span></a>
</span><span id="DataExtractorTool.load_datasources-232"><a href="#DataExtractorTool.load_datasources-232"><span class="linenos">232</span></a>            <span class="k">except</span> <span class="ne">KeyboardInterrupt</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-233"><a href="#DataExtractorTool.load_datasources-233"><span class="linenos">233</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;Operation cancelled by user.&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-234"><a href="#DataExtractorTool.load_datasources-234"><span class="linenos">234</span></a>                <span class="k">return</span>
</span><span id="DataExtractorTool.load_datasources-235"><a href="#DataExtractorTool.load_datasources-235"><span class="linenos">235</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-236"><a href="#DataExtractorTool.load_datasources-236"><span class="linenos">236</span></a>            <span class="n">filepath_cfg</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">file_cfg</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-237"><a href="#DataExtractorTool.load_datasources-237"><span class="linenos">237</span></a>
</span><span id="DataExtractorTool.load_datasources-238"><a href="#DataExtractorTool.load_datasources-238"><span class="linenos">238</span></a>        <span class="c1"># Load YAML configuration</span>
</span><span id="DataExtractorTool.load_datasources-239"><a href="#DataExtractorTool.load_datasources-239"><span class="linenos">239</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filepath_cfg</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-240"><a href="#DataExtractorTool.load_datasources-240"><span class="linenos">240</span></a>            <span class="n">yaml_data</span> <span class="o">=</span> <span class="n">yaml</span><span class="o">.</span><span class="n">safe_load</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-241"><a href="#DataExtractorTool.load_datasources-241"><span class="linenos">241</span></a>            <span class="n">data</span> <span class="o">=</span> <span class="n">yaml_data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dext_datasources&quot;</span><span class="p">,</span> <span class="p">{})</span>
</span><span id="DataExtractorTool.load_datasources-242"><a href="#DataExtractorTool.load_datasources-242"><span class="linenos">242</span></a>
</span><span id="DataExtractorTool.load_datasources-243"><a href="#DataExtractorTool.load_datasources-243"><span class="linenos">243</span></a>        <span class="c1"># Parse each data source entry</span>
</span><span id="DataExtractorTool.load_datasources-244"><a href="#DataExtractorTool.load_datasources-244"><span class="linenos">244</span></a>        <span class="k">for</span> <span class="n">source_name</span><span class="p">,</span> <span class="n">source_info</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
</span><span id="DataExtractorTool.load_datasources-245"><a href="#DataExtractorTool.load_datasources-245"><span class="linenos">245</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-246"><a href="#DataExtractorTool.load_datasources-246"><span class="linenos">246</span></a>                <span class="n">data_class</span> <span class="o">=</span> <span class="n">source_info</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;data_class&#39;</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-247"><a href="#DataExtractorTool.load_datasources-247"><span class="linenos">247</span></a>
</span><span id="DataExtractorTool.load_datasources-248"><a href="#DataExtractorTool.load_datasources-248"><span class="linenos">248</span></a>                <span class="k">if</span> <span class="n">data_class</span> <span class="o">==</span> <span class="s1">&#39;FileLogDataSource&#39;</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-249"><a href="#DataExtractorTool.load_datasources-249"><span class="linenos">249</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loading FileLogDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-250"><a href="#DataExtractorTool.load_datasources-250"><span class="linenos">250</span></a>
</span><span id="DataExtractorTool.load_datasources-251"><a href="#DataExtractorTool.load_datasources-251"><span class="linenos">251</span></a>                    <span class="n">log_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;filepath&quot;</span><span class="p">])</span>
</span><span id="DataExtractorTool.load_datasources-252"><a href="#DataExtractorTool.load_datasources-252"><span class="linenos">252</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">log_path</span><span class="o">.</span><span class="n">is_file</span><span class="p">():</span>
</span><span id="DataExtractorTool.load_datasources-253"><a href="#DataExtractorTool.load_datasources-253"><span class="linenos">253</span></a>                        <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> 
</span><span id="DataExtractorTool.load_datasources-254"><a href="#DataExtractorTool.load_datasources-254"><span class="linenos">254</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Log file not found: </span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-255"><a href="#DataExtractorTool.load_datasources-255"><span class="linenos">255</span></a>                            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Creating log file: </span><span class="si">{</span><span class="n">log_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-256"><a href="#DataExtractorTool.load_datasources-256"><span class="linenos">256</span></a>                        <span class="n">log_path</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-257"><a href="#DataExtractorTool.load_datasources-257"><span class="linenos">257</span></a>                        <span class="n">log_path</span><span class="o">.</span><span class="n">touch</span><span class="p">()</span>
</span><span id="DataExtractorTool.load_datasources-258"><a href="#DataExtractorTool.load_datasources-258"><span class="linenos">258</span></a>
</span><span id="DataExtractorTool.load_datasources-259"><a href="#DataExtractorTool.load_datasources-259"><span class="linenos">259</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="DataExtractorTool.load_datasources-260"><a href="#DataExtractorTool.load_datasources-260"><span class="linenos">260</span></a>                        <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">dsources</span><span class="o">.</span><span class="n">FileLogDataSource</span><span class="p">,</span>
</span><span id="DataExtractorTool.load_datasources-261"><a href="#DataExtractorTool.load_datasources-261"><span class="linenos">261</span></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">source_name</span><span class="p">,</span>
</span><span id="DataExtractorTool.load_datasources-262"><a href="#DataExtractorTool.load_datasources-262"><span class="linenos">262</span></a>                        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DataExtractorTool.load_datasources-263"><a href="#DataExtractorTool.load_datasources-263"><span class="linenos">263</span></a>                            <span class="s2">&quot;pattern&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;pattern&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool.load_datasources-264"><a href="#DataExtractorTool.load_datasources-264"><span class="linenos">264</span></a>                            <span class="s2">&quot;filepath&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-265"><a href="#DataExtractorTool.load_datasources-265"><span class="linenos">265</span></a>                        <span class="p">}</span>
</span><span id="DataExtractorTool.load_datasources-266"><a href="#DataExtractorTool.load_datasources-266"><span class="linenos">266</span></a>                    <span class="p">})</span>
</span><span id="DataExtractorTool.load_datasources-267"><a href="#DataExtractorTool.load_datasources-267"><span class="linenos">267</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loaded FileLogDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-268"><a href="#DataExtractorTool.load_datasources-268"><span class="linenos">268</span></a>
</span><span id="DataExtractorTool.load_datasources-269"><a href="#DataExtractorTool.load_datasources-269"><span class="linenos">269</span></a>                <span class="k">elif</span> <span class="n">data_class</span> <span class="o">==</span> <span class="s2">&quot;PPSAnalyzerDataSource&quot;</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-270"><a href="#DataExtractorTool.load_datasources-270"><span class="linenos">270</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loading PPSAnalyzerDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-271"><a href="#DataExtractorTool.load_datasources-271"><span class="linenos">271</span></a>
</span><span id="DataExtractorTool.load_datasources-272"><a href="#DataExtractorTool.load_datasources-272"><span class="linenos">272</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
</span><span id="DataExtractorTool.load_datasources-273"><a href="#DataExtractorTool.load_datasources-273"><span class="linenos">273</span></a>                        <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">dsources</span><span class="o">.</span><span class="n">PPSAnalyzerDataSource</span><span class="p">,</span>
</span><span id="DataExtractorTool.load_datasources-274"><a href="#DataExtractorTool.load_datasources-274"><span class="linenos">274</span></a>                        <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">source_name</span><span class="p">,</span>
</span><span id="DataExtractorTool.load_datasources-275"><a href="#DataExtractorTool.load_datasources-275"><span class="linenos">275</span></a>                        <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DataExtractorTool.load_datasources-276"><a href="#DataExtractorTool.load_datasources-276"><span class="linenos">276</span></a>                            <span class="s2">&quot;serial_port&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;serial_port&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool.load_datasources-277"><a href="#DataExtractorTool.load_datasources-277"><span class="linenos">277</span></a>                            <span class="s2">&quot;pps_inputs&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;pps_inputs&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool.load_datasources-278"><a href="#DataExtractorTool.load_datasources-278"><span class="linenos">278</span></a>                            <span class="s2">&quot;cable_delays&quot;</span><span class="p">:</span> <span class="n">source_info</span><span class="p">[</span><span class="s2">&quot;cable_delays&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool.load_datasources-279"><a href="#DataExtractorTool.load_datasources-279"><span class="linenos">279</span></a>                        <span class="p">}</span>
</span><span id="DataExtractorTool.load_datasources-280"><a href="#DataExtractorTool.load_datasources-280"><span class="linenos">280</span></a>                    <span class="p">})</span>
</span><span id="DataExtractorTool.load_datasources-281"><a href="#DataExtractorTool.load_datasources-281"><span class="linenos">281</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Loaded PPSAnalyzerDataSource config: </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-282"><a href="#DataExtractorTool.load_datasources-282"><span class="linenos">282</span></a>
</span><span id="DataExtractorTool.load_datasources-283"><a href="#DataExtractorTool.load_datasources-283"><span class="linenos">283</span></a>                <span class="k">else</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-284"><a href="#DataExtractorTool.load_datasources-284"><span class="linenos">284</span></a>                    <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Unknown Data Source: </span><span class="si">{</span><span class="n">data_class</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-285"><a href="#DataExtractorTool.load_datasources-285"><span class="linenos">285</span></a>
</span><span id="DataExtractorTool.load_datasources-286"><a href="#DataExtractorTool.load_datasources-286"><span class="linenos">286</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-287"><a href="#DataExtractorTool.load_datasources-287"><span class="linenos">287</span></a>                <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;error&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Error loading </span><span class="si">{</span><span class="n">source_name</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">data_class</span><span class="si">}</span><span class="s2">): </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.load_datasources-288"><a href="#DataExtractorTool.load_datasources-288"><span class="linenos">288</span></a>
</span><span id="DataExtractorTool.load_datasources-289"><a href="#DataExtractorTool.load_datasources-289"><span class="linenos">289</span></a>        <span class="c1"># Final confirmation</span>
</span><span id="DataExtractorTool.load_datasources-290"><a href="#DataExtractorTool.load_datasources-290"><span class="linenos">290</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span>
</span><span id="DataExtractorTool.load_datasources-291"><a href="#DataExtractorTool.load_datasources-291"><span class="linenos">291</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">quiet</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Data Sources successfully loaded from </span><span class="si">{</span><span class="n">filepath_cfg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Load and configure data sources from a YAML configuration file.</p>

<p>Clears any previously loaded sources and parses the selected configuration file,
instantiating the appropriate data source classes. If no file is provided, the user
is prompted to select one interactively from the available files in the config directory.</p>

<h3 id="args">Args</h3>

<ul>
<li><strong>file_cfg</strong> (<code>Optional[str]</code>): Path to the YAML configuration file. If <code>None</code>, prompts the user to select one.</li>
<li><strong>quiet</strong> (<code>bool</code>): If <code>True</code>, suppresses console output messages.</li>
</ul>

<h3 id="notes">Notes</h3>

<ul>
<li>Prevents loading if the extractor process is currently running.</li>
<li>Supports graceful cancellation via <strong>Ctrl+C</strong>.</li>
<li>Automatically creates missing log files if required by a <code>FileLogDataSource</code>.</li>
<li>Displays success or error messages for each data source loaded.</li>
</ul>
</div>


                            </div>
                            <div id="DataExtractorTool.start_extraction" class="classattr">
                                        <input id="DataExtractorTool.start_extraction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">start_extraction</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">suffix_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">dir_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">duration_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>,</span><span class="param">	<span class="n">logger</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DataExtractorTool.start_extraction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataExtractorTool.start_extraction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataExtractorTool.start_extraction-298"><a href="#DataExtractorTool.start_extraction-298"><span class="linenos">298</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">start_extraction</span><span class="p">(</span>
</span><span id="DataExtractorTool.start_extraction-299"><a href="#DataExtractorTool.start_extraction-299"><span class="linenos">299</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-300"><a href="#DataExtractorTool.start_extraction-300"><span class="linenos">300</span></a>        <span class="n">suffix_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-301"><a href="#DataExtractorTool.start_extraction-301"><span class="linenos">301</span></a>        <span class="n">dir_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-302"><a href="#DataExtractorTool.start_extraction-302"><span class="linenos">302</span></a>        <span class="n">duration_out</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-303"><a href="#DataExtractorTool.start_extraction-303"><span class="linenos">303</span></a>        <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-304"><a href="#DataExtractorTool.start_extraction-304"><span class="linenos">304</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DataExtractorTool.start_extraction-305"><a href="#DataExtractorTool.start_extraction-305"><span class="linenos">305</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.start_extraction-306"><a href="#DataExtractorTool.start_extraction-306"><span class="linenos">306</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.start_extraction-307"><a href="#DataExtractorTool.start_extraction-307"><span class="linenos">307</span></a><span class="sd">        Start the data extraction process using the configured data sources.</span>
</span><span id="DataExtractorTool.start_extraction-308"><a href="#DataExtractorTool.start_extraction-308"><span class="linenos">308</span></a>
</span><span id="DataExtractorTool.start_extraction-309"><a href="#DataExtractorTool.start_extraction-309"><span class="linenos">309</span></a><span class="sd">        Launches a background writer process that collects metrics and stores them</span>
</span><span id="DataExtractorTool.start_extraction-310"><a href="#DataExtractorTool.start_extraction-310"><span class="linenos">310</span></a><span class="sd">        in a CSV file. A YAML summary file is also generated, containing metadata</span>
</span><span id="DataExtractorTool.start_extraction-311"><a href="#DataExtractorTool.start_extraction-311"><span class="linenos">311</span></a><span class="sd">        about the extraction session.</span>
</span><span id="DataExtractorTool.start_extraction-312"><a href="#DataExtractorTool.start_extraction-312"><span class="linenos">312</span></a>
</span><span id="DataExtractorTool.start_extraction-313"><a href="#DataExtractorTool.start_extraction-313"><span class="linenos">313</span></a><span class="sd">        ### Args</span>
</span><span id="DataExtractorTool.start_extraction-314"><a href="#DataExtractorTool.start_extraction-314"><span class="linenos">314</span></a><span class="sd">        - **suffix_out** (`Optional[str]`): Suffix for the output CSV file name. If `None`, the user is prompted.</span>
</span><span id="DataExtractorTool.start_extraction-315"><a href="#DataExtractorTool.start_extraction-315"><span class="linenos">315</span></a><span class="sd">        - **dir_out** (`Optional[str]`): Directory where output files will be saved. If `None`, defaults to the configured output directory.</span>
</span><span id="DataExtractorTool.start_extraction-316"><a href="#DataExtractorTool.start_extraction-316"><span class="linenos">316</span></a><span class="sd">        - **duration_out** (`Optional[int]`): Duration of the extraction in seconds. If `None`, the user is prompted.</span>
</span><span id="DataExtractorTool.start_extraction-317"><a href="#DataExtractorTool.start_extraction-317"><span class="linenos">317</span></a><span class="sd">        - **logger**: Optional logger instance for logging messages.</span>
</span><span id="DataExtractorTool.start_extraction-318"><a href="#DataExtractorTool.start_extraction-318"><span class="linenos">318</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages.</span>
</span><span id="DataExtractorTool.start_extraction-319"><a href="#DataExtractorTool.start_extraction-319"><span class="linenos">319</span></a>
</span><span id="DataExtractorTool.start_extraction-320"><a href="#DataExtractorTool.start_extraction-320"><span class="linenos">320</span></a><span class="sd">        ### Notes</span>
</span><span id="DataExtractorTool.start_extraction-321"><a href="#DataExtractorTool.start_extraction-321"><span class="linenos">321</span></a><span class="sd">        - Prevents starting a new extraction if a writer process is already running.</span>
</span><span id="DataExtractorTool.start_extraction-322"><a href="#DataExtractorTool.start_extraction-322"><span class="linenos">322</span></a><span class="sd">        - Prompts the user interactively for missing parameters unless provided.</span>
</span><span id="DataExtractorTool.start_extraction-323"><a href="#DataExtractorTool.start_extraction-323"><span class="linenos">323</span></a><span class="sd">        - Automatically creates missing output directories and log files.</span>
</span><span id="DataExtractorTool.start_extraction-324"><a href="#DataExtractorTool.start_extraction-324"><span class="linenos">324</span></a><span class="sd">        - Saves extraction metadata to a YAML file alongside the CSV output.</span>
</span><span id="DataExtractorTool.start_extraction-325"><a href="#DataExtractorTool.start_extraction-325"><span class="linenos">325</span></a><span class="sd">        - Displays process details including PID, start time, duration, and assigned data sources.</span>
</span><span id="DataExtractorTool.start_extraction-326"><a href="#DataExtractorTool.start_extraction-326"><span class="linenos">326</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.start_extraction-327"><a href="#DataExtractorTool.start_extraction-327"><span class="linenos">327</span></a>
</span><span id="DataExtractorTool.start_extraction-328"><a href="#DataExtractorTool.start_extraction-328"><span class="linenos">328</span></a>        <span class="c1"># Prevent starting if a writer process is already running</span>
</span><span id="DataExtractorTool.start_extraction-329"><a href="#DataExtractorTool.start_extraction-329"><span class="linenos">329</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool.start_extraction-330"><a href="#DataExtractorTool.start_extraction-330"><span class="linenos">330</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="DataExtractorTool.start_extraction-331"><a href="#DataExtractorTool.start_extraction-331"><span class="linenos">331</span></a>                <span class="s2">&quot;caution&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-332"><a href="#DataExtractorTool.start_extraction-332"><span class="linenos">332</span></a>                <span class="sa">f</span><span class="s2">&quot;A writer process is already running with PID </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2">.&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-333"><a href="#DataExtractorTool.start_extraction-333"><span class="linenos">333</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-334"><a href="#DataExtractorTool.start_extraction-334"><span class="linenos">334</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="DataExtractorTool.start_extraction-335"><a href="#DataExtractorTool.start_extraction-335"><span class="linenos">335</span></a>            <span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-336"><a href="#DataExtractorTool.start_extraction-336"><span class="linenos">336</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="DataExtractorTool.start_extraction-337"><a href="#DataExtractorTool.start_extraction-337"><span class="linenos">337</span></a>                <span class="s2">&quot;info&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-338"><a href="#DataExtractorTool.start_extraction-338"><span class="linenos">338</span></a>                <span class="s2">&quot;To start a new extraction it is necessary to manually stop extraction from menu.&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-339"><a href="#DataExtractorTool.start_extraction-339"><span class="linenos">339</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-340"><a href="#DataExtractorTool.start_extraction-340"><span class="linenos">340</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="DataExtractorTool.start_extraction-341"><a href="#DataExtractorTool.start_extraction-341"><span class="linenos">341</span></a>            <span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-342"><a href="#DataExtractorTool.start_extraction-342"><span class="linenos">342</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool.start_extraction-343"><a href="#DataExtractorTool.start_extraction-343"><span class="linenos">343</span></a>
</span><span id="DataExtractorTool.start_extraction-344"><a href="#DataExtractorTool.start_extraction-344"><span class="linenos">344</span></a>        <span class="c1"># Ensure data sources are loaded</span>
</span><span id="DataExtractorTool.start_extraction-345"><a href="#DataExtractorTool.start_extraction-345"><span class="linenos">345</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span><span class="p">:</span>
</span><span id="DataExtractorTool.start_extraction-346"><a href="#DataExtractorTool.start_extraction-346"><span class="linenos">346</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="DataExtractorTool.start_extraction-347"><a href="#DataExtractorTool.start_extraction-347"><span class="linenos">347</span></a>                <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-348"><a href="#DataExtractorTool.start_extraction-348"><span class="linenos">348</span></a>                <span class="s2">&quot;No data sources registered. Cannot start extraction.&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-349"><a href="#DataExtractorTool.start_extraction-349"><span class="linenos">349</span></a>                <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-350"><a href="#DataExtractorTool.start_extraction-350"><span class="linenos">350</span></a>                <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="DataExtractorTool.start_extraction-351"><a href="#DataExtractorTool.start_extraction-351"><span class="linenos">351</span></a>            <span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-352"><a href="#DataExtractorTool.start_extraction-352"><span class="linenos">352</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool.start_extraction-353"><a href="#DataExtractorTool.start_extraction-353"><span class="linenos">353</span></a>
</span><span id="DataExtractorTool.start_extraction-354"><a href="#DataExtractorTool.start_extraction-354"><span class="linenos">354</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Starting extraction&quot;</span><span class="p">,</span> <span class="s2">&quot;📈&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-355"><a href="#DataExtractorTool.start_extraction-355"><span class="linenos">355</span></a>
</span><span id="DataExtractorTool.start_extraction-356"><a href="#DataExtractorTool.start_extraction-356"><span class="linenos">356</span></a>        <span class="c1"># Prompt user for suffix and duration if not provided</span>
</span><span id="DataExtractorTool.start_extraction-357"><a href="#DataExtractorTool.start_extraction-357"><span class="linenos">357</span></a>        <span class="k">if</span> <span class="n">suffix_out</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.start_extraction-358"><a href="#DataExtractorTool.start_extraction-358"><span class="linenos">358</span></a>            <span class="n">suffix</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">Prompt</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;📁 Enter a suffix for the output CSV file&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;metrics&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-359"><a href="#DataExtractorTool.start_extraction-359"><span class="linenos">359</span></a>            <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">IntPrompt</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⏱️ Enter duration in seconds&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">60</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-360"><a href="#DataExtractorTool.start_extraction-360"><span class="linenos">360</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DataExtractorTool.start_extraction-361"><a href="#DataExtractorTool.start_extraction-361"><span class="linenos">361</span></a>            <span class="n">suffix</span> <span class="o">=</span> <span class="n">suffix_out</span>
</span><span id="DataExtractorTool.start_extraction-362"><a href="#DataExtractorTool.start_extraction-362"><span class="linenos">362</span></a>            <span class="n">duration</span> <span class="o">=</span> <span class="n">duration_out</span> <span class="k">if</span> <span class="n">duration_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="mi">60</span>
</span><span id="DataExtractorTool.start_extraction-363"><a href="#DataExtractorTool.start_extraction-363"><span class="linenos">363</span></a>
</span><span id="DataExtractorTool.start_extraction-364"><a href="#DataExtractorTool.start_extraction-364"><span class="linenos">364</span></a>        <span class="c1"># Update output directory if provided</span>
</span><span id="DataExtractorTool.start_extraction-365"><a href="#DataExtractorTool.start_extraction-365"><span class="linenos">365</span></a>        <span class="k">if</span> <span class="n">dir_out</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.start_extraction-366"><a href="#DataExtractorTool.start_extraction-366"><span class="linenos">366</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dir_out</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-367"><a href="#DataExtractorTool.start_extraction-367"><span class="linenos">367</span></a>
</span><span id="DataExtractorTool.start_extraction-368"><a href="#DataExtractorTool.start_extraction-368"><span class="linenos">368</span></a>        <span class="c1"># Record start time and calculate planned end time</span>
</span><span id="DataExtractorTool.start_extraction-369"><a href="#DataExtractorTool.start_extraction-369"><span class="linenos">369</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="DataExtractorTool.start_extraction-370"><a href="#DataExtractorTool.start_extraction-370"><span class="linenos">370</span></a>        <span class="n">start_time_hr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y %H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-371"><a href="#DataExtractorTool.start_extraction-371"><span class="linenos">371</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="n">duration</span>
</span><span id="DataExtractorTool.start_extraction-372"><a href="#DataExtractorTool.start_extraction-372"><span class="linenos">372</span></a>        <span class="n">planned_end_time</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span>
</span><span id="DataExtractorTool.start_extraction-373"><a href="#DataExtractorTool.start_extraction-373"><span class="linenos">373</span></a>        <span class="n">planned_end_time_hr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">planned_end_time</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y %H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-374"><a href="#DataExtractorTool.start_extraction-374"><span class="linenos">374</span></a>
</span><span id="DataExtractorTool.start_extraction-375"><a href="#DataExtractorTool.start_extraction-375"><span class="linenos">375</span></a>        <span class="c1"># Create output file path with timestamp</span>
</span><span id="DataExtractorTool.start_extraction-376"><a href="#DataExtractorTool.start_extraction-376"><span class="linenos">376</span></a>        <span class="n">output_filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">.csv&quot;</span>
</span><span id="DataExtractorTool.start_extraction-377"><a href="#DataExtractorTool.start_extraction-377"><span class="linenos">377</span></a>        <span class="n">output_filepath</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-378"><a href="#DataExtractorTool.start_extraction-378"><span class="linenos">378</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">output_filepath</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-379"><a href="#DataExtractorTool.start_extraction-379"><span class="linenos">379</span></a>
</span><span id="DataExtractorTool.start_extraction-380"><a href="#DataExtractorTool.start_extraction-380"><span class="linenos">380</span></a>        <span class="c1"># Prepare data source configurations for the writer process</span>
</span><span id="DataExtractorTool.start_extraction-381"><a href="#DataExtractorTool.start_extraction-381"><span class="linenos">381</span></a>        <span class="n">source_configs</span> <span class="o">=</span> <span class="p">[</span>
</span><span id="DataExtractorTool.start_extraction-382"><a href="#DataExtractorTool.start_extraction-382"><span class="linenos">382</span></a>            <span class="p">{</span>
</span><span id="DataExtractorTool.start_extraction-383"><a href="#DataExtractorTool.start_extraction-383"><span class="linenos">383</span></a>                <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool.start_extraction-384"><a href="#DataExtractorTool.start_extraction-384"><span class="linenos">384</span></a>                <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">],</span>
</span><span id="DataExtractorTool.start_extraction-385"><a href="#DataExtractorTool.start_extraction-385"><span class="linenos">385</span></a>                <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
</span><span id="DataExtractorTool.start_extraction-386"><a href="#DataExtractorTool.start_extraction-386"><span class="linenos">386</span></a>            <span class="p">}</span>
</span><span id="DataExtractorTool.start_extraction-387"><a href="#DataExtractorTool.start_extraction-387"><span class="linenos">387</span></a>            <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span>
</span><span id="DataExtractorTool.start_extraction-388"><a href="#DataExtractorTool.start_extraction-388"><span class="linenos">388</span></a>        <span class="p">]</span>
</span><span id="DataExtractorTool.start_extraction-389"><a href="#DataExtractorTool.start_extraction-389"><span class="linenos">389</span></a>
</span><span id="DataExtractorTool.start_extraction-390"><a href="#DataExtractorTool.start_extraction-390"><span class="linenos">390</span></a>        <span class="c1"># Save extractor parameters to a YAML file</span>
</span><span id="DataExtractorTool.start_extraction-391"><a href="#DataExtractorTool.start_extraction-391"><span class="linenos">391</span></a>        <span class="n">extractor_output</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DataExtractorTool.start_extraction-392"><a href="#DataExtractorTool.start_extraction-392"><span class="linenos">392</span></a>            <span class="s2">&quot;datasources&quot;</span><span class="p">:</span> <span class="p">{</span>
</span><span id="DataExtractorTool.start_extraction-393"><a href="#DataExtractorTool.start_extraction-393"><span class="linenos">393</span></a>                <span class="n">source</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]:</span> <span class="p">{</span>
</span><span id="DataExtractorTool.start_extraction-394"><a href="#DataExtractorTool.start_extraction-394"><span class="linenos">394</span></a>                    <span class="s2">&quot;args&quot;</span><span class="p">:</span> <span class="n">source</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
</span><span id="DataExtractorTool.start_extraction-395"><a href="#DataExtractorTool.start_extraction-395"><span class="linenos">395</span></a>                <span class="p">}</span>
</span><span id="DataExtractorTool.start_extraction-396"><a href="#DataExtractorTool.start_extraction-396"><span class="linenos">396</span></a>                <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">loaded_datasources</span>
</span><span id="DataExtractorTool.start_extraction-397"><a href="#DataExtractorTool.start_extraction-397"><span class="linenos">397</span></a>            <span class="p">},</span>
</span><span id="DataExtractorTool.start_extraction-398"><a href="#DataExtractorTool.start_extraction-398"><span class="linenos">398</span></a>            <span class="s2">&quot;duration&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-399"><a href="#DataExtractorTool.start_extraction-399"><span class="linenos">399</span></a>            <span class="s2">&quot;started_at&quot;</span><span class="p">:</span> <span class="n">start_time_hr</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-400"><a href="#DataExtractorTool.start_extraction-400"><span class="linenos">400</span></a>            <span class="s2">&quot;finished_at_planned&quot;</span><span class="p">:</span> <span class="n">planned_end_time_hr</span>
</span><span id="DataExtractorTool.start_extraction-401"><a href="#DataExtractorTool.start_extraction-401"><span class="linenos">401</span></a>        <span class="p">}</span>
</span><span id="DataExtractorTool.start_extraction-402"><a href="#DataExtractorTool.start_extraction-402"><span class="linenos">402</span></a>
</span><span id="DataExtractorTool.start_extraction-403"><a href="#DataExtractorTool.start_extraction-403"><span class="linenos">403</span></a>        <span class="n">extractor_output_filepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_dir</span> <span class="o">/</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">.yaml&quot;</span>
</span><span id="DataExtractorTool.start_extraction-404"><a href="#DataExtractorTool.start_extraction-404"><span class="linenos">404</span></a>        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">extractor_output_filepath</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="DataExtractorTool.start_extraction-405"><a href="#DataExtractorTool.start_extraction-405"><span class="linenos">405</span></a>            <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">extractor_output</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-406"><a href="#DataExtractorTool.start_extraction-406"><span class="linenos">406</span></a>
</span><span id="DataExtractorTool.start_extraction-407"><a href="#DataExtractorTool.start_extraction-407"><span class="linenos">407</span></a>        <span class="c1"># Launch the writer process</span>
</span><span id="DataExtractorTool.start_extraction-408"><a href="#DataExtractorTool.start_extraction-408"><span class="linenos">408</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Process</span><span class="p">(</span>
</span><span id="DataExtractorTool.start_extraction-409"><a href="#DataExtractorTool.start_extraction-409"><span class="linenos">409</span></a>            <span class="n">target</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">write_metrics</span><span class="p">,</span>
</span><span id="DataExtractorTool.start_extraction-410"><a href="#DataExtractorTool.start_extraction-410"><span class="linenos">410</span></a>            <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">output_filepath</span><span class="p">,</span> <span class="n">extractor_output_filepath</span><span class="p">,</span> <span class="n">duration</span><span class="p">,</span> <span class="n">source_configs</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-411"><a href="#DataExtractorTool.start_extraction-411"><span class="linenos">411</span></a>        <span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-412"><a href="#DataExtractorTool.start_extraction-412"><span class="linenos">412</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="DataExtractorTool.start_extraction-413"><a href="#DataExtractorTool.start_extraction-413"><span class="linenos">413</span></a>
</span><span id="DataExtractorTool.start_extraction-414"><a href="#DataExtractorTool.start_extraction-414"><span class="linenos">414</span></a>        <span class="c1"># Display confirmation and process details</span>
</span><span id="DataExtractorTool.start_extraction-415"><a href="#DataExtractorTool.start_extraction-415"><span class="linenos">415</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Data Extractor launched successfully.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-416"><a href="#DataExtractorTool.start_extraction-416"><span class="linenos">416</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;PID: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">pid</span><span class="si">}</span><span class="s2"> | Started at: </span><span class="si">{</span><span class="n">start_time_hr</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-417"><a href="#DataExtractorTool.start_extraction-417"><span class="linenos">417</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Duration: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="si">}</span><span class="s2"> seconds&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool.start_extraction-418"><a href="#DataExtractorTool.start_extraction-418"><span class="linenos">418</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;Data Sources assigned: </span><span class="si">{</span><span class="p">[</span><span class="n">s</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">s</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">source_configs</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">2</span><span class="o">+</span><span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Start the data extraction process using the configured data sources.</p>

<p>Launches a background writer process that collects metrics and stores them
in a CSV file. A YAML summary file is also generated, containing metadata
about the extraction session.</p>

<h3 id="args">Args</h3>

<ul>
<li><strong>suffix_out</strong> (<code>Optional[str]</code>): Suffix for the output CSV file name. If <code>None</code>, the user is prompted.</li>
<li><strong>dir_out</strong> (<code>Optional[str]</code>): Directory where output files will be saved. If <code>None</code>, defaults to the configured output directory.</li>
<li><strong>duration_out</strong> (<code>Optional[int]</code>): Duration of the extraction in seconds. If <code>None</code>, the user is prompted.</li>
<li><strong>logger</strong>: Optional logger instance for logging messages.</li>
<li><strong>extra_indent</strong> (<code>int</code>): Additional indentation level for console messages.</li>
</ul>

<h3 id="notes">Notes</h3>

<ul>
<li>Prevents starting a new extraction if a writer process is already running.</li>
<li>Prompts the user interactively for missing parameters unless provided.</li>
<li>Automatically creates missing output directories and log files.</li>
<li>Saves extraction metadata to a YAML file alongside the CSV output.</li>
<li>Displays process details including PID, start time, duration, and assigned data sources.</li>
</ul>
</div>


                            </div>
                            <div id="DataExtractorTool.write_metrics" class="classattr">
                                        <input id="DataExtractorTool.write_metrics-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">write_metrics</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">output_filepath</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>,</span><span class="param">	<span class="n">extractor_output_filepath</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>,</span><span class="param">	<span class="n">duration</span><span class="p">:</span> <span class="nb">int</span>,</span><span class="param">	<span class="n">source_configs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]]</span>,</span><span class="param">	<span class="n">logger</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DataExtractorTool.write_metrics-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataExtractorTool.write_metrics"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataExtractorTool.write_metrics-423"><a href="#DataExtractorTool.write_metrics-423"><span class="linenos">423</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">write_metrics</span><span class="p">(</span>
</span><span id="DataExtractorTool.write_metrics-424"><a href="#DataExtractorTool.write_metrics-424"><span class="linenos">424</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DataExtractorTool.write_metrics-425"><a href="#DataExtractorTool.write_metrics-425"><span class="linenos">425</span></a>        <span class="n">output_filepath</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="DataExtractorTool.write_metrics-426"><a href="#DataExtractorTool.write_metrics-426"><span class="linenos">426</span></a>        <span class="n">extractor_output_filepath</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="DataExtractorTool.write_metrics-427"><a href="#DataExtractorTool.write_metrics-427"><span class="linenos">427</span></a>        <span class="n">duration</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="DataExtractorTool.write_metrics-428"><a href="#DataExtractorTool.write_metrics-428"><span class="linenos">428</span></a>        <span class="n">source_configs</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]],</span>
</span><span id="DataExtractorTool.write_metrics-429"><a href="#DataExtractorTool.write_metrics-429"><span class="linenos">429</span></a>        <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool.write_metrics-430"><a href="#DataExtractorTool.write_metrics-430"><span class="linenos">430</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DataExtractorTool.write_metrics-431"><a href="#DataExtractorTool.write_metrics-431"><span class="linenos">431</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-432"><a href="#DataExtractorTool.write_metrics-432"><span class="linenos">432</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.write_metrics-433"><a href="#DataExtractorTool.write_metrics-433"><span class="linenos">433</span></a><span class="sd">        Collect metrics from configured data sources and write them to a CSV file.</span>
</span><span id="DataExtractorTool.write_metrics-434"><a href="#DataExtractorTool.write_metrics-434"><span class="linenos">434</span></a>
</span><span id="DataExtractorTool.write_metrics-435"><a href="#DataExtractorTool.write_metrics-435"><span class="linenos">435</span></a><span class="sd">        Starts each data source in a separate thread and coordinates data collection</span>
</span><span id="DataExtractorTool.write_metrics-436"><a href="#DataExtractorTool.write_metrics-436"><span class="linenos">436</span></a><span class="sd">        through a shared queue. Metrics are timestamped and written to the output file.</span>
</span><span id="DataExtractorTool.write_metrics-437"><a href="#DataExtractorTool.write_metrics-437"><span class="linenos">437</span></a><span class="sd">        Upon completion, metadata is appended to a YAML summary file.</span>
</span><span id="DataExtractorTool.write_metrics-438"><a href="#DataExtractorTool.write_metrics-438"><span class="linenos">438</span></a>
</span><span id="DataExtractorTool.write_metrics-439"><a href="#DataExtractorTool.write_metrics-439"><span class="linenos">439</span></a><span class="sd">        ### Args</span>
</span><span id="DataExtractorTool.write_metrics-440"><a href="#DataExtractorTool.write_metrics-440"><span class="linenos">440</span></a><span class="sd">        - **output_filepath** (`Path`): Path to the output CSV file.</span>
</span><span id="DataExtractorTool.write_metrics-441"><a href="#DataExtractorTool.write_metrics-441"><span class="linenos">441</span></a><span class="sd">        - **extractor_output_filepath** (`Path`): Path to the YAML metadata file.</span>
</span><span id="DataExtractorTool.write_metrics-442"><a href="#DataExtractorTool.write_metrics-442"><span class="linenos">442</span></a><span class="sd">        - **duration** (`int`): Duration of the extraction process in seconds.</span>
</span><span id="DataExtractorTool.write_metrics-443"><a href="#DataExtractorTool.write_metrics-443"><span class="linenos">443</span></a><span class="sd">        - **source_configs** (`List[Dict[str, Any]]`): Configuration for each data source.</span>
</span><span id="DataExtractorTool.write_metrics-444"><a href="#DataExtractorTool.write_metrics-444"><span class="linenos">444</span></a><span class="sd">        - **logger**: Optional logger instance for logging messages.</span>
</span><span id="DataExtractorTool.write_metrics-445"><a href="#DataExtractorTool.write_metrics-445"><span class="linenos">445</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages.</span>
</span><span id="DataExtractorTool.write_metrics-446"><a href="#DataExtractorTool.write_metrics-446"><span class="linenos">446</span></a>
</span><span id="DataExtractorTool.write_metrics-447"><a href="#DataExtractorTool.write_metrics-447"><span class="linenos">447</span></a><span class="sd">        ### Notes</span>
</span><span id="DataExtractorTool.write_metrics-448"><a href="#DataExtractorTool.write_metrics-448"><span class="linenos">448</span></a><span class="sd">        - Each data source runs in its own thread and pushes metrics to a shared queue.</span>
</span><span id="DataExtractorTool.write_metrics-449"><a href="#DataExtractorTool.write_metrics-449"><span class="linenos">449</span></a><span class="sd">        - The process ignores `SIGINT` to prevent interruption via keyboard.</span>
</span><span id="DataExtractorTool.write_metrics-450"><a href="#DataExtractorTool.write_metrics-450"><span class="linenos">450</span></a><span class="sd">        - Graceful termination is supported via `SIGTERM`.</span>
</span><span id="DataExtractorTool.write_metrics-451"><a href="#DataExtractorTool.write_metrics-451"><span class="linenos">451</span></a><span class="sd">        - Metadata including the stop time is appended to the YAML file after extraction ends.</span>
</span><span id="DataExtractorTool.write_metrics-452"><a href="#DataExtractorTool.write_metrics-452"><span class="linenos">452</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.write_metrics-453"><a href="#DataExtractorTool.write_metrics-453"><span class="linenos">453</span></a>       
</span><span id="DataExtractorTool.write_metrics-454"><a href="#DataExtractorTool.write_metrics-454"><span class="linenos">454</span></a>        <span class="c1"># Ignore SIGINT to prevent interruption from keyboard</span>
</span><span id="DataExtractorTool.write_metrics-455"><a href="#DataExtractorTool.write_metrics-455"><span class="linenos">455</span></a>        <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGINT</span><span class="p">,</span> <span class="n">signal</span><span class="o">.</span><span class="n">SIG_IGN</span><span class="p">)</span>
</span><span id="DataExtractorTool.write_metrics-456"><a href="#DataExtractorTool.write_metrics-456"><span class="linenos">456</span></a>
</span><span id="DataExtractorTool.write_metrics-457"><a href="#DataExtractorTool.write_metrics-457"><span class="linenos">457</span></a>        <span class="c1"># Graceful termination handler</span>
</span><span id="DataExtractorTool.write_metrics-458"><a href="#DataExtractorTool.write_metrics-458"><span class="linenos">458</span></a>        <span class="k">def</span><span class="w"> </span><span class="nf">handle_signal</span><span class="p">(</span><span class="n">signum</span><span class="p">,</span> <span class="n">frame</span><span class="p">):</span>
</span><span id="DataExtractorTool.write_metrics-459"><a href="#DataExtractorTool.write_metrics-459"><span class="linenos">459</span></a>            <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="DataExtractorTool.write_metrics-460"><a href="#DataExtractorTool.write_metrics-460"><span class="linenos">460</span></a>
</span><span id="DataExtractorTool.write_metrics-461"><a href="#DataExtractorTool.write_metrics-461"><span class="linenos">461</span></a>        <span class="n">signal</span><span class="o">.</span><span class="n">signal</span><span class="p">(</span><span class="n">signal</span><span class="o">.</span><span class="n">SIGTERM</span><span class="p">,</span> <span class="n">handle_signal</span><span class="p">)</span>
</span><span id="DataExtractorTool.write_metrics-462"><a href="#DataExtractorTool.write_metrics-462"><span class="linenos">462</span></a>
</span><span id="DataExtractorTool.write_metrics-463"><a href="#DataExtractorTool.write_metrics-463"><span class="linenos">463</span></a>        <span class="c1"># Shared event and queue for thread coordination</span>
</span><span id="DataExtractorTool.write_metrics-464"><a href="#DataExtractorTool.write_metrics-464"><span class="linenos">464</span></a>        <span class="n">event</span> <span class="o">=</span> <span class="n">threading</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
</span><span id="DataExtractorTool.write_metrics-465"><a href="#DataExtractorTool.write_metrics-465"><span class="linenos">465</span></a>        <span class="n">q</span><span class="p">:</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span> <span class="o">=</span> <span class="n">queue</span><span class="o">.</span><span class="n">Queue</span><span class="p">(</span><span class="n">maxsize</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
</span><span id="DataExtractorTool.write_metrics-466"><a href="#DataExtractorTool.write_metrics-466"><span class="linenos">466</span></a>
</span><span id="DataExtractorTool.write_metrics-467"><a href="#DataExtractorTool.write_metrics-467"><span class="linenos">467</span></a>        <span class="n">sources</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="DataExtractorTool.write_metrics-468"><a href="#DataExtractorTool.write_metrics-468"><span class="linenos">468</span></a>        <span class="k">for</span> <span class="n">config</span> <span class="ow">in</span> <span class="n">source_configs</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-469"><a href="#DataExtractorTool.write_metrics-469"><span class="linenos">469</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-470"><a href="#DataExtractorTool.write_metrics-470"><span class="linenos">470</span></a>                <span class="c1"># Instantiate and start each data source thread</span>
</span><span id="DataExtractorTool.write_metrics-471"><a href="#DataExtractorTool.write_metrics-471"><span class="linenos">471</span></a>                <span class="n">source_class</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">]</span>
</span><span id="DataExtractorTool.write_metrics-472"><a href="#DataExtractorTool.write_metrics-472"><span class="linenos">472</span></a>                <span class="n">name</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;name&quot;</span><span class="p">]</span>
</span><span id="DataExtractorTool.write_metrics-473"><a href="#DataExtractorTool.write_metrics-473"><span class="linenos">473</span></a>                <span class="n">args</span> <span class="o">=</span> <span class="n">config</span><span class="p">[</span><span class="s2">&quot;args&quot;</span><span class="p">]</span>
</span><span id="DataExtractorTool.write_metrics-474"><a href="#DataExtractorTool.write_metrics-474"><span class="linenos">474</span></a>                <span class="n">source</span> <span class="o">=</span> <span class="n">source_class</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">q</span><span class="p">,</span> <span class="n">event</span><span class="p">,</span> <span class="o">**</span><span class="n">args</span><span class="p">)</span>
</span><span id="DataExtractorTool.write_metrics-475"><a href="#DataExtractorTool.write_metrics-475"><span class="linenos">475</span></a>                <span class="n">source</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</span><span id="DataExtractorTool.write_metrics-476"><a href="#DataExtractorTool.write_metrics-476"><span class="linenos">476</span></a>                <span class="n">sources</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source</span><span class="p">)</span>
</span><span id="DataExtractorTool.write_metrics-477"><a href="#DataExtractorTool.write_metrics-477"><span class="linenos">477</span></a>            <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-478"><a href="#DataExtractorTool.write_metrics-478"><span class="linenos">478</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span>
</span><span id="DataExtractorTool.write_metrics-479"><a href="#DataExtractorTool.write_metrics-479"><span class="linenos">479</span></a>                    <span class="s2">&quot;error&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool.write_metrics-480"><a href="#DataExtractorTool.write_metrics-480"><span class="linenos">480</span></a>                    <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">] Error starting source: </span><span class="si">{</span><span class="n">e</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
</span><span id="DataExtractorTool.write_metrics-481"><a href="#DataExtractorTool.write_metrics-481"><span class="linenos">481</span></a>                    <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span>
</span><span id="DataExtractorTool.write_metrics-482"><a href="#DataExtractorTool.write_metrics-482"><span class="linenos">482</span></a>                    <span class="n">logger</span><span class="o">=</span><span class="n">logger</span>
</span><span id="DataExtractorTool.write_metrics-483"><a href="#DataExtractorTool.write_metrics-483"><span class="linenos">483</span></a>                <span class="p">)</span>
</span><span id="DataExtractorTool.write_metrics-484"><a href="#DataExtractorTool.write_metrics-484"><span class="linenos">484</span></a>
</span><span id="DataExtractorTool.write_metrics-485"><a href="#DataExtractorTool.write_metrics-485"><span class="linenos">485</span></a>        <span class="c1"># Open CSV file and write header</span>
</span><span id="DataExtractorTool.write_metrics-486"><a href="#DataExtractorTool.write_metrics-486"><span class="linenos">486</span></a>        <span class="k">with</span> <span class="n">output_filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">newline</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">buffering</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-487"><a href="#DataExtractorTool.write_metrics-487"><span class="linenos">487</span></a>            <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
</span><span id="DataExtractorTool.write_metrics-488"><a href="#DataExtractorTool.write_metrics-488"><span class="linenos">488</span></a>            <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="s2">&quot;timestamp&quot;</span><span class="p">,</span> <span class="s2">&quot;metric&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">])</span>
</span><span id="DataExtractorTool.write_metrics-489"><a href="#DataExtractorTool.write_metrics-489"><span class="linenos">489</span></a>
</span><span id="DataExtractorTool.write_metrics-490"><a href="#DataExtractorTool.write_metrics-490"><span class="linenos">490</span></a>            <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-491"><a href="#DataExtractorTool.write_metrics-491"><span class="linenos">491</span></a>                <span class="c1"># Collect data until duration expires or event is triggered</span>
</span><span id="DataExtractorTool.write_metrics-492"><a href="#DataExtractorTool.write_metrics-492"><span class="linenos">492</span></a>                <span class="n">t_end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">+</span> <span class="n">duration</span>
</span><span id="DataExtractorTool.write_metrics-493"><a href="#DataExtractorTool.write_metrics-493"><span class="linenos">493</span></a>                <span class="k">while</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span> <span class="o">&lt;</span> <span class="n">t_end</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
</span><span id="DataExtractorTool.write_metrics-494"><a href="#DataExtractorTool.write_metrics-494"><span class="linenos">494</span></a>                    <span class="k">try</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-495"><a href="#DataExtractorTool.write_metrics-495"><span class="linenos">495</span></a>                        <span class="n">timestamp</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span> <span class="o">=</span> <span class="n">q</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.write_metrics-496"><a href="#DataExtractorTool.write_metrics-496"><span class="linenos">496</span></a>                        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">([</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">metric</span><span class="p">,</span> <span class="n">value</span><span class="p">])</span>
</span><span id="DataExtractorTool.write_metrics-497"><a href="#DataExtractorTool.write_metrics-497"><span class="linenos">497</span></a>                    <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-498"><a href="#DataExtractorTool.write_metrics-498"><span class="linenos">498</span></a>                        <span class="k">continue</span>  <span class="c1"># No data available, continue waiting</span>
</span><span id="DataExtractorTool.write_metrics-499"><a href="#DataExtractorTool.write_metrics-499"><span class="linenos">499</span></a>            <span class="k">finally</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-500"><a href="#DataExtractorTool.write_metrics-500"><span class="linenos">500</span></a>                <span class="c1"># Signal all threads to stop</span>
</span><span id="DataExtractorTool.write_metrics-501"><a href="#DataExtractorTool.write_metrics-501"><span class="linenos">501</span></a>                <span class="n">event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
</span><span id="DataExtractorTool.write_metrics-502"><a href="#DataExtractorTool.write_metrics-502"><span class="linenos">502</span></a>                <span class="k">for</span> <span class="n">source</span> <span class="ow">in</span> <span class="n">sources</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-503"><a href="#DataExtractorTool.write_metrics-503"><span class="linenos">503</span></a>                    <span class="n">source</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span id="DataExtractorTool.write_metrics-504"><a href="#DataExtractorTool.write_metrics-504"><span class="linenos">504</span></a>
</span><span id="DataExtractorTool.write_metrics-505"><a href="#DataExtractorTool.write_metrics-505"><span class="linenos">505</span></a>                <span class="c1"># Record stop time and append to YAML metadata</span>
</span><span id="DataExtractorTool.write_metrics-506"><a href="#DataExtractorTool.write_metrics-506"><span class="linenos">506</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">stop_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</span><span id="DataExtractorTool.write_metrics-507"><a href="#DataExtractorTool.write_metrics-507"><span class="linenos">507</span></a>                <span class="n">stop_time_hr</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">stop_time</span><span class="p">)</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2">-%m-%Y %H:%M:%S&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool.write_metrics-508"><a href="#DataExtractorTool.write_metrics-508"><span class="linenos">508</span></a>
</span><span id="DataExtractorTool.write_metrics-509"><a href="#DataExtractorTool.write_metrics-509"><span class="linenos">509</span></a>                <span class="n">extractor_output</span> <span class="o">=</span> <span class="p">{</span>
</span><span id="DataExtractorTool.write_metrics-510"><a href="#DataExtractorTool.write_metrics-510"><span class="linenos">510</span></a>                    <span class="s2">&quot;finished_at&quot;</span><span class="p">:</span> <span class="n">stop_time_hr</span><span class="p">,</span>
</span><span id="DataExtractorTool.write_metrics-511"><a href="#DataExtractorTool.write_metrics-511"><span class="linenos">511</span></a>                <span class="p">}</span>
</span><span id="DataExtractorTool.write_metrics-512"><a href="#DataExtractorTool.write_metrics-512"><span class="linenos">512</span></a>                <span class="k">with</span> <span class="n">extractor_output_filepath</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">file</span><span class="p">:</span>
</span><span id="DataExtractorTool.write_metrics-513"><a href="#DataExtractorTool.write_metrics-513"><span class="linenos">513</span></a>                    <span class="n">yaml</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">extractor_output</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">sort_keys</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">default_flow_style</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">allow_unicode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Collect metrics from configured data sources and write them to a CSV file.</p>

<p>Starts each data source in a separate thread and coordinates data collection
through a shared queue. Metrics are timestamped and written to the output file.
Upon completion, metadata is appended to a YAML summary file.</p>

<h3 id="args">Args</h3>

<ul>
<li><strong>output_filepath</strong> (<code>Path</code>): Path to the output CSV file.</li>
<li><strong>extractor_output_filepath</strong> (<code>Path</code>): Path to the YAML metadata file.</li>
<li><strong>duration</strong> (<code>int</code>): Duration of the extraction process in seconds.</li>
<li><strong>source_configs</strong> (<code>List[Dict[str, Any]]</code>): Configuration for each data source.</li>
<li><strong>logger</strong>: Optional logger instance for logging messages.</li>
<li><strong>extra_indent</strong> (<code>int</code>): Additional indentation level for console messages.</li>
</ul>

<h3 id="notes">Notes</h3>

<ul>
<li>Each data source runs in its own thread and pushes metrics to a shared queue.</li>
<li>The process ignores <code>SIGINT</code> to prevent interruption via keyboard.</li>
<li>Graceful termination is supported via <code>SIGTERM</code>.</li>
<li>Metadata including the stop time is appended to the YAML file after extraction ends.</li>
</ul>
</div>


                            </div>
                            <div id="DataExtractorTool.stop_extraction" class="classattr">
                                        <input id="DataExtractorTool.stop_extraction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">stop_extraction</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">preconfirmation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>,</span><span class="param">	<span class="n">logger</span><span class="o">=</span><span class="kc">None</span>,</span><span class="param">	<span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DataExtractorTool.stop_extraction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataExtractorTool.stop_extraction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataExtractorTool.stop_extraction-519"><a href="#DataExtractorTool.stop_extraction-519"><span class="linenos">519</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">stop_extraction</span><span class="p">(</span>
</span><span id="DataExtractorTool.stop_extraction-520"><a href="#DataExtractorTool.stop_extraction-520"><span class="linenos">520</span></a>        <span class="bp">self</span><span class="p">,</span>
</span><span id="DataExtractorTool.stop_extraction-521"><a href="#DataExtractorTool.stop_extraction-521"><span class="linenos">521</span></a>        <span class="n">preconfirmation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">bool</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
</span><span id="DataExtractorTool.stop_extraction-522"><a href="#DataExtractorTool.stop_extraction-522"><span class="linenos">522</span></a>        <span class="n">logger</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span><span id="DataExtractorTool.stop_extraction-523"><a href="#DataExtractorTool.stop_extraction-523"><span class="linenos">523</span></a>        <span class="n">extra_indent</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="DataExtractorTool.stop_extraction-524"><a href="#DataExtractorTool.stop_extraction-524"><span class="linenos">524</span></a>    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.stop_extraction-525"><a href="#DataExtractorTool.stop_extraction-525"><span class="linenos">525</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.stop_extraction-526"><a href="#DataExtractorTool.stop_extraction-526"><span class="linenos">526</span></a><span class="sd">        Forcefully stops the active data extraction process and resets session metadata.</span>
</span><span id="DataExtractorTool.stop_extraction-527"><a href="#DataExtractorTool.stop_extraction-527"><span class="linenos">527</span></a>
</span><span id="DataExtractorTool.stop_extraction-528"><a href="#DataExtractorTool.stop_extraction-528"><span class="linenos">528</span></a><span class="sd">        If the writer process is running, this method optionally prompts the user for confirmation,</span>
</span><span id="DataExtractorTool.stop_extraction-529"><a href="#DataExtractorTool.stop_extraction-529"><span class="linenos">529</span></a><span class="sd">        terminates the process, and clears output-related session variables.</span>
</span><span id="DataExtractorTool.stop_extraction-530"><a href="#DataExtractorTool.stop_extraction-530"><span class="linenos">530</span></a>
</span><span id="DataExtractorTool.stop_extraction-531"><a href="#DataExtractorTool.stop_extraction-531"><span class="linenos">531</span></a><span class="sd">        ### Args:</span>
</span><span id="DataExtractorTool.stop_extraction-532"><a href="#DataExtractorTool.stop_extraction-532"><span class="linenos">532</span></a><span class="sd">        - **preconfirmation** (`Optional[bool]`): If `True`, skips the confirmation prompt. Defaults to `False`.</span>
</span><span id="DataExtractorTool.stop_extraction-533"><a href="#DataExtractorTool.stop_extraction-533"><span class="linenos">533</span></a><span class="sd">        - **logger**: Logger instance used for logging messages. Defaults to `None`.</span>
</span><span id="DataExtractorTool.stop_extraction-534"><a href="#DataExtractorTool.stop_extraction-534"><span class="linenos">534</span></a><span class="sd">        - **extra_indent** (`int`): Additional indentation level for console messages. Defaults to `0`.</span>
</span><span id="DataExtractorTool.stop_extraction-535"><a href="#DataExtractorTool.stop_extraction-535"><span class="linenos">535</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.stop_extraction-536"><a href="#DataExtractorTool.stop_extraction-536"><span class="linenos">536</span></a>
</span><span id="DataExtractorTool.stop_extraction-537"><a href="#DataExtractorTool.stop_extraction-537"><span class="linenos">537</span></a>
</span><span id="DataExtractorTool.stop_extraction-538"><a href="#DataExtractorTool.stop_extraction-538"><span class="linenos">538</span></a>        <span class="c1"># Display section title</span>
</span><span id="DataExtractorTool.stop_extraction-539"><a href="#DataExtractorTool.stop_extraction-539"><span class="linenos">539</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Stopping extraction&quot;</span><span class="p">,</span> <span class="s2">&quot;🛑&quot;</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="n">extra_indent</span><span class="p">)</span>
</span><span id="DataExtractorTool.stop_extraction-540"><a href="#DataExtractorTool.stop_extraction-540"><span class="linenos">540</span></a>
</span><span id="DataExtractorTool.stop_extraction-541"><a href="#DataExtractorTool.stop_extraction-541"><span class="linenos">541</span></a>        <span class="c1"># Check if the writer process is running</span>
</span><span id="DataExtractorTool.stop_extraction-542"><a href="#DataExtractorTool.stop_extraction-542"><span class="linenos">542</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool.stop_extraction-543"><a href="#DataExtractorTool.stop_extraction-543"><span class="linenos">543</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;No Data Extractor running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool.stop_extraction-544"><a href="#DataExtractorTool.stop_extraction-544"><span class="linenos">544</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool.stop_extraction-545"><a href="#DataExtractorTool.stop_extraction-545"><span class="linenos">545</span></a>
</span><span id="DataExtractorTool.stop_extraction-546"><a href="#DataExtractorTool.stop_extraction-546"><span class="linenos">546</span></a>        <span class="c1"># Ask user for confirmation before terminating the process</span>
</span><span id="DataExtractorTool.stop_extraction-547"><a href="#DataExtractorTool.stop_extraction-547"><span class="linenos">547</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">preconfirmation</span><span class="p">:</span>
</span><span id="DataExtractorTool.stop_extraction-548"><a href="#DataExtractorTool.stop_extraction-548"><span class="linenos">548</span></a>            <span class="n">confirm</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="n">Confirm</span><span class="o">.</span><span class="n">ask</span><span class="p">(</span><span class="s2">&quot;⚠️ Are you sure you want to forcefully stop the extraction process?&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="DataExtractorTool.stop_extraction-549"><a href="#DataExtractorTool.stop_extraction-549"><span class="linenos">549</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="n">confirm</span><span class="p">:</span>
</span><span id="DataExtractorTool.stop_extraction-550"><a href="#DataExtractorTool.stop_extraction-550"><span class="linenos">550</span></a>                <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Stop operation cancelled.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool.stop_extraction-551"><a href="#DataExtractorTool.stop_extraction-551"><span class="linenos">551</span></a>                <span class="k">return</span>
</span><span id="DataExtractorTool.stop_extraction-552"><a href="#DataExtractorTool.stop_extraction-552"><span class="linenos">552</span></a>
</span><span id="DataExtractorTool.stop_extraction-553"><a href="#DataExtractorTool.stop_extraction-553"><span class="linenos">553</span></a>        <span class="c1"># Terminate the writer process if still alive</span>
</span><span id="DataExtractorTool.stop_extraction-554"><a href="#DataExtractorTool.stop_extraction-554"><span class="linenos">554</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool.stop_extraction-555"><a href="#DataExtractorTool.stop_extraction-555"><span class="linenos">555</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;clean&quot;</span><span class="p">,</span> <span class="s2">&quot;Terminating writer process...&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool.stop_extraction-556"><a href="#DataExtractorTool.stop_extraction-556"><span class="linenos">556</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">terminate</span><span class="p">()</span>
</span><span id="DataExtractorTool.stop_extraction-557"><a href="#DataExtractorTool.stop_extraction-557"><span class="linenos">557</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
</span><span id="DataExtractorTool.stop_extraction-558"><a href="#DataExtractorTool.stop_extraction-558"><span class="linenos">558</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;success&quot;</span><span class="p">,</span> <span class="s2">&quot;Writer process forcefully terminated.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool.stop_extraction-559"><a href="#DataExtractorTool.stop_extraction-559"><span class="linenos">559</span></a>        <span class="k">else</span><span class="p">:</span>
</span><span id="DataExtractorTool.stop_extraction-560"><a href="#DataExtractorTool.stop_extraction-560"><span class="linenos">560</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;info&quot;</span><span class="p">,</span> <span class="s2">&quot;Writer process is not running.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span> <span class="o">+</span> <span class="n">extra_indent</span><span class="p">,</span> <span class="n">logger</span><span class="o">=</span><span class="n">logger</span><span class="p">)</span>
</span><span id="DataExtractorTool.stop_extraction-561"><a href="#DataExtractorTool.stop_extraction-561"><span class="linenos">561</span></a>
</span><span id="DataExtractorTool.stop_extraction-562"><a href="#DataExtractorTool.stop_extraction-562"><span class="linenos">562</span></a>        <span class="c1"># Reset extraction session state</span>
</span><span id="DataExtractorTool.stop_extraction-563"><a href="#DataExtractorTool.stop_extraction-563"><span class="linenos">563</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DataExtractorTool.stop_extraction-564"><a href="#DataExtractorTool.stop_extraction-564"><span class="linenos">564</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">start_time</span> <span class="o">=</span> <span class="kc">None</span>
</span><span id="DataExtractorTool.stop_extraction-565"><a href="#DataExtractorTool.stop_extraction-565"><span class="linenos">565</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duration</span> <span class="o">=</span> <span class="kc">None</span>
</span></pre></div>


            <div class="docstring"><p>Forcefully stops the active data extraction process and resets session metadata.</p>

<p>If the writer process is running, this method optionally prompts the user for confirmation,
terminates the process, and clears output-related session variables.</p>

<h3 id="args">Args:</h3>

<ul>
<li><strong>preconfirmation</strong> (<code>Optional[bool]</code>): If <code>True</code>, skips the confirmation prompt. Defaults to <code>False</code>.</li>
<li><strong>logger</strong>: Logger instance used for logging messages. Defaults to <code>None</code>.</li>
<li><strong>extra_indent</strong> (<code>int</code>): Additional indentation level for console messages. Defaults to <code>0</code>.</li>
</ul>
</div>


                            </div>
                            <div id="DataExtractorTool.show_progress" class="classattr">
                                        <input id="DataExtractorTool.show_progress-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">show_progress</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DataExtractorTool.show_progress-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataExtractorTool.show_progress"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataExtractorTool.show_progress-571"><a href="#DataExtractorTool.show_progress-571"><span class="linenos">571</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">show_progress</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.show_progress-572"><a href="#DataExtractorTool.show_progress-572"><span class="linenos">572</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.show_progress-573"><a href="#DataExtractorTool.show_progress-573"><span class="linenos">573</span></a><span class="sd">        Displays a real-time progress indicator for the ongoing data extraction process.</span>
</span><span id="DataExtractorTool.show_progress-574"><a href="#DataExtractorTool.show_progress-574"><span class="linenos">574</span></a>
</span><span id="DataExtractorTool.show_progress-575"><a href="#DataExtractorTool.show_progress-575"><span class="linenos">575</span></a><span class="sd">        If the writer process is active, this method uses the view tools to render a progress bar</span>
</span><span id="DataExtractorTool.show_progress-576"><a href="#DataExtractorTool.show_progress-576"><span class="linenos">576</span></a><span class="sd">        based on the elapsed time since the extraction started.</span>
</span><span id="DataExtractorTool.show_progress-577"><a href="#DataExtractorTool.show_progress-577"><span class="linenos">577</span></a>
</span><span id="DataExtractorTool.show_progress-578"><a href="#DataExtractorTool.show_progress-578"><span class="linenos">578</span></a><span class="sd">        Console messages are shown if no extraction process is currently running.</span>
</span><span id="DataExtractorTool.show_progress-579"><a href="#DataExtractorTool.show_progress-579"><span class="linenos">579</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.show_progress-580"><a href="#DataExtractorTool.show_progress-580"><span class="linenos">580</span></a>
</span><span id="DataExtractorTool.show_progress-581"><a href="#DataExtractorTool.show_progress-581"><span class="linenos">581</span></a>        <span class="c1"># Display section title</span>
</span><span id="DataExtractorTool.show_progress-582"><a href="#DataExtractorTool.show_progress-582"><span class="linenos">582</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;title&quot;</span><span class="p">,</span> <span class="s2">&quot;Showing progress&quot;</span><span class="p">,</span> <span class="s2">&quot;⏳&quot;</span><span class="p">)</span>
</span><span id="DataExtractorTool.show_progress-583"><a href="#DataExtractorTool.show_progress-583"><span class="linenos">583</span></a>
</span><span id="DataExtractorTool.show_progress-584"><a href="#DataExtractorTool.show_progress-584"><span class="linenos">584</span></a>        <span class="c1"># Check if extraction is active</span>
</span><span id="DataExtractorTool.show_progress-585"><a href="#DataExtractorTool.show_progress-585"><span class="linenos">585</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool.show_progress-586"><a href="#DataExtractorTool.show_progress-586"><span class="linenos">586</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No data extraction was started.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.show_progress-587"><a href="#DataExtractorTool.show_progress-587"><span class="linenos">587</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool.show_progress-588"><a href="#DataExtractorTool.show_progress-588"><span class="linenos">588</span></a>
</span><span id="DataExtractorTool.show_progress-589"><a href="#DataExtractorTool.show_progress-589"><span class="linenos">589</span></a>        <span class="c1"># Show real-time progress bar</span>
</span><span id="DataExtractorTool.show_progress-590"><a href="#DataExtractorTool.show_progress-590"><span class="linenos">590</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">real_time_progress</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_time</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">duration</span><span class="p">,</span> <span class="s2">&quot;⏳ Extracting data...&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Displays a real-time progress indicator for the ongoing data extraction process.</p>

<p>If the writer process is active, this method uses the view tools to render a progress bar
based on the elapsed time since the extraction started.</p>

<p>Console messages are shown if no extraction process is currently running.</p>
</div>


                            </div>
                            <div id="DataExtractorTool.show_extracted_data" class="classattr">
                                        <input id="DataExtractorTool.show_extracted_data-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">show_extracted_data</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DataExtractorTool.show_extracted_data-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataExtractorTool.show_extracted_data"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataExtractorTool.show_extracted_data-596"><a href="#DataExtractorTool.show_extracted_data-596"><span class="linenos">596</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">show_extracted_data</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.show_extracted_data-597"><a href="#DataExtractorTool.show_extracted_data-597"><span class="linenos">597</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.show_extracted_data-598"><a href="#DataExtractorTool.show_extracted_data-598"><span class="linenos">598</span></a><span class="sd">        Streams the real-time log output of the data extraction process to the console.</span>
</span><span id="DataExtractorTool.show_extracted_data-599"><a href="#DataExtractorTool.show_extracted_data-599"><span class="linenos">599</span></a>
</span><span id="DataExtractorTool.show_extracted_data-600"><a href="#DataExtractorTool.show_extracted_data-600"><span class="linenos">600</span></a><span class="sd">        If the writer process is active, this method uses the view tools to display the contents</span>
</span><span id="DataExtractorTool.show_extracted_data-601"><a href="#DataExtractorTool.show_extracted_data-601"><span class="linenos">601</span></a><span class="sd">        of the output log file. Otherwise, it notifies the user that no process is running.</span>
</span><span id="DataExtractorTool.show_extracted_data-602"><a href="#DataExtractorTool.show_extracted_data-602"><span class="linenos">602</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.show_extracted_data-603"><a href="#DataExtractorTool.show_extracted_data-603"><span class="linenos">603</span></a>
</span><span id="DataExtractorTool.show_extracted_data-604"><a href="#DataExtractorTool.show_extracted_data-604"><span class="linenos">604</span></a>        <span class="c1"># Check if extraction is active</span>
</span><span id="DataExtractorTool.show_extracted_data-605"><a href="#DataExtractorTool.show_extracted_data-605"><span class="linenos">605</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer_process</span><span class="o">.</span><span class="n">is_alive</span><span class="p">():</span>
</span><span id="DataExtractorTool.show_extracted_data-606"><a href="#DataExtractorTool.show_extracted_data-606"><span class="linenos">606</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">console_message</span><span class="p">(</span><span class="s2">&quot;caution&quot;</span><span class="p">,</span> <span class="s2">&quot;No data extraction was started.&quot;</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</span><span id="DataExtractorTool.show_extracted_data-607"><a href="#DataExtractorTool.show_extracted_data-607"><span class="linenos">607</span></a>            <span class="k">return</span>
</span><span id="DataExtractorTool.show_extracted_data-608"><a href="#DataExtractorTool.show_extracted_data-608"><span class="linenos">608</span></a>
</span><span id="DataExtractorTool.show_extracted_data-609"><a href="#DataExtractorTool.show_extracted_data-609"><span class="linenos">609</span></a>        <span class="c1"># Stream the real-time log output</span>
</span><span id="DataExtractorTool.show_extracted_data-610"><a href="#DataExtractorTool.show_extracted_data-610"><span class="linenos">610</span></a>        <span class="n">log_path</span><span class="p">:</span> <span class="n">Path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_filepath</span> <span class="k">else</span> <span class="n">Path</span><span class="p">()</span>
</span><span id="DataExtractorTool.show_extracted_data-611"><a href="#DataExtractorTool.show_extracted_data-611"><span class="linenos">611</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">vt</span><span class="o">.</span><span class="n">real_time_log</span><span class="p">(</span><span class="n">log_path</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Streams the real-time log output of the data extraction process to the console.</p>

<p>If the writer process is active, this method uses the view tools to display the contents
of the output log file. Otherwise, it notifies the user that no process is running.</p>
</div>


                            </div>
                            <div id="DataExtractorTool.exit" class="classattr">
                                        <input id="DataExtractorTool.exit-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">exit</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">) -> <span class="kc">None</span>:</span></span>

                <label class="view-source-button" for="DataExtractorTool.exit-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#DataExtractorTool.exit"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="DataExtractorTool.exit-617"><a href="#DataExtractorTool.exit-617"><span class="linenos">617</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">exit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="DataExtractorTool.exit-618"><a href="#DataExtractorTool.exit-618"><span class="linenos">618</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.exit-619"><a href="#DataExtractorTool.exit-619"><span class="linenos">619</span></a><span class="sd">        Exits the TUI menu and performs cleanup operations.</span>
</span><span id="DataExtractorTool.exit-620"><a href="#DataExtractorTool.exit-620"><span class="linenos">620</span></a>
</span><span id="DataExtractorTool.exit-621"><a href="#DataExtractorTool.exit-621"><span class="linenos">621</span></a><span class="sd">        This method is intended to be called when the user chooses to exit the interface.</span>
</span><span id="DataExtractorTool.exit-622"><a href="#DataExtractorTool.exit-622"><span class="linenos">622</span></a><span class="sd">        It stops any active data extraction process and releases associated resources.</span>
</span><span id="DataExtractorTool.exit-623"><a href="#DataExtractorTool.exit-623"><span class="linenos">623</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="DataExtractorTool.exit-624"><a href="#DataExtractorTool.exit-624"><span class="linenos">624</span></a>  
</span><span id="DataExtractorTool.exit-625"><a href="#DataExtractorTool.exit-625"><span class="linenos">625</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">stop_extraction</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>Exits the TUI menu and performs cleanup operations.</p>

<p>This method is intended to be called when the user chooses to exit the interface.
It stops any active data extraction process and releases associated resources.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>